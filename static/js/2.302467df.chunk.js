/*! For license information please see 2.302467df.chunk.js.LICENSE.txt */
(this.webpackJsonptable=this.webpackJsonptable||[]).push([[2],[function(e,t,n){"use strict";e.exports=n(12)},function(e,t,n){"use strict";e.exports=n(5)},function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function i(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(a){return!1}}()?Object.assign:function(e,t){for(var n,l,s=i(e),u=1;u<arguments.length;u++){for(var c in n=Object(arguments[u]))a.call(n,c)&&(s[c]=n[c]);if(r){l=r(n);for(var d=0;d<l.length;d++)o.call(n,l[d])&&(s[l[d]]=n[l[d]])}}return s}},function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(6)},function(module,exports,__webpack_require__){var require,require,T;T=function(){return function e(t,n,r){function a(i,l){if(!n[i]){if(!t[i]){var s="function"==typeof require&&require;if(!l&&s)return require(i,!0);if(o)return o(i,!0);throw(s=Error("Cannot find module '"+i+"'")).code="MODULE_NOT_FOUND",s}s=n[i]={exports:{}},t[i][0].call(s.exports,(function(e){return a(t[i][1][e]||e)}),s,s.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(T,S,U){var r,w;r=this,w=function(){return function(){var r=function(){var e={};return e.nil=Error("#NULL!"),e.div0=Error("#DIV/0!"),e.value=Error("#VALUE!"),e.ref=Error("#REF!"),e.name=Error("#NAME?"),e.num=Error("#NUM!"),e.na=Error("#N/A"),e.error=Error("#ERROR!"),e.data=Error("#GETTING_DATA"),e}(),w=function(){var e={flattenShallow:function(e){return e&&e.reduce?e.reduce((function(e,t){var n=Array.isArray(e),r=Array.isArray(t);return n&&r?e.concat(t):n?(e.push(t),e):r?[e].concat(t):[e,t]})):e},isFlat:function(e){if(!e)return!1;for(var t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0},flatten:function(){for(var t=e.argsToArray.apply(null,arguments);!e.isFlat(t);)t=e.flattenShallow(t);return t},argsToArray:function(t){var n=[];return e.arrayEach(t,(function(e){n.push(e)})),n},numbers:function(){return this.flatten.apply(null,arguments).filter((function(e){return"number"===typeof e}))},cleanFloat:function(e){return Math.round(1e14*e)/1e14},parseBool:function(e){if("boolean"===typeof e||e instanceof Error)return e;if("number"===typeof e)return 0!==e;if("string"===typeof e){var t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||r.value},parseNumber:function(e){return void 0===e||""===e||isNaN(e)?r.value:parseFloat(e)},parseNumberArray:function(t){var n,a;if(!t||0===(n=t.length))return r.value;for(;n--;){if((a=e.parseNumber(t[n]))===r.value)return a;t[n]=a}return t},parseMatrix:function(t){if(!t||0===t.length)return r.value;for(var n,a=0;a<t.length;a++)if(n=e.parseNumberArray(t[a]),t[a]=n,n instanceof Error)return n;return t}},t=new Date(Date.UTC(1900,0,1));return e.parseDate=function(e){return isNaN(e)?"string"!==typeof e||(e=new Date(e),isNaN(e))?r.value:e:e instanceof Date?new Date(e):0>(e=parseInt(e,10))?r.num:60>=e?new Date(t.getTime()+864e5*(e-1)):new Date(t.getTime()+864e5*(e-2))},e.parseDateArray=function(e){for(var t,n=e.length;n--;){if((t=this.parseDate(e[n]))===r.value)return t;e[n]=t}return e},e.anyIsError=function(){for(var e=arguments.length;e--;)if(arguments[e]instanceof Error)return!0;return!1},e.arrayValuesToNumbers=function(e){for(var t,n=e.length;n--;)"number"!==typeof(t=e[n])&&(!0===t?e[n]=1:!1===t?e[n]=0:"string"===typeof t&&(t=this.parseNumber(t),e[n]=t instanceof Error?0:t));return e},e.rest=function(e,t){return e&&"function"===typeof e.slice?e.slice(t||1):e},e.initial=function(e,t){return e&&"function"===typeof e.slice?e.slice(0,e.length-(t||1)):e},e.arrayEach=function(e,t){for(var n=-1,r=e.length;++n<r&&!1!==t(e[n],n,e););return e},e.transpose=function(e){return e?e[0].map((function(t,n){return e.map((function(e){return e[n]}))})):r.value},e}(),k={};k.datetime=function(){function e(e){return(e-n)/864e5+(-22038912e5<e?2:1)}var t={},n=new Date(1900,0,1),a=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];return t.DATE=function(e,t,n){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0>e||0>t||0>n?r.num:new Date(e,t-1,n)},t.DATEVALUE=function(e){return"string"!==typeof e?r.value:(e=Date.parse(e),isNaN(e)?r.value:-22038912e5>=e?(e-n)/864e5+1:(e-n)/864e5+2)},t.DAY=function(e){return(e=w.parseDate(e))instanceof Error?e:e.getDate()},t.DAYS=function(t,n){return t=w.parseDate(t),n=w.parseDate(n),t instanceof Error?t:n instanceof Error?n:e(t)-e(n)},t.DAYS360=function(e,t,n){},t.EDATE=function(t,n){return(t=w.parseDate(t))instanceof Error?t:isNaN(n)?r.value:(n=parseInt(n,10),t.setMonth(t.getMonth()+n),e(t))},t.EOMONTH=function(t,n){return(t=w.parseDate(t))instanceof Error?t:isNaN(n)?r.value:(n=parseInt(n,10),e(new Date(t.getFullYear(),t.getMonth()+n+1,0)))},t.HOUR=function(e){return(e=w.parseDate(e))instanceof Error?e:e.getHours()},t.INTERVAL=function(e){if("number"!==typeof e&&"string"!==typeof e)return r.value;e=parseInt(e,10);var t=Math.floor(e/94608e4);e%=94608e4;var n=Math.floor(e/2592e3);e%=2592e3;var a=Math.floor(e/86400);e%=86400;var o=Math.floor(e/3600);e%=3600;var i=Math.floor(e/60);return"P"+(0<t?t+"Y":"")+(0<n?n+"M":"")+(0<a?a+"D":"")+"T"+(0<o?o+"H":"")+(0<i?i+"M":"")+(0<(e%=60)?e+"S":"")},t.ISOWEEKNUM=function(e){if((e=w.parseDate(e))instanceof Error)return e;e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)},t.MINUTE=function(e){return(e=w.parseDate(e))instanceof Error?e:e.getMinutes()},t.MONTH=function(e){return(e=w.parseDate(e))instanceof Error?e:e.getMonth()+1},t.NETWORKDAYS=function(e,t,n){},t.NETWORKDAYS.INTL=function(e,t,n,r){},t.NOW=function(){return new Date},t.SECOND=function(e){return(e=w.parseDate(e))instanceof Error?e:e.getSeconds()},t.TIME=function(e,t,n){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0>e||0>t||0>n?r.num:(3600*e+60*t+n)/86400},t.TIMEVALUE=function(e){return(e=w.parseDate(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},t.TODAY=function(){return new Date},t.WEEKDAY=function(e,t){if((e=w.parseDate(e))instanceof Error)return e;void 0===t&&(t=1);var n=e.getDay();return a[t][n]},t.WEEKNUM=function(e,t){},t.WORKDAY=function(e,t,n){},t.WORKDAY.INTL=function(e,t,n,r){},t.YEAR=function(e){return(e=w.parseDate(e))instanceof Error?e:e.getFullYear()},t.YEARFRAC=function(e,t,n){},t}(),k.database=function(){function t(f,b){for(var c={},e=1;e<f[0].length;++e)c[e]=!0;var g=b[0].length;for(e=1;e<b.length;++e)b[e].length>g&&(g=b[e].length);for(e=1;e<f.length;++e)for(var l=1;l<f[e].length;++l){for(var p=!1,u=!1,m=0;m<b.length;++m){var z=b[m];if(!(z.length<g)&&f[e][0]===z[0]){u=!0;for(var D=1;D<z.length;++D)p=p||eval(f[e][l]+z[D])}}u&&(c[l]=c[l]&&p)}for(g=[],e=0;e<f[0].length;++e)c[e]&&g.push(e-1);return g}var h={FINDFIELD:function(e,t){for(var n=null,a=0;a<e.length;a++)if(e[a][0]===t){n=a;break}return null==n?r.value:n},DAVERAGE:function(e,n,a){if(isNaN(n)&&"string"!==typeof n)return r.value;a=t(e,a),"string"===typeof n?(n=h.FINDFIELD(e,n),e=w.rest(e[n])):e=w.rest(e[n]);for(var o=n=0;o<a.length;o++)n+=e[a[o]];return 0===a.length?r.div0:n/a.length},DCOUNT:function(e,t,n){},DCOUNTA:function(e,t,n){},DGET:function(e,n,a){return isNaN(n)&&"string"!==typeof n?r.value:(a=t(e,a),"string"===typeof n?(n=h.FINDFIELD(e,n),e=w.rest(e[n])):e=w.rest(e[n]),0===a.length?r.value:1<a.length?r.num:e[a[0]])},DMAX:function(e,n,a){if(isNaN(n)&&"string"!==typeof n)return r.value;a=t(e,a),"string"===typeof n?(n=h.FINDFIELD(e,n),e=w.rest(e[n])):e=w.rest(e[n]),n=e[a[0]];for(var o=1;o<a.length;o++)n<e[a[o]]&&(n=e[a[o]]);return n},DMIN:function(e,n,a){if(isNaN(n)&&"string"!==typeof n)return r.value;a=t(e,a),"string"===typeof n?(n=h.FINDFIELD(e,n),e=w.rest(e[n])):e=w.rest(e[n]),n=e[a[0]];for(var o=1;o<a.length;o++)n>e[a[o]]&&(n=e[a[o]]);return n},DPRODUCT:function(e,n,a){if(isNaN(n)&&"string"!==typeof n)return r.value;if(a=t(e,a),"string"===typeof n){n=h.FINDFIELD(e,n);var o=w.rest(e[n])}else o=w.rest(e[n]);for(e=[],n=0;n<a.length;n++)e[n]=o[a[n]];if(a=e)for(e=[],n=0;n<a.length;++n)a[n]&&e.push(a[n]);else e=a;for(a=1,n=0;n<e.length;n++)a*=e[n];return a},DSTDEV:function(e,t,n){},DSTDEVP:function(e,t,n){},DSUM:function(e,t,n){},DVAR:function(e,t,n){},DVARP:function(e,t,n){},MATCH:function(e,t,n){if(!e&&!t)return r.na;if(2===arguments.length&&(n=1),!(t instanceof Array)||-1!==n&&0!==n&&1!==n)return r.na;for(var a,o,i=0;i<t.length;i++)if(1===n){if(t[i]===e)return i+1;t[i]<e&&(o?t[i]>o&&(a=i+1,o=t[i]):(a=i+1,o=t[i]))}else if(0===n){if("string"===typeof e){if(e=e.replace(/\?/g,"."),t[i].toLowerCase().match(e.toLowerCase()))return i+1}else if(t[i]===e)return i+1}else if(-1===n){if(t[i]===e)return i+1;t[i]>e&&(o?t[i]<o&&(a=i+1,o=t[i]):(a=i+1,o=t[i]))}return a||r.na}};return h}(),k.engineering=function(){var e={BESSELI:function(e,t){},BESSELJ:function(e,t){},BESSELK:function(e,t){},BESSELY:function(e,t){},BIN2DEC:function(e){if(!/^[01]{1,10}$/.test(e))return r.num;var t=parseInt(e,2);return 10===(e=e.toString()).length&&"1"===e.substring(0,1)?parseInt(e.substring(1),2)-512:t},BIN2HEX:function(e,t){if(!/^[01]{1,10}$/.test(e))return r.num;var n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?(0xfffffffe00+parseInt(n.substring(1),2)).toString(16):(n=parseInt(e,2).toString(16),void 0===t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t))>=n.length?REPT("0",t-n.length)+n:r.num)},BIN2OCT:function(e,t){if(!/^[01]{1,10}$/.test(e))return r.num;var n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?(1073741312+parseInt(n.substring(1),2)).toString(8):(n=parseInt(e,2).toString(8),void 0===t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t))>=n.length?REPT("0",t-n.length)+n:r.num)},BITAND:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>e||0>t||Math.floor(e)!==e||Math.floor(t)!==t||0xffffffffffff<e||0xffffffffffff<t?r.num:e&t},BITLSHIFT:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>e||Math.floor(e)!==e||0xffffffffffff<e||53<Math.abs(t)?r.num:0<=t?e<<t:e>>-t},BITOR:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>e||0>t||Math.floor(e)!==e||Math.floor(t)!==t||0xffffffffffff<e||0xffffffffffff<t?r.num:e|t},BITRSHIFT:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>e||Math.floor(e)!==e||0xffffffffffff<e||53<Math.abs(t)?r.num:0<=t?e>>t:e<<-t},BITXOR:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>e||0>t||Math.floor(e)!==e||Math.floor(t)!==t||0xffffffffffff<e||0xffffffffffff<t?r.num:e^t},COMPLEX:function(e,t,n){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?e:"i"!==(n=void 0===n?"i":n)&&"j"!==n?r.value:0===e&&0===t?0:0===e?1===t?n:t.toString()+n:0===t?e.toString():e.toString()+(0<t?"+":"")+(1===t?n:t.toString()+n)},CONVERT:function(e,t,n){if((e=w.parseNumber(e))instanceof Error)return e;for(var a,o=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\xe5ngstr\xf6m","\xc5",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \xe5ngstr\xf6m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","\xb0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03a9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\xe4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \xe5ngstr\xf6m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],i={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},l={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},s=null,u=null,c=t,d=n,p=1,f=1,h=0;h<o.length;h++)a=null===o[h][2]?[]:o[h][2],(o[h][1]===c||0<=a.indexOf(c))&&(s=o[h]),(o[h][1]===d||0<=a.indexOf(d))&&(u=o[h]);if(null===s)for(a=i[t.substring(0,2)],h=l[t.substring(0,1)],"da"===t.substring(0,2)&&(h=["dekao",10,"da"]),a?(p=a[2],c=t.substring(2)):h&&(p=h[1],c=t.substring(h[2].length)),t=0;t<o.length;t++)a=null===o[t][2]?[]:o[t][2],(o[t][1]===c||0<=a.indexOf(c))&&(s=o[t]);if(null===u)for(i=i[n.substring(0,2)],l=l[n.substring(0,1)],"da"===n.substring(0,2)&&(l=["dekao",10,"da"]),i?(f=i[2],d=n.substring(2)):l&&(f=l[1],d=n.substring(l[2].length)),n=0;n<o.length;n++)a=null===o[n][2]?[]:o[n][2],(o[n][1]===d||0<=a.indexOf(d))&&(u=o[n]);return null===s||null===u||s[3]!==u[3]?r.na:e*s[6]*p/(u[6]*f)},DEC2BIN:function(e,t){if((e=w.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||-512>e||511<e)return r.num;if(0>e)return"1"+REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var n=parseInt(e,10).toString(2);return"undefined"===typeof t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t))>=n.length?REPT("0",t-n.length)+n:r.num},DEC2HEX:function(e,t){if((e=w.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||-549755813888>e||549755813887<e)return r.num;if(0>e)return(1099511627776+e).toString(16);var n=parseInt(e,10).toString(16);return"undefined"===typeof t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t))>=n.length?REPT("0",t-n.length)+n:r.num},DEC2OCT:function(e,t){if((e=w.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||-536870912>e||536870911<e)return r.num;if(0>e)return(1073741824+e).toString(8);var n=parseInt(e,10).toString(8);return"undefined"===typeof t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t))>=n.length?REPT("0",t-n.length)+n:r.num},DELTA:function(e,t){return t=void 0===t?0:t,e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:e===t?1:0},ERF:function(e,t){}};return e.ERF.PRECISE=function(){},e.ERFC=function(e){},e.ERFC.PRECISE=function(){},e.GESTEP=function(e,t){return t=t||0,e=w.parseNumber(e),w.anyIsError(t,e)?e:e>=t?1:0},e.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return r.num;var n=10===e.length&&"f"===e.substring(0,1).toLowerCase(),a=n?parseInt(e,16)-1099511627776:parseInt(e,16);return-512>a||511<a?r.num:n?"1"+REPT("0",9-(512+a).toString(2).length)+(512+a).toString(2):(n=a.toString(2),void 0===t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t))>=n.length?REPT("0",t-n.length)+n:r.num)},e.HEX2DEC=function(e){return/^[0-9A-Fa-f]{1,10}$/.test(e)?549755813888<=(e=parseInt(e,16))?e-1099511627776:e:r.num},e.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return r.num;var n=parseInt(e,16);return 536870911<n&&0xffe0000000>n?r.num:0xffe0000000<=n?(n-0xffc0000000).toString(8):(n=n.toString(8),void 0===t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t))>=n.length?REPT("0",t-n.length)+n:r.num)},e.IMABS=function(t){var n=e.IMREAL(t);return t=e.IMAGINARY(t),w.anyIsError(n,t)?r.value:Math.sqrt(Math.pow(n,2)+Math.pow(t,2))},e.IMAGINARY=function(e){if(void 0===e||!0===e||!1===e)return r.value;if(0===e||"0"===e)return 0;if(0<=["i","j"].indexOf(e))return 1;var t=(e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var a=e.substring(e.length-1,e.length);return a="i"===a||"j"===a,0<=t||0<=n?a?0<=t?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?r.num:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?r.num:-Number(e.substring(n+1,e.length-1)):r.num:a?isNaN(e.substring(0,e.length-1))?r.num:e.substring(0,e.length-1):isNaN(e)?r.num:0},e.IMARGUMENT=function(t){var n=e.IMREAL(t);return t=e.IMAGINARY(t),w.anyIsError(n,t)?r.value:0===n&&0===t?r.div0:0===n&&0<t?Math.PI/2:0===n&&0>t?-Math.PI/2:0===t&&0<n?0:0===t&&0>n?-Math.PI:0<n?Math.atan(t/n):0>n&&0<=t?Math.atan(t/n)+Math.PI:Math.atan(t/n)-Math.PI},e.IMCONJUGATE=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);if(w.anyIsError(n,a))return r.value;var o=t.substring(t.length-1);return 0!==a?e.COMPLEX(n,-a,"i"===o||"j"===o?o:"i"):t},e.IMCOS=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),e.COMPLEX(Math.cos(n)*(Math.exp(a)+Math.exp(-a))/2,-Math.sin(n)*(Math.exp(a)-Math.exp(-a))/2,"i"===t||"j"===t?t:"i"))},e.IMCOSH=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),e.COMPLEX(Math.cos(a)*(Math.exp(n)+Math.exp(-n))/2,Math.sin(a)*(Math.exp(n)-Math.exp(-n))/2,"i"===t||"j"===t?t:"i"))},e.IMCOT=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:e.IMDIV(e.IMCOS(t),e.IMSIN(t))},e.IMDIV=function(t,n){var a=e.IMREAL(t),o=e.IMAGINARY(t),i=e.IMREAL(n),l=e.IMAGINARY(n);if(w.anyIsError(a,o,i,l))return r.value;var s=t.substring(t.length-1),u=n.substring(n.length-1),c="i";return("j"===s||"j"===u)&&(c="j"),0===i&&0===l?r.num:(s=i*i+l*l,e.COMPLEX((a*i+o*l)/s,(o*i-a*l)/s,c))},e.IMEXP=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),n=Math.exp(n),e.COMPLEX(n*Math.cos(a),n*Math.sin(a),"i"===t||"j"===t?t:"i"))},e.IMLN=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),e.COMPLEX(Math.log(Math.sqrt(n*n+a*a)),Math.atan(a/n),"i"===t||"j"===t?t:"i"))},e.IMLOG10=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),e.COMPLEX(Math.log(Math.sqrt(n*n+a*a))/Math.log(10),Math.atan(a/n)/Math.log(10),"i"===t||"j"===t?t:"i"))},e.IMLOG2=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),e.COMPLEX(Math.log(Math.sqrt(n*n+a*a))/Math.log(2),Math.atan(a/n)/Math.log(2),"i"===t||"j"===t?t:"i"))},e.IMPOWER=function(t,n){n=w.parseNumber(n);var a=e.IMREAL(t),o=e.IMAGINARY(t);if(w.anyIsError(n,a,o))return r.value;a="i"===(a=t.substring(t.length-1))||"j"===a?a:"i",o=Math.pow(e.IMABS(t),n);var i=e.IMARGUMENT(t);return e.COMPLEX(o*Math.cos(n*i),o*Math.sin(n*i),a)},e.IMPRODUCT=function(){for(var t=arguments[0],n=1;n<arguments.length;n++){var a=e.IMREAL(t);t=e.IMAGINARY(t);var o=e.IMREAL(arguments[n]),i=e.IMAGINARY(arguments[n]);if(w.anyIsError(a,t,o,i))return r.value;t=e.COMPLEX(a*o-t*i,a*i+t*o)}return t},e.IMREAL=function(e){if(void 0===e||!0===e||!1===e)return r.value;if(0===e||"0"===e||0<="i +i 1i +1i -i -1i j +j 1j +1j -j -1j".split(" ").indexOf(e))return 0;var t=e.indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var a=e.substring(e.length-1,e.length);return a="i"===a||"j"===a,0<=t||0<=n?a?0<=t?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?r.num:Number(e.substring(0,t)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?r.num:Number(e.substring(0,n)):r.num:a?isNaN(e.substring(0,e.length-1))?r.num:0:isNaN(e)?r.num:e},e.IMSEC=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:e.IMDIV("1",e.IMCOS(t))},e.IMSECH=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:e.IMDIV("1",e.IMCOSH(t))},e.IMSIN=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),e.COMPLEX(Math.sin(n)*(Math.exp(a)+Math.exp(-a))/2,Math.cos(n)*(Math.exp(a)-Math.exp(-a))/2,"i"===t||"j"===t?t:"i"))},e.IMSINH=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),e.COMPLEX(Math.cos(a)*(Math.exp(n)-Math.exp(-n))/2,Math.sin(a)*(Math.exp(n)+Math.exp(-n))/2,"i"===t||"j"===t?t:"i"))},e.IMSQRT=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(n="i"===(n=t.substring(t.length-1))||"j"===n?n:"i",a=Math.sqrt(e.IMABS(t)),t=e.IMARGUMENT(t),e.COMPLEX(a*Math.cos(t/2),a*Math.sin(t/2),n))},e.IMCSC=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.num:e.IMDIV("1",e.IMSIN(t))},e.IMCSCH=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.num:e.IMDIV("1",e.IMSINH(t))},e.IMSUB=function(e,t){var n=this.IMREAL(e),a=this.IMAGINARY(e),o=this.IMREAL(t),i=this.IMAGINARY(t);if(w.anyIsError(n,a,o,i))return r.value;var l=e.substring(e.length-1),s=t.substring(t.length-1),u="i";return("j"===l||"j"===s)&&(u="j"),this.COMPLEX(n-o,a-i,u)},e.IMSUM=function(){for(var e=w.flatten(arguments),t=e[0],n=1;n<e.length;n++){var a=this.IMREAL(t);t=this.IMAGINARY(t);var o=this.IMREAL(e[n]),i=this.IMAGINARY(e[n]);if(w.anyIsError(a,t,o,i))return r.value;t=this.COMPLEX(a+o,t+i)}return t},e.IMTAN=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:this.IMDIV(this.IMSIN(t),this.IMCOS(t))},e.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return r.num;var n=10===e.length&&"7"===e.substring(0,1),a=n?parseInt(e,8)-1073741824:parseInt(e,8);return-512>a||511<a?r.num:n?"1"+REPT("0",9-(512+a).toString(2).length)+(512+a).toString(2):(n=a.toString(2),"undefined"===typeof t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t))>=n.length?REPT("0",t-n.length)+n:r.num)},e.OCT2DEC=function(e){return/^[0-7]{1,10}$/.test(e)?536870912<=(e=parseInt(e,8))?e-1073741824:e:r.num},e.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return r.num;var n=parseInt(e,8);return 536870912<=n?"ff"+(n+3221225472).toString(16):(n=n.toString(16),void 0===t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t))>=n.length?REPT("0",t-n.length)+n:r.num)},e}(),k.financial=function(){function e(e){return e&&e.getTime&&!isNaN(e.getTime())}function t(e){return e instanceof Date?e:new Date(e)}var n={ACCRINT:function(n,r,a,o,i,l,s){return n=t(n),r=t(r),a=t(a),e(n)&&e(r)&&e(a)?0>=o||0>=i||-1===[1,2,4].indexOf(l)||-1===[0,1,2,3,4].indexOf(s)||a<=n?"#NUM!":(i||0)*o*YEARFRAC(n,a,s||0):"#VALUE!"},ACCRINTM:null,AMORDEGRC:null,AMORLINC:null,COUPDAYBS:null,COUPDAYS:null,COUPDAYSNC:null,COUPNCD:null,COUPNUM:null,COUPPCD:null,CUMIPMT:function(e,t,a,o,i,l){if(e=w.parseNumber(e),t=w.parseNumber(t),a=w.parseNumber(a),w.anyIsError(e,t,a))return r.value;if(0>=e||0>=t||0>=a||1>o||1>i||o>i||0!==l&&1!==l)return r.num;t=n.PMT(e,t,a,0,l);var s=0;for(1===o&&0===l&&(s=-a,o++);o<=i;o++)s=1===l?s+(n.FV(e,o-2,t,a,1)-t):s+n.FV(e,o-1,t,a,0);return s*e},CUMPRINC:function(e,t,a,o,i,l){if(e=w.parseNumber(e),t=w.parseNumber(t),a=w.parseNumber(a),w.anyIsError(e,t,a))return r.value;if(0>=e||0>=t||0>=a||1>o||1>i||o>i||0!==l&&1!==l)return r.num;t=n.PMT(e,t,a,0,l);var s=0;for(1===o&&(s=0===l?t+a*e:t,o++);o<=i;o++)s=0<l?s+(t-(n.FV(e,o-2,t,a,1)-t)*e):s+(t-n.FV(e,o-1,t,a,0)*e);return s},DB:function(e,t,n,a,o){if(o=void 0===o?12:o,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),o=w.parseNumber(o),w.anyIsError(e,t,n,a,o))return r.value;if(0>e||0>t||0>n||0>a||-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(o)||a>n)return r.num;if(t>=e)return 0;for(var i=o=e*(t=(1-Math.pow(t/e,1/n)).toFixed(3))*o/12,l=0,s=a===n?n-1:a,u=2;u<=s;u++)i+=l=(e-i)*t;return 1===a?o:a===n?(e-i)*t:l},DDB:function(e,t,n,a,o){if(o=void 0===o?2:o,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),o=w.parseNumber(o),w.anyIsError(e,t,n,a,o))return r.value;if(0>e||0>t||0>n||0>a||0>=o||a>n)return r.num;if(t>=e)return 0;for(var i=0,l=0,s=1;s<=a;s++)i+=l=Math.min(o/n*(e-i),e-t-i);return l},DISC:null,DOLLARDE:function(e,t){if(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t))return r.value;if(0>t)return r.num;if(0<=t&&1>t)return r.div0;t=parseInt(t,10);var n=parseInt(e,10);n+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var a=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return Math.round(n*a)/a},DOLLARFR:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>t?r.num:0<=t&&1>t?r.div0:(t=parseInt(t,10),parseInt(e,10)+e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t)},DURATION:null,EFFECT:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>=e||1>t?r.num:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},FV:function(e,t,n,a,o){return a=a||0,o=o||0,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),o=w.parseNumber(o),w.anyIsError(e,t,n,a,o)?r.value:(0===e?e=a+n*t:(t=Math.pow(1+e,t),e=1===o?a*t+n*(1+e)*(t-1)/e:a*t+n*(t-1)/e),-e)},FVSCHEDULE:function(e,t){if(e=w.parseNumber(e),t=w.parseNumberArray(w.flatten(t)),w.anyIsError(e,t))return r.value;for(var n=t.length,a=e,o=0;o<n;o++)a*=1+t[o];return a},INTRATE:null,IPMT:function(e,t,a,o,i,l){return i=i||0,l=l||0,e=w.parseNumber(e),t=w.parseNumber(t),a=w.parseNumber(a),o=w.parseNumber(o),i=w.parseNumber(i),l=w.parseNumber(l),w.anyIsError(e,t,a,o,i,l)?r.value:(a=n.PMT(e,a,o,i,l),(1===t?1===l?0:-o:1===l?n.FV(e,t-2,a,o,1)-a:n.FV(e,t-1,a,o,0))*e)},IRR:function(e,t){if(t=t||0,e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),w.anyIsError(e,t))return r.value;for(var n=function(e,t,n){n+=1;for(var r=e[0],a=1;a<e.length;a++)r+=e[a]/Math.pow(n,(t[a]-t[0])/365);return r},a=function(e,t,n){n+=1;for(var r=0,a=1;a<e.length;a++){var o=(t[a]-t[0])/365;r-=o*e[a]/Math.pow(n,o+1)}return r},o=[],i=!1,l=!1,s=0;s<e.length;s++)o[s]=0===s?0:o[s-1]+365,0<e[s]&&(i=!0),0>e[s]&&(l=!0);if(!i||!l)return r.num;i=void 0===t?.1:t,l=!0;do{var u=n(e,o,i);l=i-u/a(e,o,i),s=Math.abs(l-i),i=l,l=1e-10<s&&1e-10<Math.abs(u)}while(l);return i},ISPMT:function(e,t,n,a){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),w.anyIsError(e,t,n,a)?r.value:a*e*(t/n-1)},MDURATION:null,MIRR:function(e,t,a){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),a=w.parseNumber(a),w.anyIsError(e,t,a))return r.value;for(var o=e.length,i=[],l=[],s=0;s<o;s++)0>e[s]?i.push(e[s]):l.push(e[s]);return e=-n.NPV(a,l)*Math.pow(1+a,o-1),t=n.NPV(t,i)*(1+t),Math.pow(e/t,1/(o-1))-1},NOMINAL:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>=e||1>t?r.num:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},NPER:function(e,t,n,a,o){return o=void 0===o?0:o,a=void 0===a?0:a,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),o=w.parseNumber(o),w.anyIsError(e,t,n,a,o)?r.value:Math.log((t*(1+e*o)-a*e)/(n*e+t*(1+e*o)))/Math.log(1+e)},NPV:function(){var e=w.parseNumberArray(w.flatten(arguments));if(e instanceof Error)return e;for(var t=e[0],n=0,r=1;r<e.length;r++)n+=e[r]/Math.pow(1+t,r);return n},ODDFPRICE:null,ODDFYIELD:null,ODDLPRICE:null,ODDLYIELD:null,PDURATION:function(e,t,n){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0>=e?r.num:(Math.log(n)-Math.log(t))/Math.log(1+e)},PMT:function(e,t,n,a,o){return a=a||0,o=o||0,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),o=w.parseNumber(o),w.anyIsError(e,t,n,a,o)?r.value:(0===e?e=(n+a)/t:(t=Math.pow(1+e,t),e=1===o?(a*e/(t-1)+n*e/(1-1/t))/(1+e):a*e/(t-1)+n*e/(1-1/t)),-e)},PPMT:function(e,t,a,o,i,l){return i=i||0,l=l||0,e=w.parseNumber(e),a=w.parseNumber(a),o=w.parseNumber(o),i=w.parseNumber(i),l=w.parseNumber(l),w.anyIsError(e,a,o,i,l)?r.value:n.PMT(e,a,o,i,l)-n.IPMT(e,t,a,o,i,l)},PRICE:null,PRICEDISC:null,PRICEMAT:null,PV:function(e,t,n,a,o){return a=a||0,o=o||0,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),o=w.parseNumber(o),w.anyIsError(e,t,n,a,o)?r.value:0===e?-n*t-a:((1-Math.pow(1+e,t))/e*n*(1+e*o)-a)/Math.pow(1+e,t)},RATE:function(e,t,n,a,o,i){if(i=void 0===i?.01:i,a=void 0===a?0:a,o=void 0===o?0:o,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),o=w.parseNumber(o),i=w.parseNumber(i),w.anyIsError(e,t,n,a,o,i))return r.value;for(var l=0,s=!1;100>l&&!s;){var u=Math.pow(i+1,e),c=Math.pow(i+1,e-1);u=i-(a+u*n+t*(u-1)*(i*o+1)/i)/(e*c*n-t*(u-1)*(i*o+1)/Math.pow(i,2)+(e*t*c*(i*o+1)/i+t*(u-1)*o/i)),1e-6>Math.abs(u-i)&&(s=!0),l++,i=u}return s?i:Number.NaN+i},RECEIVED:null,RRI:function(e,t,n){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0===e||0===t?r.num:Math.pow(n/t,1/e)-1},SLN:function(e,t,n){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0===n?r.num:(e-t)/n},SYD:function(e,t,n,a){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),w.anyIsError(e,t,n,a)?r.value:0===n||1>a||a>n?r.num:(e-t)*(n-(a=parseInt(a,10))+1)*2/(n*(n+1))},TBILLEQ:function(e,t,n){return e=w.parseDate(e),t=w.parseDate(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0>=n||e>t||31536e6<t-e?r.num:365*n/(360-n*DAYS360(e,t,!1))},TBILLPRICE:function(e,t,n){return e=w.parseDate(e),t=w.parseDate(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0>=n||e>t||31536e6<t-e?r.num:100*(1-n*DAYS360(e,t,!1)/360)},TBILLYIELD:function(e,t,n){return e=w.parseDate(e),t=w.parseDate(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0>=n||e>t||31536e6<t-e?r.num:360*(100-n)/(n*DAYS360(e,t,!1))},VDB:null,XIRR:function(e,t,n){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseDateArray(w.flatten(t)),n=w.parseNumber(n),w.anyIsError(e,t,n))return r.value;for(var a=function(e,t,n){n+=1;for(var r=e[0],a=1;a<e.length;a++)r+=e[a]/Math.pow(n,DAYS(t[a],t[0])/365);return r},o=function(e,t,n){n+=1;for(var r=0,a=1;a<e.length;a++){var o=DAYS(t[a],t[0])/365;r-=o*e[a]/Math.pow(n,o+1)}return r},i=!1,l=!1,s=0;s<e.length;s++)0<e[s]&&(i=!0),0>e[s]&&(l=!0);if(!i||!l)return r.num;n=n||.1,i=!0;do{i=n-(s=a(e,t,n))/o(e,t,n),l=Math.abs(i-n),n=i,i=1e-10<l&&1e-10<Math.abs(s)}while(i);return n},XNPV:function(e,t,n){if(e=w.parseNumber(e),t=w.parseNumberArray(w.flatten(t)),n=w.parseDateArray(w.flatten(n)),w.anyIsError(e,t,n))return r.value;for(var a=0,o=0;o<t.length;o++)a+=t[o]/Math.pow(1+e,DAYS(n[o],n[0])/365);return a},YIELD:null,YIELDDISC:null,YIELDMAT:null};return n}(),k.information=function(){var e={CELL:null,ERROR:{}};return e.ERROR.TYPE=function(e){switch(e){case r.nil:return 1;case r.div0:return 2;case r.value:return 3;case r.ref:return 4;case r.name:return 5;case r.num:return 6;case r.na:return 7;case r.data:return 8}return r.na},e.INFO=null,e.ISBLANK=function(e){return null===e},e.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)},e.ISERR=function(e){return 0<=[r.value,r.ref,r.div0,r.num,r.name,r.nil].indexOf(e)||"number"===typeof e&&(isNaN(e)||!isFinite(e))},e.ISERROR=function(t){return e.ISERR(t)||t===r.na},e.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},e.ISFORMULA=null,e.ISLOGICAL=function(e){return!0===e||!1===e},e.ISNA=function(e){return e===r.na},e.ISNONTEXT=function(e){return"string"!==typeof e},e.ISNUMBER=function(e){return"number"===typeof e&&!isNaN(e)&&isFinite(e)},e.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},e.ISREF=null,e.ISTEXT=function(e){return"string"===typeof e},e.N=function(e){return this.ISNUMBER(e)?e:e instanceof Date?e.getTime():!0===e?1:!1===e?0:this.ISERROR(e)?e:0},e.NA=function(){return r.na},e.SHEET=null,e.SHEETS=null,e.TYPE=function(e){return this.ISNUMBER(e)?1:this.ISTEXT(e)?2:this.ISLOGICAL(e)?4:this.ISERROR(e)?16:Array.isArray(e)?64:void 0},e}(),k.logical={AND:function(){for(var e=w.flatten(arguments),t=!0,n=0;n<e.length;n++)e[n]||(t=!1);return t},CHOOSE:function(){if(2>arguments.length)return r.na;var e=arguments[0];return 1>e||254<e||arguments.length<e+1?r.value:arguments[e]},FALSE:function(){return!1},IF:function(e,t,n){return e?t:n},IFERROR:function(e,t){return ISERROR(e)?t:e},IFNA:function(e,t){return e===r.na?t:e},NOT:function(e){return!e},OR:function(){for(var e=w.flatten(arguments),t=!1,n=0;n<e.length;n++)e[n]&&(t=!0);return t},TRUE:function(){return!0},XOR:function(){for(var e=w.flatten(arguments),t=0,n=0;n<e.length;n++)e[n]&&t++;return!!(1&Math.floor(Math.abs(t)))},SWITCH:function(){if(0<arguments.length){var e=arguments[0],t=arguments.length-1,n=Math.floor(t/2),r=!1;if(t=0===t%2?null:arguments[arguments.length-1],n)for(var a=0;a<n;a++)if(e===arguments[2*a+1]){var o=arguments[2*a+2];r=!0;break}!r&&t&&(o=t)}return o}},k.math=function(){var t={ABS:function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.abs(w.parseNumber(e))},ACOS:function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.acos(e)},ACOSH:function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e-1))},ACOT:function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.atan(1/e)},ACOTH:function(e){return(e=w.parseNumber(e))instanceof Error?e:.5*Math.log((e+1)/(e-1))},AGGREGATE:null,ARABIC:function(e){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return r.value;var t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]})),t},ASIN:function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.asin(e)},ASINH:function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},ATAN:function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.atan(e)},ATAN2:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:Math.atan2(e,t)},ATANH:function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},BASE:function(e,t,n){return n=n||0,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:(n=void 0===n?0:n,e=e.toString(t),Array(Math.max(n+1-e.length,0)).join("0")+e)},CEILING:function(e,t,n){return t=void 0===t?1:t,n=void 0===n?0:n,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0===t?0:(t=Math.abs(t),0<=e?Math.ceil(e/t)*t:0===n?-1*Math.floor(Math.abs(e)/t)*t:-1*Math.ceil(Math.abs(e)/t)*t)}};t.CEILING.MATH=t.CEILING,t.CEILING.PRECISE=t.CEILING,t.COMBIN=function(e,n){return e=w.parseNumber(e),n=w.parseNumber(n),w.anyIsError(e,n)?r.value:t.FACT(e)/(t.FACT(n)*t.FACT(e-n))},t.COMBINA=function(e,n){return e=w.parseNumber(e),n=w.parseNumber(n),w.anyIsError(e,n)?r.value:0===e&&0===n?1:t.COMBIN(e+n-1,e-1)},t.COS=function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.cos(e)},t.COSH=function(e){return(e=w.parseNumber(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},t.COT=function(e){return(e=w.parseNumber(e))instanceof Error?e:1/Math.tan(e)},t.COTH=function(e){return(e=w.parseNumber(e))instanceof Error?e:((e=Math.exp(2*e))+1)/(e-1)},t.CSC=function(e){return(e=w.parseNumber(e))instanceof Error?e:1/Math.sin(e)},t.CSCH=function(e){return(e=w.parseNumber(e))instanceof Error?e:2/(Math.exp(e)-Math.exp(-e))},t.DECIMAL=function(e,t){return 1>arguments.length?r.value:parseInt(e,t)},t.DEGREES=function(e){return(e=w.parseNumber(e))instanceof Error?e:180*e/Math.PI},t.EVEN=function(e){return(e=w.parseNumber(e))instanceof Error?e:t.CEILING(e,-2,-1)},t.EXP=Math.exp;var h=[];return t.FACT=function(e){return(e=w.parseNumber(e))instanceof Error?e:0===(e=Math.floor(e))||1===e?1:(0<h[e]||(h[e]=t.FACT(e-1)*e),h[e])},t.FACTDOUBLE=function(e){return(e=w.parseNumber(e))instanceof Error?e:0>=(e=Math.floor(e))?1:e*t.FACTDOUBLE(e-2)},t.FLOOR=function(e,t,n){return t=void 0===t?1:t,n=void 0===n?0:n,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0===t?0:(t=Math.abs(t),0<=e?Math.floor(e/t)*t:0===n?-1*Math.ceil(Math.abs(e)/t)*t:-1*Math.floor(Math.abs(e)/t)*t)},t.FLOOR.MATH=t.FLOOR,t.GCD=null,t.INT=function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.floor(e)},t.LCM=function(){var e=w.parseNumberArray(w.flatten(arguments));if(e instanceof Error)return e;for(var t,n,r,a=1;void 0!==(r=e.pop());)for(;1<r;){if(r%2){for(t=3,n=Math.floor(Math.sqrt(r));t<=n&&r%t;t+=2);n=t<=n?t:r}else n=2;for(r/=n,a*=n,t=e.length;t;0===e[--t]%n&&1===(e[t]/=n)&&e.splice(t,1));}return a},t.LN=function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.log(e)},t.LOG=function(e,t){return e=w.parseNumber(e),t=void 0===t?10:w.parseNumber(t),w.anyIsError(e,t)?r.value:Math.log(e)/Math.log(t)},t.LOG10=function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.log(e)/Math.log(10)},t.MDETERM=null,t.MINVERSE=null,t.MMULT=null,t.MOD=function(e,t){if(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t))return r.value;if(0===t)return r.div0;var n=Math.abs(e%t);return 0<t?n:-n},t.MROUND=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>e*t?r.num:Math.round(e/t)*t},t.MULTINOMIAL=function(){var e=w.parseNumberArray(w.flatten(arguments));if(e instanceof Error)return e;for(var n=0,r=1,a=0;a<e.length;a++)n+=e[a],r*=t.FACT(e[a]);return t.FACT(n)/r},t.MUNIT=null,t.ODD=function(e){if((e=w.parseNumber(e))instanceof Error)return e;var t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,0<e?t:-t},t.PI=function(){return Math.PI},t.POWER=function(e,t){if(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t))return r.value;var n=Math.pow(e,t);return isNaN(n)?r.num:n},t.PRODUCT=function(){var e=w.parseNumberArray(w.flatten(arguments));if(e instanceof Error)return e;for(var t=1,n=0;n<e.length;n++)t*=e[n];return t},t.QUOTIENT=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:parseInt(e/t,10)},t.RADIANS=function(e){return(e=w.parseNumber(e))instanceof Error?e:e*Math.PI/180},t.RAND=function(){return Math.random()},t.RANDBETWEEN=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:e+Math.ceil((t-e+1)*Math.random())-1},t.ROMAN=null,t.ROUND=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:Math.round(e*Math.pow(10,t))/Math.pow(10,t)},t.ROUNDDOWN=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:(0<e?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.ROUNDUP=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:(0<e?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.SEC=function(e){return(e=w.parseNumber(e))instanceof Error?e:1/Math.cos(e)},t.SECH=function(e){return(e=w.parseNumber(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},t.SERIESSUM=function(e,t,n,a){if(e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumberArray(a),w.anyIsError(e,t,n,a))return r.value;for(var o=a[0]*Math.pow(e,t),i=1;i<a.length;i++)o+=a[i]*Math.pow(e,t+i*n);return o},t.SIGN=function(e){return(e=w.parseNumber(e))instanceof Error?e:0>e?-1:0===e?0:1},t.SIN=function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.sin(e)},t.SINH=function(e){return(e=w.parseNumber(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},t.SQRT=function(e){return(e=w.parseNumber(e))instanceof Error?e:0>e?r.num:Math.sqrt(e)},t.SQRTPI=function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.sqrt(e*Math.PI)},t.SUBTOTAL=null,t.ADD=function(e,t){return 2!==arguments.length?r.na:(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:e+t)},t.MINUS=function(e,t){return 2!==arguments.length?r.na:(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:e-t)},t.DIVIDE=function(e,t){return 2!==arguments.length?r.na:(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0===t?r.div0:e/t)},t.MULTIPLY=function(e,t){return 2!==arguments.length?r.na:(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:e*t)},t.GTE=function(e,t){return 2!==arguments.length?r.na:(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.error:e>=t)},t.LT=function(e,t){return 2!==arguments.length?r.na:(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.error:e<t)},t.LTE=function(e,t){return 2!==arguments.length?r.na:(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.error:e<=t)},t.EQ=function(e,t){return 2!==arguments.length?r.na:e===t},t.NE=function(e,t){return 2!==arguments.length?r.na:e!==t},t.POW=function(e,n){return 2!==arguments.length?r.na:(e=w.parseNumber(e),n=w.parseNumber(n),w.anyIsError(e,n)?r.error:t.POWER(e,n))},t.SUM=function(){for(var e=0,n=Object.keys(arguments),r=0;r<n.length;++r){var a=arguments[n[r]];"number"===typeof a?e+=a:"string"===typeof a?(a=parseFloat(a),!isNaN(a)&&(e+=a)):Array.isArray(a)&&(e+=t.SUM.apply(null,a))}return e},t.SUMIF=function(){var f=w.argsToArray(arguments),b=f.pop();if(f=w.parseNumberArray(w.flatten(f)),f instanceof Error)return f;for(var c=0,e=0;e<f.length;e++)c+=eval(f[e]+b)?f[e]:0;return c},t.SUMIFS=function(){var f=w.argsToArray(arguments),b=w.parseNumberArray(w.flatten(f.shift()));if(b instanceof Error)return b;for(var c=b.length,e=f.length,g=0,l=0;l<c;l++){for(var p=b[l],u="",m=0;m<e;m+=2)u=isNaN(f[m][l])?u+'"'+f[m][l]+'"'+f[m+1]:u+(f[m][l]+f[m+1]),m!==e-1&&(u+=" && ");u=u.slice(0,-4),eval(u)&&(g+=p)}return g},t.SUMPRODUCT=null,t.SUMSQ=function(){var e=w.parseNumberArray(w.flatten(arguments));if(e instanceof Error)return e;for(var t=0,n=e.length,r=0;r<n;r++)t+=ISNUMBER(e[r])?e[r]*e[r]:0;return t},t.SUMX2MY2=function(e,t){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseNumberArray(w.flatten(t)),w.anyIsError(e,t))return r.value;for(var n=0,a=0;a<e.length;a++)n+=e[a]*e[a]-t[a]*t[a];return n},t.SUMX2PY2=function(e,t){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseNumberArray(w.flatten(t)),w.anyIsError(e,t))return r.value;var n=0;e=w.parseNumberArray(w.flatten(e)),t=w.parseNumberArray(w.flatten(t));for(var a=0;a<e.length;a++)n+=e[a]*e[a]+t[a]*t[a];return n},t.SUMXMY2=function(e,t){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseNumberArray(w.flatten(t)),w.anyIsError(e,t))return r.value;var n=0;e=w.flatten(e),t=w.flatten(t);for(var a=0;a<e.length;a++)n+=Math.pow(e[a]-t[a],2);return n},t.TAN=function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.tan(e)},t.TANH=function(e){return(e=w.parseNumber(e))instanceof Error?e:((e=Math.exp(2*e))-1)/(e+1)},t.TRUNC=function(e,t){return t=void 0===t?0:t,e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:(0<e?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t}(),k.misc=function(){var e={UNIQUE:function(){for(var e=[],t=0;t<arguments.length;++t){for(var n=!1,r=arguments[t],a=0;a<e.length&&!(n=e[a]===r);++a);n||e.push(r)}return e}};return e.FLATTEN=w.flatten,e.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},e.REFERENCE=function(e,t){try{for(var n=t.split("."),r=e,a=0;a<n.length;++a){var o=n[a];if("]"===o[o.length-1]){var i=o.indexOf("["),l=o.substring(i+1,o.length-1);r=r[o.substring(0,i)][l]}else r=r[o]}return r}catch(s){}},e.JOIN=function(e,t){return e.join(t)},e.NUMBERS=function(){return w.flatten(arguments).filter((function(e){return"number"===typeof e}))},e.NUMERAL=null,e}(),k.text=function(){var e={ASC:null,BAHTTEXT:null,CHAR:function(e){return(e=w.parseNumber(e))instanceof Error?e:String.fromCharCode(e)},CLEAN:function(e){return(e||"").replace(/[\0-\x1F]/g,"")},CODE:function(e){return(e||"").charCodeAt(0)},CONCATENATE:function(){for(var e,t=w.flatten(arguments);-1<(e=t.indexOf(!0));)t[e]="TRUE";for(;-1<(e=t.indexOf(!1));)t[e]="FALSE";return t.join("")},DBCS:null,DOLLAR:null,EXACT:function(e,t){return e===t},FIND:function(e,t,n){return t?t.indexOf(e,(void 0===n?0:n)-1)+1:null},FIXED:null,HTML2TEXT:function(e){var t="";return e&&(e instanceof Array?e.forEach((function(e){""!==t&&(t+="\n"),t+=e.replace(/<(?:.|\n)*?>/gm,"")})):t=e.replace(/<(?:.|\n)*?>/gm,"")),t},LEFT:function(e,t){return(t=w.parseNumber(void 0===t?1:t))instanceof Error||"string"!==typeof e?r.value:e?e.substring(0,t):null},LEN:function(e){return 0===arguments.length?r.error:"string"===typeof e?e?e.length:0:e.length?e.length:r.value},LOWER:function(e){return"string"!==typeof e?r.value:e?e.toLowerCase():e},MID:function(e,t,n){return t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(t,n)||"string"!==typeof e?n:(--t,e.substring(t,t+n))},NUMBERVALUE:null,PRONETIC:null,PROPER:function(e){return void 0===e||0===e.length?r.value:(!0===e&&(e="TRUE"),!1===e&&(e="FALSE"),isNaN(e)&&"number"===typeof e?r.value:("number"===typeof e&&(e=""+e),e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))))},REGEXEXTRACT:function(e,t){var n=e.match(new RegExp(t));return n?n[1<n.length?n.length-1:0]:null},REGEXMATCH:function(e,t,n){return e=e.match(new RegExp(t)),n?e:!!e},REGEXREPLACE:function(e,t,n){return e.replace(new RegExp(t),n)},REPLACE:function(e,t,n,a){return t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(t,n)||"string"!==typeof e||"string"!==typeof a?r.value:e.substr(0,t-1)+a+e.substr(t-1+n)},REPT:function(e,t){return(t=w.parseNumber(t))instanceof Error?t:Array(t+1).join(e)},RIGHT:function(e,t){return(t=w.parseNumber(void 0===t?1:t))instanceof Error?t:e?e.substring(e.length-t):null},SEARCH:function(e,t,n){return"string"!==typeof e||"string"!==typeof t?r.value:(n=void 0===n?0:n,0===(e=t.toLowerCase().indexOf(e.toLowerCase(),n-1)+1)?r.value:e)},SPLIT:function(e,t){return e.split(t)},SUBSTITUTE:function(e,t,n,r){if(!(e&&t&&n))return e;if(void 0===r)return e.replace(new RegExp(t,"g"),n);for(var a=0,o=0;0<e.indexOf(t,a);)if(a=e.indexOf(t,a+1),++o===r)return e.substring(0,a)+n+e.substring(a+t.length)},T:function(e){return"string"===typeof e?e:""},TEXT:null,TRIM:function(e){return"string"!==typeof e?r.value:e.replace(/ +/g," ").trim()}};return e.UNICHAR=e.CHAR,e.UNICODE=e.CODE,e.UPPER=function(e){return"string"!==typeof e?r.value:e.toUpperCase()},e.VALUE=null,e}(),k.stats=function(){var t={AVEDEV:null,AVERAGE:function(){for(var e=w.numbers(w.flatten(arguments)),t=e.length,n=0,r=0,a=0;a<t;a++)n+=e[a],r+=1;return n/r},AVERAGEA:function(){for(var e=w.flatten(arguments),t=e.length,n=0,r=0,a=0;a<t;a++){var o=e[a];"number"===typeof o&&(n+=o),!0===o&&n++,null!==o&&r++}return n/r},AVERAGEIF:function AVERAGEIF(h,f,b){if(b=b||h,h=w.flatten(h),b=w.parseNumberArray(w.flatten(b)),b instanceof Error)return b;for(var c=0,e=0,g=0;g<h.length;g++)eval(h[g]+f)&&(e+=b[g],c++);return e/c},AVERAGEIFS:null,COUNT:function(){return w.numbers(w.flatten(arguments)).length},COUNTA:function(){var e=w.flatten(arguments);return e.length-t.COUNTBLANK(e)},COUNTIN:function(e,t){for(var n=0,r=0;r<e.length;r++)e[r]===t&&n++;return n},COUNTBLANK:function(){for(var e,t=w.flatten(arguments),n=0,r=0;r<t.length;r++)null!==(e=t[r])&&""!==e||n++;return n},COUNTIF:function COUNTIF(){var h=w.argsToArray(arguments),f=h.pop();h=w.flatten(h),/[<>=!]/.test(f)||(f='=="'+f+'"');for(var b=0,c=0;c<h.length;c++)"string"!==typeof h[c]?eval(h[c]+f)&&b++:eval('"'+h[c]+'"'+f)&&b++;return b},COUNTIFS:function COUNTIFS(){for(var h=w.argsToArray(arguments),f=Array(w.flatten(h[0]).length),b=0;b<f.length;b++)f[b]=!0;for(b=0;b<h.length;b+=2){var c=w.flatten(h[b]),e=h[b+1];/[<>=!]/.test(e)||(e='=="'+e+'"');for(var g=0;g<c.length;g++)f[g]="string"!==typeof c[g]?f[g]&&eval(c[g]+e):f[g]&&eval('"'+c[g]+'"'+e)}for(b=h=0;b<f.length;b++)f[b]&&h++;return h},COUNTUNIQUE:function(){return UNIQUE.apply(null,w.flatten(arguments)).length},FISHER:function(e){return(e=w.parseNumber(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},FISHERINV:function(e){return(e=w.parseNumber(e))instanceof Error?e:((e=Math.exp(2*e))-1)/(e+1)},FREQUENCY:function(e,t){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseNumberArray(w.flatten(t)),w.anyIsError(e,t))return r.value;for(var n=e.length,a=t.length,o=[],i=0;i<=a;i++)for(var l=o[i]=0;l<n;l++)0===i?e[l]<=t[0]&&(o[0]+=1):i<a?e[l]>t[i-1]&&e[l]<=t[i]&&(o[i]+=1):i===a&&e[l]>t[a-1]&&(o[a]+=1);return o},LARGE:function(e,t){return e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),w.anyIsError(e,t)?e:e.sort((function(e,t){return t-e}))[t-1]},MAX:function(){var e=w.numbers(w.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},MAXA:function(){var e=w.arrayValuesToNumbers(w.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},MIN:function(){var e=w.numbers(w.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},MINA:function(){var e=w.arrayValuesToNumbers(w.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},MODE:{}};return t.MODE.MULT=function(){var e=w.parseNumberArray(w.flatten(arguments));if(e instanceof Error)return e;for(var t,n=e.length,r={},a=[],o=0,i=0;i<n;i++)r[t=e[i]]=r[t]?r[t]+1:1,r[t]>o&&(o=r[t],a=[]),r[t]===o&&(a[a.length]=t);return a},t.MODE.SNGL=function(){var e=w.parseNumberArray(w.flatten(arguments));return e instanceof Error?e:t.MODE.MULT(e).sort((function(e,t){return e-t}))[0]},t.PERCENTILE={},t.PERCENTILE.EXC=function(e,t){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),w.anyIsError(e,t))return r.value;var n=(e=e.sort((function(e,t){return e-t}))).length;if(t<1/(n+1)||t>1-1/(n+1))return r.num;n=t*(n+1)-1;var a=Math.floor(n);return w.cleanFloat(n===a?e[n]:e[a]+(n-a)*(e[a+1]-e[a]))},t.PERCENTILE.INC=function(e,t){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),w.anyIsError(e,t))return r.value;var n=t*((e=e.sort((function(e,t){return e-t}))).length-1),a=Math.floor(n);return w.cleanFloat(n===a?e[n]:e[a]+(n-a)*(e[a+1]-e[a]))},t.PERCENTRANK={},t.PERCENTRANK.EXC=function(e,t,n){if(n=void 0===n?3:n,e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n))return r.value;e=e.sort((function(e,t){return e-t}));var a=UNIQUE.apply(null,e),o=e.length,i=a.length;n=Math.pow(10,n);for(var l=0,s=!1,u=0;!s&&u<i;)t===a[u]?(l=(e.indexOf(a[u])+1)/(o+1),s=!0):t>=a[u]&&(t<a[u+1]||u===i-1)&&(l=(e.indexOf(a[u])+1+(t-a[u])/(a[u+1]-a[u]))/(o+1),s=!0),u++;return Math.floor(l*n)/n},t.PERCENTRANK.INC=function(e,t,n){if(n=void 0===n?3:n,e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n))return r.value;e=e.sort((function(e,t){return e-t}));var a=UNIQUE.apply(null,e),o=e.length,i=a.length;n=Math.pow(10,n);for(var l=0,s=!1,u=0;!s&&u<i;)t===a[u]?(l=e.indexOf(a[u])/(o-1),s=!0):t>=a[u]&&(t<a[u+1]||u===i-1)&&(l=(e.indexOf(a[u])+(t-a[u])/(a[u+1]-a[u]))/(o-1),s=!0),u++;return Math.floor(l*n)/n},t.PERMUT=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:FACT(e)/FACT(e-t)},t.PERMUTATIONA=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:Math.pow(e,t)},t.PHI=function(e){return(e=w.parseNumber(e))instanceof Error?r.value:Math.exp(-.5*e*e)/2.5066282746310002},t.PROB=function(e,t,n,a){if(void 0===n)return 0;if(a=void 0===a?n:a,e=w.parseNumberArray(w.flatten(e)),t=w.parseNumberArray(w.flatten(t)),n=w.parseNumber(n),a=w.parseNumber(a),w.anyIsError(e,t,n,a))return r.value;if(n===a)return 0<=e.indexOf(n)?t[e.indexOf(n)]:0;for(var o=e.sort((function(e,t){return e-t})),i=o.length,l=0,s=0;s<i;s++)o[s]>=n&&o[s]<=a&&(l+=t[e.indexOf(o[s])]);return l},t.QUARTILE={},t.QUARTILE.EXC=function(e,n){if(e=w.parseNumberArray(w.flatten(e)),n=w.parseNumber(n),w.anyIsError(e,n))return r.value;switch(n){case 1:return t.PERCENTILE.EXC(e,.25);case 2:return t.PERCENTILE.EXC(e,.5);case 3:return t.PERCENTILE.EXC(e,.75);default:return r.num}},t.QUARTILE.INC=function(e,n){if(e=w.parseNumberArray(w.flatten(e)),n=w.parseNumber(n),w.anyIsError(e,n))return r.value;switch(n){case 1:return t.PERCENTILE.INC(e,.25);case 2:return t.PERCENTILE.INC(e,.5);case 3:return t.PERCENTILE.INC(e,.75);default:return r.num}},t.RANK={},t.RANK.AVG=function(e,t,n){if(e=w.parseNumber(e),t=w.parseNumberArray(w.flatten(t)),w.anyIsError(e,t))return r.value;n=(t=(t=w.flatten(t)).sort(n?function(e,t){return e-t}:function(e,t){return t-e})).length;for(var a=0,o=0;o<n;o++)t[o]===e&&a++;return 1<a?(2*t.indexOf(e)+a+1)/2:t.indexOf(e)+1},t.RANK.EQ=function(e,t,n){return e=w.parseNumber(e),t=w.parseNumberArray(w.flatten(t)),w.anyIsError(e,t)?r.value:(t=t.sort(n?function(e,t){return e-t}:function(e,t){return t-e})).indexOf(e)+1},t.RSQ=function(e,n){return e=w.parseNumberArray(w.flatten(e)),n=w.parseNumberArray(w.flatten(n)),w.anyIsError(e,n)?r.value:Math.pow(t.PEARSON(e,n),2)},t.SMALL=function(e,t){return e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),w.anyIsError(e,t)?e:e.sort((function(e,t){return e-t}))[t-1]},t.STANDARDIZE=function(e,t,n){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:(e-t)/n},t.STDEV={},t.STDEV.P=function(){var e=t.VAR.P.apply(this,arguments);return Math.sqrt(e)},t.STDEV.S=function(){var e=t.VAR.S.apply(this,arguments);return Math.sqrt(e)},t.STDEVA=function(){var e=t.VARA.apply(this,arguments);return Math.sqrt(e)},t.STDEVPA=function(){var e=t.VARPA.apply(this,arguments);return Math.sqrt(e)},t.VAR={},t.VAR.P=function(){for(var e=w.numbers(w.flatten(arguments)),n=e.length,r=0,a=t.AVERAGE(e),o=0;o<n;o++)r+=Math.pow(e[o]-a,2);return r/n},t.VAR.S=function(){for(var e=w.numbers(w.flatten(arguments)),n=e.length,r=0,a=t.AVERAGE(e),o=0;o<n;o++)r+=Math.pow(e[o]-a,2);return r/(n-1)},t.VARA=function(){for(var e=w.flatten(arguments),n=e.length,r=0,a=0,o=t.AVERAGEA(e),i=0;i<n;i++){var l=e[i];r="number"===typeof l?r+Math.pow(l-o,2):!0===l?r+Math.pow(1-o,2):r+Math.pow(0-o,2),null!==l&&a++}return r/(a-1)},t.VARPA=function(){for(var e=w.flatten(arguments),n=e.length,r=0,a=0,o=t.AVERAGEA(e),i=0;i<n;i++){var l=e[i];r="number"===typeof l?r+Math.pow(l-o,2):!0===l?r+Math.pow(1-o,2):r+Math.pow(0-o,2),null!==l&&a++}return r/a},t.WEIBULL={},t.WEIBULL.DIST=function(e,t,n,a){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:a?1-Math.exp(-Math.pow(e/n,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/n,t))*t/Math.pow(n,t)},t.Z={},t.Z.TEST=function(e,n,a){if(e=w.parseNumberArray(w.flatten(e)),n=w.parseNumber(n),w.anyIsError(e,n))return r.value;a=a||t.STDEV.S(e);var o=e.length;return 1-t.NORM.S.DIST((t.AVERAGE(e)-n)/(a/Math.sqrt(o)),!0)},t}(),k.utils={PROGRESS:function(e,t){return'<div style="width:'+(e||"0")+"%;height:4px;background-color:"+(t||"red")+';margin-top:1px;"></div>'},RATING:function(e){for(var t='<div class="jrating">',n=0;5>n;n++)t=n<e?t+'<div class="jrating-selected"></div>':t+"<div></div>";return t+"</div>"}};for(var v=0;v<Object.keys(k).length;v++)for(var d=k[Object.keys(k)[v]],n=Object.keys(d),q=0;q<n.length;q++)if(d[n[q]])if("function"==typeof d[n[q]]||"object"==typeof d[n[q]]){if(window[n[q]]=d[n[q]],window[n[q]].toString=function(){return"#ERROR"},"object"==typeof d[n[q]])for(var y=Object.keys(d[n[q]]),a=0;a<y.length;a++)window[n[q]][y[a]].toString=function(){return"#ERROR"}}else window[n[q]]=function(){return n[q]+"Not implemented"};else window[n[q]]=function(){return n[q]+"Not implemented"};var x=null,A=null,H=null;window.TABLE=function(){return H},window.COLUMN=window.COL=function(){return parseInt(x)+1},window.ROW=function(){return parseInt(A)+1},window.CELL=function(){return B.getColumnNameFromCoords(x,A)},window.VALUE=function(e,t,n){return H.getValueFromCoords(parseInt(e)-1,parseInt(t)-1,n)},window.THISROWCELL=function(e){return H.getValueFromCoords(parseInt(e)-1,parseInt(A))};var B=function e(t,n,r,a,o){if(H=o,x=r,A=a,a="",(o=Object.keys(n)).length)for(r=0;r<o.length;r++)a=-1==o[r].indexOf(".")&&-1==o[r].indexOf("!")?a+"var "+o[r]+" = "+n[o[r]]+";\n":a+(o[r]+" = ")+n[o[r]]+";\n";t=(t=t.replace(/\$/g,"")).replace(/!/g,"."),n="",r=0,o=["=","!",">","<"];for(var i=0;i<t.length;i++)'"'==t[i]&&(r=0==r?1:0),1==r?n+=t[i]:(n+=t[i].toUpperCase(),0<i&&"="==t[i]&&-1==o.indexOf(t[i-1])&&-1==o.indexOf(t[i+1])&&(n+="="));if(t=n=(n=(n=(n=n.replace(/\^/g,"**")).replace(/<>/g,"!=")).replace(/&/g,"+")).replace(/\$/g,""),(n=t.match(/([A-Z]+[0-9]*\.)?(\$?[A-Z]+\$?[0-9]+):(\$?[A-Z]+\$?[0-9]+)?/g))&&n.length)for(r=0;r<n.length;r++)o=e.getTokensFromRange(n[r]),t=t.replace(n[r],"["+o.join(",")+"]");return new Function(a+"; return "+t)()};return B.getColumnNameFromCoords=function(e,t){var n=parseInt(e),r="";return 701<n?(r+=String.fromCharCode(64+parseInt(n/676)),r+=String.fromCharCode(64+parseInt(n%676/26))):25<n&&(r+=String.fromCharCode(64+parseInt(n/26))),(r+=String.fromCharCode(65+n%26))+(parseInt(t)+1)},B.getCoordsFromColumnName=function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,r=0;r<t[0].length;r++)n+=parseInt(t[0].charCodeAt(r)-64)*Math.pow(26,t[0].length-1-r);return 0>--n&&(n=0),0<(e=parseInt(/[0-9]+$/.exec(e))||null)&&e--,[n,e]}},B.getRangeFromTokens=function(e){e=e.filter((function(e){return"#REF!"!=e}));for(var t="",n="",r=0;r<e.length;r++)0<=e[r].indexOf(".")?t=".":0<=e[r].indexOf("!")&&(t="!"),t&&(n=e[r].split(t),e[r]=n[1],n=n[0]+t);return e.sort((function(e,t){var n=Helpers.getCoordsFromColumnName(e),r=Helpers.getCoordsFromColumnName(t);return n[1]>r[1]?1:n[1]<r[1]?-1:n[0]>r[0]?1:n[0]<r[0]?-1:0})),e.length?n+(e[0]+":")+e[e.length-1]:"#REF!"},B.getTokensFromRange=function(e){if(0<e.indexOf(".")){var t=e.split(".");e=t[1],t=t[0]+"."}else 0<e.indexOf("!")?(t=e.split("!"),e=t[1],t=t[0]+"!"):t="";e=e.split(":");var n=B.getCoordsFromColumnName(e[0]),r=B.getCoordsFromColumnName(e[1]);if(n[0]<=r[0]){e=n[0];var a=r[0]}else e=r[0],a=n[0];if(null===n[1]&&null==r[1])for(var o=null,i=null,l=Object.keys(vars),s=0;s<l.length;s++){var u=B.getCoordsFromColumnName(l[s]);u[0]===n[0]&&(null===o||u[1]<o)&&(o=u[1]),u[0]===r[0]&&(null===i||u[1]>i)&&(i=u[1])}else n[1]<=r[1]?(o=n[1],i=r[1]):(o=r[1],i=n[1]);for(n=[];o<=i;o++){for(r=[],s=e;s<=a;s++)r.push(t+B.getColumnNameFromCoords(s,o));n.push(r)}return n},B.setFormula=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)"function"==typeof e[t[n]]&&(window[t[n]]=e[t[n]])},B}()},"object"===typeof U&&"undefined"!==typeof S?S.exports=w():r.formula=w()},{}],2:[function(e,t,n){var r,a;r=this,a=function(){var e=function(t){var n={},r=function e(t,n){return!(!t[n.type]||t[n.type]!=n)||!!t.parentNode&&e(t.parentNode,n)},a=function(t){if(0<e.current.length)for(var n=0;n<e.current.length;n++)e.current[n]&&!r(t.target,e.current[n])&&e.current[n].close()};return n.init=function(){document.addEventListener("click",a),n.version="4.9.0"},n.tracking=function(t,n){if(1==n)e.current=e.current.filter((function(e){return null!==e})),setTimeout((function(){e.current.push(t)}),0);else{var r=e.current.indexOf(t);0<=r&&(e.current[r]=null)}},n.path=function(e,t){if((e=e.split(".")).length){for(var n,r=this;1<e.length;){if(n=e.shift(),!r.hasOwnProperty(n)){if(void 0===t)return;r[n]={}}r=r[n]}return n=e.shift(),void 0!==t?(r[n]=t,!0):r[n]}return!1},n.setDictionary=function(t){n.dictionary=t;for(var r=0;r<e.calendar.weekdays.length;r++)t=e.translate(e.calendar.weekdays[r]),e.calendar.weekdays[r]&&(e.calendar.weekdays[r]=t,e.calendar.weekdaysShort[r]=t.substr(0,3));for(r=0;r<e.calendar.months.length;r++)(t=e.translate(e.calendar.months[r]))&&(e.calendar.months[r]=t,e.calendar.monthsShort[r]=t.substr(0,3))},n.dictionary={},n.translate=function(e){return n.dictionary[e]||e},n.current=[],n}();"undefined"!==typeof document&&e.init(),e.ajax=function(t,n){if(Array.isArray(t)){var r={instance:[],complete:n};if(0<t.length)for(var a=0;a<t.length;a++)t[a].multiple=r,r.instance.push(e.ajax(t[a]));return r}if(t.data||(t.data={}),t.type&&(t.method=t.type),t.method||(t.method="GET"),t.dataType||(t.dataType="json"),t.data){r=[];var o=function e(t,n){var r=[],a=Object.keys(t);if(a.length)for(var o=0;o<a.length;o++){var i=n?n+"["+a[o]+"]":a[o];if("object"==typeof t[a[o]]){i=e(t[a[o]],i);for(var l=Object.keys(i),s=0;s<l.length;s++)r[l[s]]=i[l[s]]}else r[i]=t[a[o]]}return r}(t.data),i=Object.keys(o);for(a=0;a<i.length;a++)r.push(i[a]+"="+encodeURIComponent(o[i[a]]));"GET"==t.method&&0<r.length&&(0>t.url.indexOf("?")&&(t.url+="?"),t.url+=r.join("&"))}var l=new XMLHttpRequest;return l.open(t.method,t.url,!0),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),"POST"==t.method?(l.setRequestHeader("Accept","application/json"),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded")):"json"==t.dataType?l.setRequestHeader("Content-Type","text/json"):"blob"==t.dataType?l.responseType="blob":"html"==t.dataType&&l.setRequestHeader("Content-Type","text/html"),1!=t.cache&&(l.setRequestHeader("pragma","no-cache"),l.setRequestHeader("cache-control","no-cache")),1==t.withCredentials&&(l.withCredentials=!0),"function"==typeof t.beforeSend&&t.beforeSend(l),l.onload=function(){if(200===l.status)if("json"==t.dataType)try{var n=JSON.parse(l.responseText);t.success&&"function"==typeof t.success&&t.success(n)}catch(a){t.error&&"function"==typeof t.error&&t.error(a,n)}else n="blob"==t.dataType?l.response:l.responseText,t.success&&"function"==typeof t.success&&t.success(n);else t.error&&"function"==typeof t.error&&t.error(l.responseText,l.status);if(e.ajax.queue&&0<e.ajax.queue.length&&e.ajax.send(e.ajax.queue.shift()),e.ajax.requests&&e.ajax.requests.length){var r=e.ajax.requests.indexOf(l);e.ajax.requests.splice(r,1),e.ajax.requests.length||t.complete&&"function"==typeof t.complete&&t.complete(n),t.group&&e.ajax.oncomplete&&"function"==typeof e.ajax.oncomplete[t.group]&&!e.ajax.pending(t.group)&&(e.ajax.oncomplete[t.group](),e.ajax.oncomplete[t.group]=null),t.multiple&&t.multiple.instance&&(r=t.multiple.instance.indexOf(l),t.multiple.instance.splice(r,1),t.multiple.instance.length||t.multiple.complete&&"function"==typeof t.multiple.complete&&t.multiple.complete(n))}},l.options=t,l.data=r,1==t.queue&&0<e.ajax.requests.length?e.ajax.queue.push(l):e.ajax.send(l),l},e.ajax.send=function(t){t.data?t.send(t.data.join("&")):t.send(),e.ajax.requests.push(t)},e.ajax.exists=function(e,t){var n=new XMLHttpRequest;n.open("HEAD",e,!1),n.send(),n.status&&t(n.status)},e.ajax.pending=function(t){var n=0,r=e.ajax.requests;if(r&&r.length)for(var a=0;a<r.length;a++)t&&t!=r[a].options.group||n++;return n},e.ajax.oncomplete={},e.ajax.requests=[],e.ajax.queue=[],e.alert=function(t){800>e.getWindowWidth()&&e.dialog?e.dialog.open({title:"Alert",message:t}):alert(t)},e.animation={},e.animation.slideLeft=function(e,t,n){1==t?(e.classList.add("slide-left-in"),setTimeout((function(){e.classList.remove("slide-left-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-left-out"),setTimeout((function(){e.classList.remove("slide-left-out"),"function"==typeof n&&n()}),400))},e.animation.slideRight=function(e,t,n){1==t?(e.classList.add("slide-right-in"),setTimeout((function(){e.classList.remove("slide-right-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-right-out"),setTimeout((function(){e.classList.remove("slide-right-out"),"function"==typeof n&&n()}),400))},e.animation.slideTop=function(e,t,n){1==t?(e.classList.add("slide-top-in"),setTimeout((function(){e.classList.remove("slide-top-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-top-out"),setTimeout((function(){e.classList.remove("slide-top-out"),"function"==typeof n&&n()}),400))},e.animation.slideBottom=function(e,t,n){1==t?(e.classList.add("slide-bottom-in"),setTimeout((function(){e.classList.remove("slide-bottom-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-bottom-out"),setTimeout((function(){e.classList.remove("slide-bottom-out"),"function"==typeof n&&n()}),100))},e.animation.fadeIn=function(e,t){e.style.display="",e.classList.add("fade-in"),setTimeout((function(){e.classList.remove("fade-in"),"function"==typeof t&&t()}),2e3)},e.animation.fadeOut=function(e,t){e.classList.add("fade-out"),setTimeout((function(){e.style.display="none",e.classList.remove("fade-out"),"function"==typeof t&&t()}),1e3)},e.calendar=function(t,n){if(t.calendar)return t.calendar.setOptions(n,!0);var r={type:"calendar",options:{},date:null,setOptions:function(n,a){for(var o={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:e.calendar.monthsShort,monthsFull:e.calendar.months,weekdays:e.calendar.weekdays,weekdays_short:e.calendar.weekdays,textDone:e.translate("Done"),textReset:e.translate("Reset"),textUpdate:e.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null},i=0;i<o.weekdays_short.length;i++)o.weekdays_short[i]=o.weekdays_short[i].substr(0,1);for(var l in o)n&&n.hasOwnProperty(l)?r.options[l]=n[l]:"undefined"!=typeof r.options[l]&&!0!==a||(r.options[l]=o[l]);return s.style.display=0==r.options.resetButton?"none":"",r.options.readonly?t.setAttribute("readonly","readonly"):t.removeAttribute("readonly"),r.options.placeholder?t.setAttribute("placeholder",r.options.placeholder):t.removeAttribute("placeholder"),e.isNumeric(r.options.value)&&0<r.options.value&&(r.options.value=e.calendar.numToDate(r.options.value),r.options.dataType="numeric"),s.innerHTML=r.options.textReset,u.innerHTML=r.options.textDone,b.innerHTML=r.options.textUpdate,t.setAttribute("data-mask",r.options.format.toLowerCase()),(o=!r.options.value&&r.options.today?e.calendar.now():r.options.value)&&(r.options.value=null,r.setValue(o)),r},open:function(n){if(!l.classList.contains("jcalendar-focus")&&!l.classList.contains("jcalendar-inline")){if(e.calendar.current=r,e.tracking(r,!0),r.getDays(),"year-month-picker"==r.options.type&&r.getMonths(),r.options.time&&(w.value=r.date[3],C.value=r.date[4]),l.classList.add("jcalendar-focus"),800>e.getWindowWidth()||r.options.fullscreen)l.classList.add("jcalendar-fullsize"),e.animation.slideBottom(d,1);else{l.classList.remove("jcalendar-fullsize"),n=t.getBoundingClientRect();var a=d.getBoundingClientRect();if(r.options.position)c.style.position="fixed",c.style.top=window.innerHeight<n.bottom+a.height?n.top-(a.height+2)+"px":n.top+n.height+2+"px",c.style.left=n.left+"px";else{if(window.innerHeight<n.bottom+a.height){var o=-1*(n.height+a.height+2);0>o+n.top&&(o=-1*(n.top+n.height)),c.style.top=o+"px"}else c.style.top="2px";window.innerWidth<n.left+a.width?(o=window.innerWidth-(n.left+a.width+20),c.style.left=o+"px"):c.style.left="0px"}}"function"==typeof r.options.onopen&&r.options.onopen(t)}},close:function(n,a){if(l.classList.contains("jcalendar-focus")){if(!1!==a){var o=l.querySelector(".jcalendar-selected");o="string"==typeof a?a:!o||o.classList.contains("jcalendar-disabled")?r.options.value:r.getValue(),r.setValue(o)}n||"function"!=typeof r.options.onclose||r.options.onclose(t),l.classList.remove("jcalendar-focus"),e.tracking(r,!1),e.calendar.current=null}return r.options.value},prev:function(){"years"==r.options.mode?(r.date[0]-=12,r.getYears()):"months"==r.options.mode?(r.date[0]=parseInt(r.date[0])-1,r.getMonths()):(2>r.date[1]?(--r.date[0],r.date[1]=12):--r.date[1],r.getDays())},next:function(){"years"==r.options.mode?(r.date[0]=parseInt(r.date[0])+12,r.getYears()):"months"==r.options.mode?(r.date[0]=parseInt(r.date[0])+1,r.getMonths()):(11<r.date[1]?(r.date[0]=parseInt(r.date[0])+1,r.date[1]=1):r.date[1]=parseInt(r.date[1])+1,r.getDays())},setToday:function(){var e=(new Date).toISOString().substr(0,10);return r.setValue(e),e},setValue:function(e){e||(e=""+e);var n=e,a=r.options.value;if(a!=n){if(n){r.setLabel(n,r.options);var o=n.split(" ");o[1]||(o[1]="00:00:00");var i=o[1].split(":");o=o[0].split("-"),e=parseInt(o[0]);var l=parseInt(o[1]);o=parseInt(o[2]);var s=parseInt(i[0]);i=parseInt(i[1]),r.date=[e,l,o,s,i,0],e=r.setLabel(n,r.options)}else r.date=null,e="";r.options.value=n,"function"==typeof r.options.onchange&&r.options.onchange(t,n,a),t.value!=e&&(t.value=e,"function"==typeof t.onchange)&&t.onchange({type:"change",target:t,value:t.value})}r.getDays()},getValue:function(){return r.date?r.options.time?e.two(r.date[0])+"-"+e.two(r.date[1])+"-"+e.two(r.date[2])+" "+e.two(r.date[3])+":"+e.two(r.date[4])+":"+e.two(0):e.two(r.date[0])+"-"+e.two(r.date[1])+"-"+e.two(r.date[2])+" "+e.two(0)+":"+e.two(0)+":"+e.two(0):""},update:function(e,t){if(!e.classList.contains("jcalendar-disabled")){var n=l.querySelector(".jcalendar-selected");n&&n.classList.remove("jcalendar-selected"),e.classList.add("jcalendar-selected"),e.classList.contains("jcalendar-set-month")?r.date[1]=t:r.date[2]=e.innerText,r.options.time?(r.date[3]=w.value,r.date[4]=C.value):r.close()}i()},reset:function(){r.setValue(""),r.date=null,r.close(!1,!1)},getDays:function(){r.options.mode="days";var t=new Date,n=r.date&&e.isNumeric(r.date[0])?r.date[0]:parseInt(t.getFullYear()),a=r.date&&e.isNumeric(r.date[1])?r.date[1]:parseInt(t.getMonth())+1,o=r.date&&e.isNumeric(r.date[2])?r.date[2]:parseInt(t.getDate()),l=r.date&&e.isNumeric(r.date[3])?r.date[3]:parseInt(t.getHours()),s=r.date&&e.isNumeric(r.date[4])?r.date[4]:parseInt(t.getMinutes());r.date=[n,a,o,l,s,0],p.innerHTML=n,f.innerHTML=r.options.months[a-1],l=t.getMonth()==a-1&&t.getFullYear()==n,s=t.getDate();var u=(t=new Date(n,a,0,0,0)).getDate();t=(t=new Date(n,a-1,0,0,0)).getDay()+1;var c=r.options.startingDay||0;t-=c,m.innerHTML="";var d=document.createElement("tr");d.setAttribute("align","center"),m.appendChild(d);for(var h=0;7>h;h++){var g=document.createElement("td");g.classList.add("jcalendar-weekday"),g.innerHTML=r.options.weekdays_short[c],d.appendChild(g),6<++c&&(c=0)}for(var y=c=0,b=0;6>b;b++){(d=document.createElement("tr")).setAttribute("align","center");var w=!0;for(h=0;7>h;h++){if((g=document.createElement("td")).classList.add("jcalendar-set-day"),c>=t&&c<t+u){if(y++,g.innerHTML=y,y==o&&g.classList.add("jcalendar-selected"),l&&s==y&&(g.style.fontWeight="bold"),w=e.calendar.now(new Date(n,a-1,y),!0),r.options.validRange){var C=!r.options.validRange[1]||w<=r.options.validRange[1];(!r.options.validRange[0]||w>=r.options.validRange[0])&&C||g.classList.add("jcalendar-disabled")}w=!1}d.appendChild(g),c++}0==w&&m.appendChild(d)}v.style.display=r.options.time?"":"none",i()},getMonths:function(){r.options.mode="months";var t=r.options.months,n=new Date,a=parseInt(n.getFullYear());n=parseInt(n.getMonth())+1;var o=r.date&&e.isNumeric(r.date[0])?r.date[0]:a,l=r.date&&e.isNumeric(r.date[1])?r.date[1]:n;p.innerHTML=r.date[0],f.innerHTML=t[l-1];var s=document.createElement("table");s.setAttribute("width","100%");for(var u=null,c=0;12>c;c++){c%4||((u=document.createElement("tr")).setAttribute("align","center"),s.appendChild(u));var d=document.createElement("td");if(d.classList.add("jcalendar-set-month"),d.setAttribute("data-value",c+1),d.innerText=t[c],r.options.validRange){var h=o+"-"+e.two(c+1),g=!r.options.validRange[0]||h>=r.options.validRange[0].substr(0,7);h=!r.options.validRange[1]||h<=r.options.validRange[1].substr(0,7),g&&h||d.classList.add("jcalendar-disabled")}c+1==l&&d.classList.add("jcalendar-selected"),a==o&&c+1==n&&(d.style.fontWeight="bold"),u.appendChild(d)}m.innerHTML='<tr><td colspan="7"></td></tr>',m.children[0].children[0].appendChild(s),i()},getYears:function(){r.options.mode="years";var t=new Date,n=t.getFullYear();t=r.date&&e.isNumeric(r.date[0])?r.date[0]:parseInt(t.getFullYear());for(var a=[],o=0;25>o;o++)a[o]=parseInt(r.date[0])+(o-12);var l=document.createElement("table");for(l.setAttribute("width","100%"),o=0;25>o;o++){if(!(o%5)){var s=document.createElement("tr");s.setAttribute("align","center"),l.appendChild(s)}var u=document.createElement("td");u.classList.add("jcalendar-set-year"),u.innerText=a[o],t==a[o]&&u.classList.add("jcalendar-selected"),n==a[o]&&(u.style.fontWeight="bold"),s.appendChild(u)}m.innerHTML='<tr><td colspan="7"></td></tr>',m.firstChild.firstChild.appendChild(l),i()},setLabel:function(t,n){return e.calendar.getDateString(t,n)},fromFormatted:function(t,n){return e.calendar.extractDateFromString(t,n)}},a=function(t){if(e.findElement(t.target,"jcalendar-container")){var n=t.target.className;"jcalendar-prev"==n?r.prev():"jcalendar-next"==n?r.next():"jcalendar-month"==n?r.getMonths():"jcalendar-year"==n?r.getYears():"jcalendar-set-year"==n?(r.date[0]=t.target.innerText,"year-month-picker"==r.options.type?r.getMonths():r.getDays()):t.target.classList.contains("jcalendar-set-month")?(n=parseInt(t.target.getAttribute("data-value")),"year-month-picker"==r.options.type?r.update(t.target,n):(r.date[1]=n,r.getDays())):"jcalendar-confirm"==n||"jcalendar-update"==n||"jcalendar-close"==n?r.close():"jcalendar-backdrop"==n?r.close(!1,!1):"jcalendar-reset"==n?r.reset():t.target.classList.contains("jcalendar-set-day")&&t.target.innerText&&r.update(t.target)}else r.close()},o=function(t){t.target.value&&3<t.target.value.length&&(t=e.calendar.extractDateFromString(t.target.value,r.options.format))&&r.setValue(t)},i=function(){var e=l.querySelector(".jcalendar-selected");e&&e.classList.contains("jcalendar-disabled")?(b.setAttribute("disabled","disabled"),w.setAttribute("disabled","disabled"),C.setAttribute("disabled","disabled")):(b.removeAttribute("disabled"),w.removeAttribute("disabled"),C.removeAttribute("disabled")),"function"==typeof r.options.onupdate&&r.options.onupdate(t,r.getValue())},l=null,s=null,u=null,c=null,d=null,p=null,f=null,h=null,m=null,g=null,v=null,y=null,b=null,w=null,C=null;return function(){"INPUT"==t.tagName&&t.value&&(n.value=t.value),(s=document.createElement("div")).className="jcalendar-reset",(u=document.createElement("div")).className="jcalendar-confirm",(g=document.createElement("div")).className="jcalendar-controls",g.style.borderBottom="1px solid #ddd",g.appendChild(s),g.appendChild(u),(c=document.createElement("div")).className="jcalendar-container",(d=document.createElement("div")).className="jcalendar-content",c.appendChild(d),"DIV"==t.tagName?(l=t).classList.add("jcalendar-inline"):(d.appendChild(g),(l=document.createElement("div")).className="jcalendar"),l.classList.add("jcalendar-container"),l.appendChild(c);var i=document.createElement("div");i.className="jcalendar-table",d.appendChild(i);var E=document.createElement("td");E.setAttribute("colspan","2"),E.className="jcalendar-prev",(p=document.createElement("span")).className="jcalendar-year",(f=document.createElement("span")).className="jcalendar-month";var x=document.createElement("td");x.className="jcalendar-header",x.setAttribute("colspan","3"),x.appendChild(f),x.appendChild(p);var A=document.createElement("td");A.setAttribute("colspan","2"),A.className="jcalendar-next";var N=document.createElement("thead"),L=document.createElement("tr");for(L.appendChild(E),L.appendChild(x),L.appendChild(A),N.appendChild(L),h=document.createElement("table"),m=document.createElement("tbody"),h.setAttribute("cellpadding","0"),h.setAttribute("cellspacing","0"),h.appendChild(N),h.appendChild(m),i.appendChild(h),(w=document.createElement("select")).className="jcalendar-select",w.onchange=function(){r.date[3]=this.value,"function"==typeof r.options.onupdate&&r.options.onupdate(t,r.getValue())},i=0;24>i;i++)(E=document.createElement("option")).value=i,E.innerHTML=e.two(i),w.appendChild(E);for((C=document.createElement("select")).className="jcalendar-select",C.onchange=function(){r.date[4]=this.value,"function"==typeof r.options.onupdate&&r.options.onupdate(t,r.getValue())},i=0;60>i;i++)(E=document.createElement("option")).value=i,E.innerHTML=e.two(i),C.appendChild(E);(i=document.createElement("div")).className="jcalendar-controls",(v=document.createElement("div")).className="jcalendar-time",v.style.maxWidth="140px",v.appendChild(w),v.appendChild(C),(b=document.createElement("button")).setAttribute("type","button"),b.className="jcalendar-update",(y=document.createElement("div")).style.flexGrow="10",y.appendChild(b),i.appendChild(v),"INPUT"==t.tagName&&i.appendChild(y),d.appendChild(i),(i=document.createElement("div")).className="jcalendar-backdrop",l.appendChild(i),t.addEventListener("keyup",o),l.addEventListener("swipeleft",(function(t){e.animation.slideLeft(h,0,(function(){r.next(),e.animation.slideRight(h,1)})),t.preventDefault(),t.stopPropagation()})),l.addEventListener("swiperight",(function(t){e.animation.slideRight(h,0,(function(){r.prev(),e.animation.slideLeft(h,1)})),t.preventDefault(),t.stopPropagation()})),t.onmouseup=function(){r.open()},!0==="ontouchend"in document.documentElement?l.addEventListener("touchend",a):l.addEventListener("mouseup",a),e.calendar.hasEvents||(e.calendar.hasEvents=!0,document.addEventListener("keydown",e.calendar.keydown)),r.setOptions(n),"INPUT"==t.tagName?(t.parentNode.insertBefore(l,t.nextSibling),t.setAttribute("autocomplete","off"),t.classList.add("jcalendar-input"),t.value=r.setLabel(r.getValue(),r.options)):(r.getDays(),r.options.time&&(w.value=r.date[3],C.value=r.date[4])),1==r.options.opened&&r.open(),t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},t.calendar=l.calendar=r}(),r},e.calendar.keydown=function(t){var n;(n=e.calendar.current)&&(13==t.which?n.close(!1,!0):27==t.which&&n.close(!1,!1))},e.calendar.prettify=function(e,t){t||(t={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"});var n=parseInt((new Date-new Date(e))/1e3/60);return String.prototype.format=function(e){return this.replace("{0}",e)},0==n?t.justNow:90>n?t.xMinutesAgo.format(n):1440>n?t.xHoursAgo.format(Math.round(n/60)):20160>n?t.xDaysAgo.format(Math.round(n/1440)):43200>n?t.xWeeksAgo.format(Math.round(n/10080)):1036800>n?t.xMonthsAgo.format(Math.round(n/43200)):t.xYearsAgo.format(Math.round(n/525600))},e.calendar.prettifyAll=function(){for(var t=document.querySelectorAll(".prettydate"),n=0;n<t.length;n++)t[n].getAttribute("data-date")?t[n].innerHTML=e.calendar.prettify(t[n].getAttribute("data-date")):(t[n].setAttribute("data-date",t[n].innerHTML),t[n].innerHTML=e.calendar.prettify(t[n].innerHTML))},e.calendar.now=function(t,n){if(Array.isArray(t))var r=t[0],a=t[1],o=t[2],i=t[3],l=t[4],s=t[5];else t||(t=new Date),r=t.getFullYear(),a=t.getMonth()+1,o=t.getDate(),i=t.getHours(),l=t.getMinutes(),s=t.getSeconds();return 1==n?e.two(r)+"-"+e.two(a)+"-"+e.two(o):e.two(r)+"-"+e.two(a)+"-"+e.two(o)+" "+e.two(i)+":"+e.two(l)+":"+e.two(s)},e.calendar.toArray=function(e){var t=e.split(-1!==e.indexOf("T")?"T":" "),n=t[1];t=t[0].split("-"),e=parseInt(t[0]);var r=parseInt(t[1]);if(t=parseInt(t[2]),n){n=n.split(":");var a=parseInt(n[0]);n=parseInt(n[1])}else n=a=0;return[e,r,t,a,n,0]},e.calendar.extractDateFromString=function(t,n){if(0<t&&Number(t)==t){var r=new Date(Math.round(864e5*(t-25569)));return r.getFullYear()+"-"+e.two(r.getMonth())+"-"+e.two(r.getDate())+" 00:00:00"}var a=""+t,o=n.replace(/[0-9]/g,""),i=1,l=o.search("YYYY");l=a.substr(l,4),parseInt(l)!=l&&(i=0);var s=o.search("MM");s=a.substr(s,2),(parseInt(s)!=s||12<s)&&(i=0),r=o.search("DD"),r=a.substr(r,2),(parseInt(r)!=r||31<r)&&(i=0);var u=o.search("HH");0<=u?(u=a.substr(u,2),(!parseInt(u)||23<u)&&(u="00")):u="00";var c=o.search("MI");0<=c?(c=a.substr(c,2),(!parseInt(c)||59<c)&&(c="00")):c="00";var d=o.search("SS");return 0<=d?(d=a.substr(d,2),(!parseInt(d)||59<d)&&(d="00")):d="00",1==i&&t.length==o.length?l+"-"+s+"-"+r+" "+u+":"+c+":"+d:""},e.calendar.dateToNum=function(e,t){e=new Date(e),t||(t="1899-12-30 "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()),t=new Date(t);var n=e.getTime()-t.getTime();return Math.round(n/864e5)},e.calendar.numToDate=function(t){return(t=new Date(Math.round(864e5*(t-25569)))).getFullYear()+"-"+e.two(t.getMonth()+1)+"-"+e.two(t.getDate())+" 00:00:00"},e.calendar.getDateString=function(t,n){n||(n={});var r,a=n&&"object"==typeof n?n.format:n;if(a||(a="YYYY-MM-DD"),"number"==typeof t&&0<=a.indexOf("[h]")){var o=parseFloat(24*Number(t));if(0<=a.indexOf("mm")){var i=(""+o).split(".");i[1]?(o=60*parseFloat("0."+i[1]),o=parseFloat(o.toFixed(2))):o=0,o=parseInt(i[0])+":"+e.two(o)}return o}for(t instanceof Date?t=e.calendar.now(t):t&&e.isNumeric(t)&&(t=e.calendar.numToDate(t)),a=a.match(RegExp("DAY|WD|DDDD|DDD|DD|D|Q|HH24|HH12|HH|H|AM/PM|MI|SS|MS|YYYY|YYY|YY|Y|MONTH|MON|MMMMM|MMMM|MMM|MM|M|.","gi")),o=0;o<a.length;o++)"MM"==a[o].toUpperCase()&&(a[o-1]&&0<=a[o-1].toUpperCase().indexOf("H")||a[o-2]&&0<=a[o-2].toUpperCase().indexOf("H")||a[o+1]&&0<=a[o+1].toUpperCase().indexOf("S")||a[o+2]&&0<=a[o+2].toUpperCase().indexOf("S"))&&(a[o]="mi");if(t){i=-1!==(o=""+t).indexOf("T")?"T":" ",o=o.split(i);var l=r=i=0;if(o[1]&&(r=(i=o[1].split(":"))[1]?i[1]:0,l=i[2]?i[2]:0,i=i[0]?i[0]:0),(o=o[0].split("-"))[0]&&o[1]&&o[2]&&0<o[0]&&0<o[1]&&13>o[1]&&0<o[2]&&32>o[2]){for(i=[o[0],o[1],o[2],i,r,l],r=[],l=new Date(i[0],i[1]-1,i[2],i[3],i[4],i[5]),o=0;o<a.length;o++){var s=o,u=a[s],c=u.toUpperCase(),d=null;"YYYY"===c?d=i[0]:"YYY"===c?d=i[0].substring(1,4):"YY"===c?d=i[0].substring(2,4):"Y"===c?d=i[0].substring(3,4):"MON"===u?d=e.calendar.months[l.getMonth()].substr(0,3).toUpperCase():"mon"===u?d=e.calendar.months[l.getMonth()].substr(0,3).toLowerCase():"MONTH"===u?d=e.calendar.months[l.getMonth()].toUpperCase():"month"===u?d=e.calendar.months[l.getMonth()].toLowerCase():"MMMMM"===c?d=e.calendar.months[l.getMonth()].substr(0,1):"MMMM"===c||"Month"===u?d=e.calendar.months[l.getMonth()]:"MMM"===c||"Mon"==u?d=e.calendar.months[l.getMonth()].substr(0,3):"MM"===c?d=e.two(i[1]):"M"===c?d=l.getMonth()+1:"DAY"===u?d=e.calendar.weekdays[l.getDay()].toUpperCase():"day"===u?d=e.calendar.weekdays[l.getDay()].toLowerCase():"DDDD"===c||"Day"==u?d=e.calendar.weekdays[l.getDay()]:"DDD"===c?d=e.calendar.weekdays[l.getDay()].substr(0,3):"DD"===c?d=e.two(i[2]):"D"===c?d=i[2]:"Q"===c?d=Math.floor((l.getMonth()+3)/3):"HH24"===c||"HH"===c?d=e.two(i[3]):"HH12"===c?d=12<i[3]?e.two(i[3]-12):e.two(i[3]):"H"===c?d=i[3]:"MI"===c?d=e.two(i[4]):"SS"===c?d=e.two(i[5]):"MS"===c?d=l.getMilliseconds():"AM/PM"===c?d=12<=i[3]?"PM":"AM":"WD"===c&&(d=e.calendar.weekdays[l.getDay()]),r[s]=null===d?a[s]:d}t=r.join("")}else t=""}return t},e.calendar.weekdays="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),e.calendar.months="January February March April May June July August September October November December".split(" "),e.calendar.weekdaysShort="Sun Mon Tue Wed Thu Fri Sat".split(" "),e.calendar.monthsShort="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),e.color=function(t,n){if(t.color)return t.color.setOptions(n,!0);var r={type:"color",options:{}},a=null,o=null,i=null,l=null,s=null,u=null,c=null;r.setOptions=function(n,a){var o={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};for(var i in n||(n={}),n&&!n.palette&&(n.palette=e.palette()),o)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:"undefined"!=typeof r.options[i]&&!0!==a||(r.options[i]=o[i]);return l&&(l.innerHTML=r.options.resetLabel),s&&(s.innerHTML=r.options.doneLabel),r.options.palette&&c&&c.updateContent(0,h()),"string"===typeof r.options.value&&(t.value=r.options.value),r.options.placeholder?t.setAttribute("placeholder",r.options.placeholder):t.getAttribute("placeholder")&&t.removeAttribute("placeholder"),r},r.open=function(){if(!a.classList.contains("jcolor-focus")){e.tracking(r,!0),a.classList.add("jcolor-focus");var n=i.getBoundingClientRect();if(800>e.getWindowWidth()||1==r.options.fullscreen)i.style.top="",i.classList.add("jcolor-fullscreen"),e.animation.slideBottom(i,1),o.style.display="block";else{i.classList.contains("jcolor-fullscreen")&&(i.classList.remove("jcolor-fullscreen"),o.style.display="");var l=t.getBoundingClientRect();r.options.position?(i.style.position="fixed",i.style.top=window.innerHeight<l.bottom+n.height?l.top-(n.height+2)+"px":l.top+l.height+2+"px",i.style.left=l.left+"px"):i.style.top=window.innerHeight<l.bottom+n.height?-1*(n.height+l.height+2)+"px":"2px"}if("function"==typeof r.options.onopen&&r.options.onopen(t),c.setBorder(c.getActive()),r.options.value){var s=f(r.options.value);w.forEach((function(e,t){e.value=s[t],e.dispatchEvent(new Event("input"))}))}}},r.close=function(n){return a.classList.contains("jcolor-focus")&&(a.classList.remove("jcolor-focus"),o.style.display="",n||"function"!=typeof r.options.onclose||r.options.onclose(t),e.tracking(r,!1)),r.options.value},r.setValue=function(e){if(e||(e=""),e!=r.options.value){b=r.options.value=e;var n=a.querySelector(".jcolor-selected");n&&n.classList.remove("jcolor-selected"),r.values[e]&&r.values[e].classList.add("jcolor-selected"),"function"==typeof r.options.onchange&&r.options.onchange(t,e),t.value!=r.options.value&&(t.value=r.options.value,"function"==typeof t.onchange)&&t.onchange({type:"change",target:t,value:t.value}),1==r.options.closeOnChange&&r.close()}},r.getValue=function(){return r.options.value};var d=!1,p=function(e){return 1===(e=e.toString(16)).length?"0"+e:e},f=function(e){return[parseInt("0x"+e.substr(1,2)),parseInt("0x"+e.substr(3,2)),parseInt("0x"+e.substr(5,2))]},h=function(){var e=document.createElement("div");e.className="jcolor-grid",r.values=[];var t=document.createElement("table");t.setAttribute("cellpadding","7"),t.setAttribute("cellspacing","0");for(var n=0;n<r.options.palette.length;n++){for(var a=document.createElement("tr"),o=0;o<r.options.palette[n].length;o++){var i=document.createElement("td"),l=r.options.palette[n][o];7>l.length&&"#"!==l.substr(0,1)&&(l="#"+l),i.style.backgroundColor=l,i.setAttribute("data-value",l),i.innerHTML="",a.appendChild(i),r.options.value==l&&i.classList.add("jcolor-selected"),r.values[l]=i}t.appendChild(a)}return e.appendChild(t),e.addEventListener("mousedown",(function(e){"TD"==e.target.tagName&&(e=e.target.getAttribute("data-value"))&&r.setValue(e)})),e},m=document.createElement("canvas");m.width=200,m.height=160;var g=m.getContext("2d"),v=function(){var e=u.firstChild.getBoundingClientRect();m.width=e.width-14,(e=g.createLinearGradient(0,0,m.width,0)).addColorStop(0,"rgb(255,0,0)"),e.addColorStop(.15,"rgb(255,0,255)"),e.addColorStop(.33,"rgb(0,0,255)"),e.addColorStop(.49,"rgb(0,255,255)"),e.addColorStop(.67,"rgb(0,255,0)"),e.addColorStop(.84,"rgb(255,255,0)"),e.addColorStop(1,"rgb(255,0,0)"),g.fillStyle=e,g.fillRect(0,0,m.width,m.height),(e=g.createLinearGradient(0,0,0,m.height)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(.5,"rgba(255,255,255,0)"),e.addColorStop(.5,"rgba(0,0,0,0)"),e.addColorStop(1,"rgba(0,0,0,1)"),g.fillStyle=e,g.fillRect(0,0,m.width,m.height)},y=function(){var e=document.createElement("div");e.className="jcolor-hsl";var t=document.createElement("div");t.className="jcolor-point";var n=document.createElement("div");n.appendChild(m),n.appendChild(t),e.appendChild(n);var r=function(n,r,a){1===n&&(0>(r-=(n=e.getBoundingClientRect()).left)&&(r=0),0>(a-=n.top)&&(a=0),r>n.width&&(r=n.width),a>n.height&&(a=n.height),t.style.left=r+"px",t.style.top=a+"px",n=(a=g.getImageData(r,a,1,1).data)[1],r=a[2],b="#"+p(a[0])+p(n)+p(r))};return e.addEventListener("mousedown",(function(e){r(e.buttons,e.clientX,e.clientY)})),e.addEventListener("mousemove",(function(e){r(e.buttons,e.clientX,e.clientY)})),e.addEventListener("touchmove",(function(e){r(1,e.changedTouches[0].clientX,e.changedTouches[0].clientY)})),e},b="",w=[],C=function(){var e=document.createElement("div");e.className="jcolor-sliders";var t=document.createElement("div"),n=function(e){var n=document.createElement("div");n.className="jcolor-sliders-input-container";var r=document.createElement("label");r.innerText=e,(e=document.createElement("div")).className="jcolor-sliders-input-subcontainer";var a=document.createElement("input");a.type="range",a.min=0,a.max=255,a.value=0,n.appendChild(r),e.appendChild(a);var o=document.createElement("div");return o.innerText=a.value,a.addEventListener("input",(function(){o.innerText=a.value})),e.appendChild(o),n.appendChild(e),t.appendChild(n),a};w=[n("Red"),n("Green"),n("Blue")],e.appendChild(t),(n=document.createElement("div")).className="jcolor-sliders-final-color";var r=document.createElement("div");return r.style.visibility="hidden",r.innerText="a",n.appendChild(r),w.forEach((function(e){e.addEventListener("input",(function(){var e=parseInt(w[0].value),t=parseInt(w[1].value),n=parseInt(w[2].value);if(e="#"+p(e)+p(t)+p(n),r.innerText=e,r.style.color=e,r.style.removeProperty("visibility"),""!==(b=e))for(e=0;e<w.length;e++)(t=f(b))[e]=0,n="linear-gradient(90deg, rgb(",n+=t.join(", "),n+="), rgb(",t[e]=255,n+=t.join(", "),n+="))",w[e].style.backgroundImage=n}))})),e.appendChild(n),e};return function(){r.setOptions(n),"INPUT"==t.tagName&&(t.classList.add("jcolor-input"),t.readOnly=!0),(a=document.createElement("div")).className="jcolor",(o=document.createElement("div")).className="jcolor-backdrop",a.appendChild(o),(i=document.createElement("div")).className="jcolor-content";var p=document.createElement("div");p.className="jcolor-controls",i.appendChild(p),(l=document.createElement("div")).className="jcolor-reset",l.innerHTML=r.options.resetLabel,l.onclick=function(e){r.setValue(""),r.close()},p.appendChild(l),(s=document.createElement("div")).className="jcolor-close",s.innerHTML=r.options.doneLabel,s.onclick=function(e){0<c.getActive()&&r.setValue(b),r.close()},p.appendChild(s),u=document.createElement("div"),i.appendChild(u),c=e.tabs(u,{animation:!0,data:[{title:"Grid",contentElement:h()},{title:"Spectrum",contentElement:y()},{title:"Sliders",contentElement:C()}],onchange:function(e,t,n){if(1===n)v();else if(e=""!==b?b:r.getValue(),2===n&&e){var a=f(e);w.forEach((function(e,t){e.value=a[t],e.dispatchEvent(new Event("input"))}))}},palette:"modern"}),a.appendChild(i),"INPUT"==t.tagName?t.parentNode.insertBefore(a,t.nextSibling):t.appendChild(a),t.addEventListener("mouseup",(function(e){r.open()})),o.addEventListener("mousedown",(function(e){d=!0})),o.addEventListener("mouseup",(function(e){d&&(r.close(),d=!1)})),window.addEventListener("resize",(function(){a.classList.contains("jcolor-focus")&&1==c.getActive()&&v()})),1==r.options.opened&&r.open(),t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},t.color=r,a.color=r}(),r},e.contextmenu=function(t,n){function r(e){if(!e.type||"line"!=e.type&&"divisor"!=e.type){o=document.createElement("div");var t=document.createElement("a");if(t.innerHTML=e.title,e.tooltip&&o.setAttribute("title",e.tooltip),e.icon&&o.setAttribute("data-icon",e.icon),e.id&&(o.id=e.id),e.disabled?o.className="jcontextmenu-disabled":e.onclick&&(o.method=e.onclick,o.addEventListener("mousedown",(function(e){e.preventDefault()})),o.addEventListener("mouseup",(function(){this.method(this)}))),o.appendChild(t),e.submenu){(t=document.createElement("span")).innerHTML="&#9658;",o.appendChild(t),o.classList.add("jcontexthassubmenu"),(t=document.createElement("div")).classList.add("jcontextmenu"),t.setAttribute("tabindex","900"),e=e.submenu;for(var n=0;n<e.length;n++){var a=r(e[n]);t.appendChild(a)}o.appendChild(t)}else e.shortcut&&((t=document.createElement("span")).innerHTML=e.shortcut,o.appendChild(t))}else var o=document.createElement("hr");return o}var a,o={options:{}},i={items:null,onclick:null};for(a in i)n&&n.hasOwnProperty(a)?o.options[a]=n[a]:o.options[a]=i[a];return t.classList.add("jcontextmenu"),t.setAttribute("tabindex","900"),o.open=function(e,n){if(n&&(o.options.items=n,o.create(n)),o.options.items&&0<o.options.items.length||t.children.length){if(e.target)var r=e.clientX,a=e.clientY;else r=e.x,a=e.y;t.classList.add("jcontextmenu-focus"),t.focus();var i=t.getBoundingClientRect();window.innerHeight<a+i.height?(0>(a-=i.height)&&(a=0),t.style.top=a+"px"):t.style.top=a+"px",t.style.left=window.innerWidth<r+i.width?0<r-i.width?r-i.width+"px":"10px":r+"px"}},o.close=function(){t.classList.contains("jcontextmenu-focus")&&t.classList.remove("jcontextmenu-focus")},o.create=function(e){t.innerHTML="";for(var n=0;n<e.length;n++){var a=r(e[n]);t.appendChild(a)}},"function"==typeof o.options.onclick&&t.addEventListener("click",(function(e){o.options.onclick(o,e)})),o.options.items&&o.create(o.options.items),t.addEventListener("blur",(function(e){o.close()})),e.contextmenu.hasEvents||(window.addEventListener("mousewheel",(function(){o.close()})),document.addEventListener("contextmenu",(function(t){var n=e.contextmenu.getElement(t.target);n&&((n=document.querySelector("#"+n))?(n.contextmenu.open(t),t.preventDefault()):console.error("JSUITES: Contextmenu id not found"))})),e.contextmenu.hasEvents=!0),t.contextmenu=o},e.contextmenu.getElement=function(e){var t=0;return function e(n){n.parentNode&&n.getAttribute("aria-contextmenu-id")?t=n.getAttribute("aria-contextmenu-id"):n.parentNode&&e(n.parentNode)}(e),t},e.dropdown=function(t,n){if(t.dropdown)return t.dropdown.setOptions(n,!0);var r={type:"dropdown",options:{}},a=function(e,n){e&&e.length&&(!1!==r.options.sortResults&&("function"==typeof r.options.sortResults?e.sort(r.options.sortResults):e.sort(o)),r.setData(e),"function"==typeof r.options.onload)&&r.options.onload(t,r,e,n),n&&l(n),void 0!==n&&null!==n||(r.options.value=""),t.value=r.options.value,1==r.options.opened&&r.open()},o=function(e,t){if("string"==typeof e)var n=e;else e.text?n=e.text:e.name&&(n=e.name);if("string"==typeof t)var r=t;else t.text?r=t.text:t.name&&(r=t.name);return"string"==typeof n||"string"==typeof r?("string"!=typeof n&&(n=""+n),"string"!=typeof r&&(r=""+r),n.localeCompare(r)):n-r},i=function(){r.value={};for(var e=0;e<r.items.length;e++)1==r.items[e].selected&&(r.items[e].element&&r.items[e].element.classList.remove("jdropdown-selected"),r.items[e].selected=null);r.options.value=""},l=function(e){if(i(),null!==e)if(e){Array.isArray(e)||(e=(""+e).split(";"));for(var t=0;t<e.length;t++)r.value[e[t]]=""}else"undefined"!==typeof r.value[""]&&(r.value[""]="");for(t=0;t<r.items.length;t++)"undefined"!==typeof r.value[s(t)]&&(r.items[t].element&&r.items[t].element.classList.add("jdropdown-selected"),r.items[t].selected=!0,r.value[s(t)]=u(t));r.options.value=Object.keys(r.value).join(";"),r.header.value=r.getText()},s=function(e,t){var n=r.options.format?"id":"value";return r.items[e]?void 0!==t?r.items[e].data[n]=t:r.items[e].data[n]:""},u=function(e,t){var n=r.options.format?"name":"text";return r.items[e]?void 0!==t?r.items[e].data[n]=t:r.items[e].data[n]:""},c=function(){for(var e=[],t=Object.keys(r.value),n=0;n<t.length;n++)e.push(r.value[t[n]]);return e};r.setOptions=function(n,o){n||(n={});var i,l={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,sortResults:!1,autofocus:!1};for(i in l)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:"undefined"!=typeof r.options[i]&&!0!==o||(r.options[i]=l[i]);return 1!=r.options.remoteSearch&&"searchbar"!==r.options.type||(r.options.autocomplete=!0),1==r.options.newOptions?r.header.classList.add("jdropdown-add"):r.header.classList.remove("jdropdown-add"),1==r.options.autocomplete?r.header.removeAttribute("readonly"):r.header.setAttribute("readonly","readonly"),r.options.placeholder?r.header.setAttribute("placeholder",r.options.placeholder):r.header.removeAttribute("placeholder"),t.classList.remove("jdropdown-searchbar"),t.classList.remove("jdropdown-picker"),t.classList.remove("jdropdown-list"),"searchbar"==r.options.type?t.classList.add("jdropdown-searchbar"):"list"==r.options.type?t.classList.add("jdropdown-list"):"picker"==r.options.type?t.classList.add("jdropdown-picker"):800>e.getWindowWidth()?r.options.autocomplete?(t.classList.add("jdropdown-searchbar"),r.options.type="searchbar"):(t.classList.add("jdropdown-picker"),r.options.type="picker"):(r.options.width?(t.style.width=r.options.width,t.style.minWidth=r.options.width):(t.style.removeProperty("width"),t.style.removeProperty("min-width")),t.classList.add("jdropdown-default"),r.options.type="default"),"searchbar"==r.options.type?d.appendChild(h):p.insertBefore(h,p.firstChild),r.options.url&&!n.data?e.ajax({url:r.options.url,method:"GET",dataType:"json",success:function(e){e&&a(e,r.options.value)}}):a(r.options.data,r.options.value),r};var d=null,p=null,f=null,h=null,m=null,g=null,v=null;r.getUrl=function(){return r.options.url},r.setUrl=function(t,n){r.options.url=t,e.ajax({url:r.options.url,method:"GET",dataType:"json",success:function(e){r.setData(e),"function"==typeof n&&n(r)}})},r.setId=function(e,t){var n=r.options.format?"id":"value";"object"==typeof e?e[n]=t:r.items[e].data[n]=t},r.add=function(t,n){if(!t){var a=1==r.options.autocomplete?r.header.value:"";if(!(t=prompt(e.translate("Add A New Option"),a)))return!1}if(n||(n=e.guid()),a=r.options.format?{id:n,name:t}:{value:n,text:t},"function"==typeof r.options.onbeforeinsert){var o=r.options.onbeforeinsert(r,a);if(!1===o)return!1;o&&(a=o)}return r.options.data.push(a),o=r.createItem(a),f.appendChild(o.element),"function"==typeof r.options.oninsert&&r.options.oninsert(r,a,o),"none"==f.style.display&&(f.style.display=""),r.results&&r.results.push(o),a},r.createItem=function(e,t,n){r.options.format?(e.id||void 0===e.value||(e.id=e.value),e.name||void 0===e.text||(e.name=e.text)):(e.value||void 0===e.id||(e.value=e.id),e.text||void 0===e.name||(e.text=e.name)),(n={}).element=document.createElement("div"),n.element.className="jdropdown-item",n.element.indexValue=r.items.length,n.data=e,t&&(n.group=t),e.id&&n.element.setAttribute("id",e.id),1==e.disabled&&n.element.setAttribute("data-disabled",!0),e.tooltip&&n.element.setAttribute("title",e.tooltip),e.image?((t=document.createElement("img")).className="jdropdown-image",t.src=e.image,e.title||t.classList.add("jdropdown-image-small"),n.element.appendChild(t)):e.icon?((t=document.createElement("span")).className="jdropdown-icon material-icons",t.innerText=e.icon,e.title||t.classList.add("jdropdown-icon-small"),e.color&&(t.style.color=e.color),n.element.appendChild(t)):e.color&&((t=document.createElement("div")).className="jdropdown-color",t.style.backgroundColor=e.color,n.element.appendChild(t));var a=r.options.format?e.name:e.text;return(t=document.createElement("div")).className="jdropdown-description",t.innerHTML=a||"&nbsp;",e.title&&((a=document.createElement("div")).className="jdropdown-title",a.innerText=e.title,t.appendChild(a)),r.value[r.options.format?e.id:e.value]&&(n.element.classList.add("jdropdown-selected"),n.selected=!0),r.items.push(n),n.element.appendChild(t),n},r.appendData=function(e){if(e.length){for(var t=[],n=[],a=0;a<e.length;a++)e[a].group?(n[e[a].group]||(n[e[a].group]=[]),n[e[a].group].push(a)):t.push(a);var o=0,i=Object.keys(n);if(0<i.length)for(a=0;a<i.length;a++){var l=document.createElement("div");l.className="jdropdown-group";var s=document.createElement("div");s.className="jdropdown-group-name",s.innerHTML=i[a];var u=document.createElement("i");u.className="jdropdown-group-arrow jdropdown-group-arrow-down",s.appendChild(u),(u=document.createElement("div")).className="jdropdown-group-items";for(var c=0;c<n[i[a]].length;c++){var d=r.createItem(e[n[i[a]][c]],l,i[a]);(0==r.options.lazyLoading||200>o)&&(u.appendChild(d.element),o++)}l.appendChild(s),l.appendChild(u),r.groups.push(l),0<u.children.length&&f.appendChild(l)}if(t.length)for(a=0;a<t.length;a++)d=r.createItem(e[t[a]]),(0==r.options.lazyLoading||200>o)&&(f.appendChild(d.element),o++)}},r.setData=function(e){if(e.length){for(var t=0;t<e.length;t++)"object"!=typeof e[t]&&(e[t]=r.options.format?{id:e[t],name:e[t]}:{value:e[t],text:e[t]});i(),f.innerHTML="",r.header.value="",r.items=[],r.appendData(e),r.options.data=e}},r.getData=function(){return r.options.data},r.getPosition=function(e){for(var t=0;t<r.items.length;t++)if(s(t)==e)return t;return!1},r.getText=function(e){var t=c();return e?t:t.join("; ")},r.getValue=function(e){var t=Object.keys(r.value);return e?t:t.join(";")};var y=function(e){"function"==typeof r.options.onchange&&r.options.onchange(t,r,e,r.options.value),t.value!=r.options.value&&(t.value=r.options.value,"function"==typeof t.onchange)&&t.onchange({type:"change",target:t,value:t.value})};return r.setValue=function(e){var t=r.getValue();Array.isArray(e)&&(e=e.join(";")),t!==e&&(l(e),y(t))},r.resetSelected=function(){r.setValue(null)},r.selectIndex=function(e,t){if(e=parseInt(e),r.items&&r.items[e]&&(!0===t||!0!==r.items[e].data.disabled))if(r.setCursor(e,!1),r.options.multiple){var n=r.options.value;r.items[e].selected?(r.items[e].element.classList.remove("jdropdown-selected"),r.items[e].selected=!1,delete r.value[s(e)]):(r.items[e].element.classList.add("jdropdown-selected"),r.items[e].selected=!0,r.value[s(e)]=u(e)),r.options.value=Object.keys(r.value).join(";"),0==r.options.autocomplete&&(r.header.value=c().join("; ")),y(n)}else r.items[e].selected?r.setValue(null):r.setValue(s(e)),r.close()},r.selectItem=function(e){r.selectIndex(e.indexValue)},r.find=function(t){if(r.search==t.trim())return!1;if(r.search=t,r.setCursor(),r.groups.length)for(var n=0;n<r.groups.length;n++)r.groups[n].lastChild.innerHTML="";if(f.innerHTML="",1==r.options.remoteSearch)r.results=null,n=r.options.url+(0<r.options.url.indexOf("?")?"&":"?")+"q="+t,e.ajax({url:n,method:"GET",dataType:"json",success:function(e){r.items=[];var t=Object.keys(r.value);if(t.length)for(var n=0;n<t.length;n++){e:{for(var a=t[n],o=0;o<e.length;o++)if(r.options.format){if(e[o].id==a){a=!0;break e}}else if(e[o].value==a){a=!0;break e}a=!1}a||(r.options.format?e.unshift({id:t[n],name:r.value[t[n]]}):e.unshift({value:t[n],text:r.value[t[n]]}))}r.appendData(e),f.style.display=e.length?"":"none"}});else{t=new RegExp(t,"gi");var a=[];for(n=0;n<r.items.length;n++){var o=u(n),i=r.items[n].data.title||"",l=r.items[n].data.group||"",s=r.items[n].data.synonym||"";s&&(s=s.join(" ")),(null==t||1==r.items[n].selected||o.match(t)||i.match(t)||l.match(t)||s.match(t))&&a.push(r.items[n])}if(a.length)for(f.style.display="",r.results=a,t=a.length||0,1==r.options.lazyLoading&&200<t&&(t=200),n=0;n<t;n++)r.results[n].group?(r.results[n].group.parentNode||f.appendChild(r.results[n].group),r.results[n].group.lastChild.appendChild(r.results[n].element)):f.appendChild(r.results[n].element);else f.style.display="none",r.results=null}1==r.options.autofocus&&r.first()},r.open=function(){if(!t.classList.contains("jdropdown-focus")){e.dropdown.current=r,e.tracking(r,!0),t.classList.add("jdropdown-focus"),800>e.getWindowWidth()&&(null==r.options.type||"picker"==r.options.type)&&e.animation.slideBottom(p,1),1==r.options.autocomplete&&(r.header.value=r.search,r.header.focus());var n=Object.keys(r.value);if(n[0]&&!1!==(n=r.getPosition(n[0]))&&r.setCursor(n),!r.options.type||"default"==r.options.type){n=t.getBoundingClientRect();var a=p.getBoundingClientRect();r.options.position?(p.style.position="fixed",window.innerHeight<n.bottom+a.height?(p.style.top="",p.style.bottom=window.innerHeight-n.top+1+"px"):(p.style.top=n.bottom+"px",p.style.bottom=""),p.style.left=n.left+"px"):window.innerHeight<n.bottom+a.height?(p.style.top="",p.style.bottom=n.height+1+"px"):(p.style.top="",p.style.bottom=""),p.style.minWidth=n.width+"px",r.options.maxWidth&&(p.style.maxWidth=r.options.maxWidth),f.style.display=r.items.length||1!=r.options.autocomplete?"":"none"}}"function"==typeof r.options.onopen&&r.options.onopen(t)},r.close=function(n){return t.classList.contains("jdropdown-focus")&&(r.header.value=r.getText(),r.setCursor(),n||"function"!=typeof r.options.onclose||r.options.onclose(t),r.header.blur&&r.header.blur(),t.classList.remove("jdropdown-focus"),e.tracking(r,!1),e.dropdown.current=null),r.getValue()},r.setCursor=function(e,t){if(null!=r.currentIndex&&r.items&&r.items[r.currentIndex]&&r.items[r.currentIndex].element.classList.remove("jdropdown-cursor"),void 0==e)r.currentIndex=null;else if(e=parseInt(e),r.items[e].element.parentNode&&(r.items[e].element.classList.add("jdropdown-cursor"),r.currentIndex=e,!1!==t&&r.items[r.currentIndex].element)){var n=r.items[r.currentIndex].element;f.scrollTop=n.offsetTop-n.scrollTop+n.clientTop-95}},r.resetCursor=r.setCursor,r.updateCursor=r.setCursor,r.reset=function(){r.setCursor(),r.setValue(null)},r.first=function(){!0===r.options.lazyLoading&&r.loadFirst();var e=f.querySelectorAll(".jdropdown-item");e.length&&r.setCursor(e[0].indexValue)},r.last=function(){!0===r.options.lazyLoading&&r.loadLast();var e=f.querySelectorAll(".jdropdown-item");e.length&&r.setCursor(e[e.length-1].indexValue)},r.next=function(e){var t=null;if(e){if(1==e.length){var n=r.currentIndex||-1;e=e.toLowerCase();var a,o,i=f.querySelectorAll(".jdropdown-item");if(i.length){for(var l=0;l<i.length;l++)if(i[l].indexValue>n&&(a=r.items[i[l].indexValue])&&(o=a.element.innerText[0])&&e==(o=o.toLowerCase())){t=i[l].indexValue;break}r.setCursor(t)}}}else void 0==r.currentIndex||null==r.currentIndex?r.first():((n=(e=r.items[r.currentIndex].element).nextElementSibling)?(n.classList.contains("jdropdown-group")&&(n=n.lastChild.firstChild),t=n.indexValue):e.parentNode.classList.contains("jdropdown-group-items")&&((n=e.parentNode.parentNode.nextElementSibling)&&(n.classList.contains("jdropdown-group")?n=n.lastChild.firstChild:n.classList.contains("jdropdown-item")?t=n.indexValue:n=null),n&&(t=n.indexValue)),null!==t&&r.setCursor(t))},r.prev=function(){var e=null;if(null===r.currentIndex)r.first();else{var t=r.items[r.currentIndex].element,n=t.previousElementSibling;n?(n.classList.contains("jdropdown-group")&&(n=n.lastChild.lastChild),e=n.indexValue):t.parentNode.classList.contains("jdropdown-group-items")&&((n=t.parentNode.parentNode.previousElementSibling)&&(n.classList.contains("jdropdown-group")?n=n.lastChild.lastChild:n.classList.contains("jdropdown-item")?e=n.indexValue:n=null),n&&(e=n.indexValue))}null!==e&&r.setCursor(e)},r.loadFirst=function(){var e=r.results?r.results:r.items,t=e.length||0;1==r.options.lazyLoading&&200<t&&(t=200),f.innerHTML="";for(var n=0;n<t;n++)e[n].group?(e[n].group.parentNode||f.appendChild(e[n].group),e[n].group.lastChild.appendChild(e[n].element)):f.appendChild(e[n].element);f.scrollTop=0},r.loadLast=function(){var e=r.results?r.results:r.items,t=e.length;if(200<t){for(f.innerHTML="",t-=200;t<e.length;t++)e[t].group?(e[t].group.parentNode||f.appendChild(e[t].group),e[t].group.lastChild.appendChild(e[t].element)):f.appendChild(e[t].element);f.scrollTop=f.scrollHeight}},r.loadUp=function(){var e=!1,t=r.results?r.results:r.items,n=f.querySelectorAll(".jdropdown-item")[0].indexValue;if(n=r.items[n],0<(n=t.indexOf(n)-1)){for(e=0;0<n&&t[n]&&200>e;)t[n].group?(t[n].group.parentNode||f.insertBefore(t[n].group,f.firstChild),t[n].group.lastChild.insertBefore(t[n].element,t[n].group.lastChild.firstChild)):f.insertBefore(t[n].element,f.firstChild),n--,e++;e=!0}return e},r.loadDown=function(){var e=!1,t=r.results?r.results:r.items,n=f.querySelectorAll(".jdropdown-item");if(n=n[n.length-1].indexValue,n=r.items[n],(n=t.indexOf(n)+1)<t.length){for(e=0;n<t.length&&t[n]&&200>e;)t[n].group?(t[n].group.parentNode||f.appendChild(t[n].group),t[n].group.lastChild.appendChild(t[n].element)):f.appendChild(t[n].element),n++,e++;e=!0}return e},function(){if(n||(n={}),"SELECT"==t.tagName){var a=e.dropdown.extractFromDom(t,n);t=a.el,n=a.options}!n.placeholder&&t.getAttribute("placeholder")&&(n.placeholder=t.getAttribute("placeholder")),r.value={},r.items=[],r.groups=[],r.search="",r.results=null,t.classList.add("jdropdown"),(d=document.createElement("div")).className="jdropdown-container-header",r.header=document.createElement("input"),r.header.className="jdropdown-header",r.header.type="text",r.header.setAttribute("autocomplete","off"),r.header.onfocus=function(){"function"==typeof r.options.onfocus&&r.options.onfocus(t)},r.header.onblur=function(){"function"==typeof r.options.onblur&&r.options.onblur(t)},r.header.onkeyup=function(e){1!=r.options.autocomplete||v?r.options.autocomplete||r.next(e.key):(r.search!=r.header.value.trim()&&(v=setTimeout((function(){r.find(r.header.value.trim()),v=null}),400)),t.classList.contains("jdropdown-focus")||r.open())},e.dropdown.hasEvents||(e.dropdown.hasEvents=!0,document.addEventListener("keydown",e.dropdown.keydown)),(p=document.createElement("div")).className="jdropdown-container",(f=document.createElement("div")).className="jdropdown-content",(h=document.createElement("div")).className="jdropdown-close",h.innerHTML="Done",(m=document.createElement("div")).className="jdropdown-reset",m.innerHTML="x",m.onclick=function(){r.reset(),r.close()},(g=document.createElement("div")).className="jdropdown-backdrop",d.appendChild(r.header),p.appendChild(f),t.appendChild(d),t.appendChild(p),t.appendChild(g),r.setOptions(n),!0==="ontouchsend"in document.documentElement?t.addEventListener("touchsend",e.dropdown.mouseup):t.addEventListener("mouseup",e.dropdown.mouseup),1==r.options.lazyLoading&&e.lazyLoading(f,{loadUp:r.loadUp,loadDown:r.loadDown}),t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue(!!r.options.multiple);r.setValue(e)},t.dropdown=r}(),r},e.dropdown.keydown=function(t){var n;if(n=e.dropdown.current)if(13==t.which||9==t.which)n.header.value&&null==n.currentIndex&&n.options.newOptions?n.add():(null==n.currentIndex&&1==n.options.autocomplete&&""!=n.header.value&&n.find(n.header.value),n.selectIndex(n.currentIndex));else if(38==t.which)null==n.currentIndex?n.first():0<n.currentIndex&&n.prev(),t.preventDefault();else if(40==t.which)null==n.currentIndex?n.first():n.currentIndex+1<n.items.length&&n.next(),t.preventDefault();else if(36==t.which)n.first(),t.target.classList.contains("jdropdown-header")||t.preventDefault();else if(35==t.which)n.last(),t.target.classList.contains("jdropdown-header")||t.preventDefault();else if(27==t.which)n.close();else if(33==t.which){if(null==n.currentIndex)n.first();else if(0<n.currentIndex)for(var r=0;7>r;r++)n.prev();t.preventDefault()}else if(34==t.which){if(null==n.currentIndex)n.first();else if(n.currentIndex+1<n.items.length)for(r=0;7>r;r++)n.next();t.preventDefault()}},e.dropdown.mouseup=function(t){var n=e.findElement(t.target,"jdropdown");if(n){var r=n.dropdown;if(t.target.classList.contains("jdropdown-header"))n.classList.contains("jdropdown-focus")&&n.classList.contains("jdropdown-default")?30>(n=n.getBoundingClientRect()).width-((t.changedTouches&&t.changedTouches[0]?t.changedTouches[0].clientX:t.clientX)-n.left)?t.target.classList.contains("jdropdown-add")?r.add():r.close():0==r.options.autocomplete&&r.close():r.open();else if(t.target.classList.contains("jdropdown-group-name")){if(n=t.target.nextSibling.children,"none"!=t.target.nextSibling.style.display)for(t=0;t<n.length;t++)"none"!=n[t].style.display&&r.selectItem(n[t])}else t.target.classList.contains("jdropdown-group-arrow")?t.target.classList.contains("jdropdown-group-arrow-down")?(t.target.classList.remove("jdropdown-group-arrow-down"),t.target.classList.add("jdropdown-group-arrow-up"),t.target.parentNode.nextSibling.style.display="none"):(t.target.classList.remove("jdropdown-group-arrow-up"),t.target.classList.add("jdropdown-group-arrow-down"),t.target.parentNode.nextSibling.style.display=""):t.target.classList.contains("jdropdown-item")?r.selectItem(t.target):t.target.classList.contains("jdropdown-image")||t.target.classList.contains("jdropdown-description")?r.selectItem(t.target.parentNode):t.target.classList.contains("jdropdown-title")?r.selectItem(t.target.parentNode.parentNode):(t.target.classList.contains("jdropdown-close")||t.target.classList.contains("jdropdown-backdrop"))&&r.close()}},e.dropdown.extractFromDom=function(e,t){if(t||(t={}),!e.getAttribute("multiple")||t&&void 0!=t.multiple||(t.multiple=!0),!e.getAttribute("placeholder")||t&&void 0!=t.placeholder||(t.placeholder=e.getAttribute("placeholder")),!e.getAttribute("data-autocomplete")||t&&void 0!=t.autocomplete||(t.autocomplete=!0),t&&void 0!=t.width||(t.width=e.offsetWidth),!e.value||t&&void 0!=t.value||(t.value=e.value),!t||void 0==t.data){t.data=[];for(var n=0;n<e.children.length;n++)if("OPTGROUP"==e.children[n].tagName)for(var r=0;r<e.children[n].children.length;r++)t.data.push({value:e.children[n].children[r].value,text:e.children[n].children[r].innerHTML,group:e.children[n].getAttribute("label")});else t.data.push({value:e.children[n].value,text:e.children[n].innerHTML})}return t&&void 0!=t.onchange||(t.onchange=function(n,r,a,o){1==t.multiple?obj.items[r].classList.contains("jdropdown-selected")?e.options[r].setAttribute("selected","selected"):e.options[r].removeAttribute("selected"):e.value=o}),n=document.createElement("div"),e.parentNode.insertBefore(n,e),e.style.display="none",{el:n,options:t}},e.editor=function(t,n){var r,a={options:{}},o={value:null,snippet:null,toolbar:null,remoteParser:null,placeholder:null,parseURL:!1,filterPaste:!0,dropZone:!1,dropAsSnippet:!1,acceptImages:!1,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,border:!0,padding:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null};for(r in o)n&&n.hasOwnProperty(r)?a.options[r]=n[r]:a.options[r]=o[r];var i=null,l=null,s=[];t.innerHTML="",a.el=t,"function"==typeof a.options.onclick&&(t.onclick=function(e){a.options.onclick(t,a,e)}),t.classList.add("jeditor-container"),1==a.options.padding&&t.classList.add("jeditor-padding"),0==a.options.border&&(t.style.border="0px");var u=document.createElement("div");u.className="jsnippet",u.setAttribute("contenteditable",!1);var c=document.createElement("div");c.className="jeditor-toolbar";var d=document.createElement("div");d.setAttribute("contenteditable",!0),d.setAttribute("spellcheck",!1),d.className="jeditor",a.options.placeholder&&d.setAttribute("data-placeholder",a.options.placeholder),(a.options.maxHeight||a.options.height)&&(d.style.overflowY="auto",a.options.maxHeight&&(d.style.maxHeight=a.options.maxHeight),a.options.height&&(d.style.height=a.options.height)),(o=a.options.value?a.options.value:t.innerHTML?t.innerHTML:"")||(o="");var p=function(e){"function"==typeof a.options.onchange&&a.options.onchange(t,a,e),a.options.value=a.getData(),t.value!=a.options.value&&(t.value=a.options.value,"function"==typeof t.onchange)&&t.onchange({type:"change",target:t,value:t.value})},f=function(e){if(window.getSelection){var t=window.getSelection();if(t.rangeCount){var n=t.getRangeAt(0);n.deleteContents(),n.insertNode(e),n.setStartAfter(e),n.setEndAfter(e),t.removeAllRanges(),t.addRange(n)}}},h=function(){var e;if(e=u.children[0]){e.classList.contains("jslider-grid")||e.classList.add("jslider-grid");var t=e.children.length;e.setAttribute("data-number",4<t?4:t),4<t?e.setAttribute("data-total",t-4):e.removeAttribute("data-total")}},m=function(e){u.innerHTML="";for(var t=["image","title","description","host","url"],n=0;n<t.length;n++){var r=document.createElement("div");if(r.className="jsnippet-"+t[n],r.setAttribute("data-k",t[n]),u.appendChild(r),e[t[n]])if("image"==t[n]){Array.isArray(e.image)||(e.image=[e.image]);for(var a=0;a<e.image.length;a++){var o=document.createElement("img");o.src=e.image[a],r.appendChild(o)}}else r.innerHTML=e[t[n]]}d.appendChild(document.createElement("br")),d.appendChild(u)},g=function(){clearTimeout(i),i=setTimeout((function(){if(!d.querySelector(".jsnippet")){var t=d.innerHTML.replace(/\n/g," "),n=document.createElement("div");n.innerHTML=t,(t=e.editor.detectUrl(n.innerText))&&("jpg"==t[0].substr(-3)||"png"==t[0].substr(-3)||"gif"==t[0].substr(-3)?a.addImage(t[0],!0):(n=e.editor.youtubeParser(t[0]),a.parseWebsite(t[0],n)))}}),1e3)};a.parseContent=function(){g()},a.parseWebsite=function(t,n){if(a.options.remoteParser){n&&(t="https://www.youtube.com/watch?v="+n);var r={title:"",description:"",image:"",host:t.split("/")[2],url:t};e.ajax({url:a.options.remoteParser+encodeURI(t.trim()),method:"GET",dataType:"json",success:function(e){e.title&&(r.title=e.title),e.description&&(r.description=e.description),e.host&&(r.host=e.host),e.url&&(r.url=e.url),m(r),e.image?a.addImage(e.image,!0):e["og:image"]&&a.addImage(e["og:image"],!0)}})}else console.log("The remoteParser is not defined")},a.setData=function(t){d.innerHTML=t,a.options.focus&&e.editor.setCursor(d,!0),s=[]},a.getFiles=function(){for(var e=d.querySelectorAll(".jfile"),t=[],n=0;n<e.length;n++)s[e[n].src]&&t.push(s[e[n].src]);return t},a.getText=function(){return d.innerText},a.getData=function(e){if(e){if(e={content:""},u.innerHTML){e.snippet={};for(var t=0;t<u.children.length;t++){var n=u.children[t].getAttribute("data-k");if(n)if("image"==n)for(e.snippet.image||(e.snippet.image=[]),n=0;n<u.children[t].children.length;n++)e.snippet.image.push(u.children[t].children[n].getAttribute("src"));else e.snippet[n]=u.children[t].innerHTML}}if((n=Object.keys(s)).length)for(e.files=[],t=0;t<n.length;t++)e.files.push(s[n[t]]);t=(t=(t=(t=d.innerHTML).replace(/<br>/g,"\n")).replace(/<\/div>/g,"</div>\n")).replace(/<(?:.|\n)*?>/gm,""),e.content=t.trim()}else e=d.innerHTML;return e},a.reset=function(){d.innerHTML="",u.innerHTML="",s=[]},a.addPdf=function(e){if("data"!=e.result.substr(0,4))console.error("Invalid source");else{var t=document.createElement("canvas");t.width=60,t.height=60;var n=new Image;t.getContext("2d").drawImage(n,0,0,t.width,t.height),t.toBlob((function(t){var n=document.createElement("img");n.src=window.URL.createObjectURL(t),n.title=e.name,n.className="jfile pdf",s[n.src]={file:n.src,extension:"pdf",content:e.result},f(n)}))}},a.addImage=function(e,t){if("data"==e.substr(0,4)||a.options.remoteParser){if("data"==e.substr(0,4)){var n=e.split(";");n=(n=n[0].split("/"))[1]}else n=e.substr(e.lastIndexOf(".")+1),e=a.options.remoteParser+e;var r=new Image;r.onload=function(){var e=document.createElement("canvas");e.width=r.width,e.height=r.height,e.getContext("2d").drawImage(r,0,0,e.width,e.height),e.toBlob((function(r){var o=document.createElement("img");o.src=window.URL.createObjectURL(r),o.classList.add("jfile"),o.setAttribute("tabindex","900"),s[o.src]={file:o.src,extension:n,content:e.toDataURL()},a.options.dropAsSnippet||t?(u.innerHTML||m({}),u.children[0].appendChild(o),h(),s[o.src].snippet=!0):f(o),p()}))},r.src=e}else console.error("remoteParser not defined in your initialization")},a.addFile=function(e){for(var t=[],n=0;n<e.length;n++)if(e[n].size>a.options.maxFileSize)alert("The file is too big");else{var r=e[n].type.split("/");(r="image"==r[0]?1:"pdf"==r[1]?2:0)?(t[n]=new FileReader,t[n].index=n,t[n].type=r,t[n].name=e[n].name,t[n].date=e[n].lastModified,t[n].size=e[n].size,t[n].addEventListener("load",(function(e){2==e.target.type?1==a.options.acceptFiles&&a.addPdf(e.target):a.addImage(e.target.result)}),!1),t[n].readAsDataURL(e[n])):alert("The extension is not allowed")}},a.destroy=function(){d.removeEventListener("mouseup",v),d.removeEventListener("mousedown",y),d.removeEventListener("mousemove",b),d.removeEventListener("keyup",w),d.removeEventListener("keydown",C),d.removeEventListener("dragstart",I),d.removeEventListener("dragenter",M),d.removeEventListener("dragover",k),d.removeEventListener("drop",S),d.removeEventListener("paste",L),"function"==typeof a.options.onblur&&d.removeEventListener("blur",_),"function"==typeof a.options.onfocus&&d.removeEventListener("focus",T),t.editor=null,t.classList.remove("jeditor-container"),c.remove(),u.remove(),d.remove()};var v=function(e){l&&l.e&&l.e.classList.remove("resizing"),l=!1},y=function(e){var t=function(t){var n=t.getBoundingClientRect();40>n.width-(e.clientX-n.left)&&40>e.clientY-n.top&&(t.innerHTML="",t.remove())};if("IMG"==e.target.tagName)if(e.target.style.cursor){if(t=e.target.getBoundingClientRect(),l={e:e.target,x:e.clientX,y:e.clientY,w:t.width,h:t.height,d:e.target.style.cursor},e.target.width||(e.target.width=t.width+"px"),e.target.height||(e.target.height=t.height+"px"),(t=window.getSelection()).rangeCount)for(var n=0;n<t.rangeCount;n++)t.removeRange(t.getRangeAt(n));e.target.classList.add("resizing")}else l=!0;else e.target.classList.contains("jsnippet")?t(e.target):e.target.parentNode.classList.contains("jsnippet")&&t(e.target.parentNode),l=!0},b=function(e){if("IMG"==e.target.tagName&&!e.target.parentNode.classList.contains("jsnippet-image")&&1==a.options.allowImageResize&&e.target.getAttribute("tabindex")){var t=e.target.getBoundingClientRect();e.target.style.cursor=5>e.clientY-t.top?5>t.width-(e.clientX-t.left)?"ne-resize":5>e.clientX-t.left?"nw-resize":"n-resize":5>t.height-(e.clientY-t.top)?5>t.width-(e.clientX-t.left)?"se-resize":5>e.clientX-t.left?"sw-resize":"s-resize":5>t.width-(e.clientX-t.left)?"e-resize":5>e.clientX-t.left?"w-resize":""}if(1==e.which&&l&&l.d){if("e-resize"==l.d||"ne-resize"==l.d||"se-resize"==l.d)if(l.e.width=l.w+(e.clientX-l.x),e.shiftKey){var n=l.h/l.w*(e.clientX-l.x);l.e.height=l.h+n}else n=null;n||"s-resize"!=l.d&&"se-resize"!=l.d&&"sw-resize"!=l.d||e.shiftKey||(l.e.height=l.h+(e.clientY-l.y))}},w=function(e){d.innerHTML||(d.innerHTML="<div><br></div>"),"function"==typeof a.options.onkeyup&&a.options.onkeyup(t,a,e)},C=function(e){1==a.options.parseURL&&g(),"function"==typeof a.options.onkeydown&&a.options.onkeydown(t,a,e),"Delete"==e.key&&"IMG"==e.target.tagName&&e.target.parentNode.classList.contains("jsnippet-image")&&(e.target.remove(),h())},E=[HTMLUnknownElement],x="color font-weight font-size background background-color margin".split(" "),A=function e(t){if(t.attributes&&t.attributes.length){var n=null,r=t.getAttribute("style");if(r){n=[],r=r.split(";");for(var o=0;o<r.length;o++){var i=r[o].trim().split(":");if(0<=x.indexOf(i[0].trim())){var l=i.shift();i=i.join(":"),n.push(l+":"+i)}}}if("IMG"==t.tagName)a.options.acceptImages?(t.setAttribute("tabindex","900"),a.addImage(t.src)):t.remove();else for(r=t.attributes.length-1;0<=r;r--)t.removeAttribute(t.attributes[r].name);t.style="",n&&n.length&&t.setAttribute("style",n.join(";"))}if(t.children.length)for(r=0;r<t.children.length;r++)e(t.children[r]);0<=E.indexOf(t.constructor)&&t.remove()},N=function(e){e&&(e=e.replace(RegExp("\x3c!--(.*?)--\x3e","gsi"),""));var t=document.createElement("span");return t.innerHTML=e,A(t),t},L=function(e){if(1==a.options.filterPaste){if(e.clipboardData||e.originalEvent.clipboardData)var t=(e.originalEvent||e).clipboardData.getData("text/html"),n=(e.originalEvent||e).clipboardData.getData("text/plain"),r=(e.originalEvent||e).clipboardData.files;else window.clipboardData&&(t=window.clipboardData.getData("Html"),n=window.clipboardData.getData("Text"),r=window.clipboardData.files);r.length?a.addFile(r):t?(t=N(t),f(t)):(t=n.split("\r\n"),e.target.innerText?(t=t.map((function(e){return"<div>"+e+"</div>"})),document.execCommand("insertHtml",!1,t.join(""))):t.map((function(e){var t=document.createElement("div");t.innerText=e,d.appendChild(t)}))),e.preventDefault()}},I=function(e){l&&l.e&&e.preventDefault()},M=function(e){l||0==a.options.dropZone||(t.classList.add("jeditor-dragging"),e.preventDefault())},k=function(e){l||0==a.options.dropZone||(i&&clearTimeout(i),i=setTimeout((function(){t.classList.remove("jeditor-dragging")}),100),e.preventDefault())},S=function(e){if(!l&&0!=a.options.dropZone){var n=null;document.caretRangeFromPoint?n=document.caretRangeFromPoint(e.clientX,e.clientY):e.rangeParent&&(n=document.createRange()).setStart(e.rangeParent,e.rangeOffset);var r=window.getSelection();r.removeAllRanges(),r.addRange(n),r.anchorNode.parentNode.focus(),n=(e.originalEvent||e).dataTransfer.getData("text/html"),r=(e.originalEvent||e).dataTransfer.getData("text/plain");var o=(e.originalEvent||e).dataTransfer.files;if(o.length)a.addFile(o);else if(r&&((r=document.createElement("div")).innerHTML=n,(n=r.querySelectorAll("img")).length))for(r=0;r<n.length;r++)a.addImage(n[r].src);t.classList.remove("jeditor-dragging"),e.preventDefault()}},_=function(e){"function"==typeof a.options.onblur&&a.options.onblur(t,a,e),p(e)},T=function(e){"function"==typeof a.options.onfocus&&a.options.onfocus(t,a,e)};return d.addEventListener("mouseup",v),d.addEventListener("mousedown",y),d.addEventListener("mousemove",b),d.addEventListener("keyup",w),d.addEventListener("keydown",C),d.addEventListener("dragstart",I),d.addEventListener("dragenter",M),d.addEventListener("dragover",k),d.addEventListener("drop",S),d.addEventListener("paste",L),d.addEventListener("focus",T),d.addEventListener("blur",_),"function"==typeof a.options.onload&&a.options.onload(t,a,d),d.innerHTML=o,t.appendChild(d),a.options.snippet&&m(a.options.snippet),null==a.options.toolbar&&(a.options.toolbar=e.editor.getDefaultToolbar()),a.options.toolbar&&(t.appendChild(c),e.toolbar(c,{container:!0,responsive:!0,items:a.options.toolbar})),a.options.focus&&e.editor.setCursor(d,"initial"==a.options.focus),t.change=a.setData,t.val=function(e){if(void 0===e)return e="true"!==t.getAttribute("data-html"),a.getData(e);a.setData(e)},t.editor=a},e.editor.setCursor=function(e,t){e.focus(),document.execCommand("selectAll");var n=window.getSelection(),r=n.getRangeAt(0);if(1==t)var a=r.startContainer,o=0;else o=(a=r.endContainer).length;r.setStart(a,o),r.setEnd(a,o),n.removeAllRanges(),n.addRange(r)},e.editor.getDomain=function(e){return e.replace("http://","").replace("https://","").replace("www.","").split(/[/?#]/)[0].split(/:/g)[0]},e.editor.detectUrl=function(e){return(e=e.match(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi))&&"www"==e[0].substr(0,3)&&(e[0]="http://"+e[0]),e},e.editor.youtubeParser=function(e){return!(!(e=e.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&\?]*).*/))||11!=e[7].length)&&e[7]},e.editor.getDefaultToolbar=function(){return[{content:"undo",onclick:function(){document.execCommand("undo")}},{content:"redo",onclick:function(){document.execCommand("redo")}},{type:"divisor"},{content:"format_bold",onclick:function(e,t,n){document.execCommand("bold"),document.queryCommandState("bold")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_italic",onclick:function(e,t,n){document.execCommand("italic"),document.queryCommandState("italic")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_underline",onclick:function(e,t,n){document.execCommand("underline"),document.queryCommandState("underline")?n.classList.add("selected"):n.classList.remove("selected")}},{type:"divisor"},{content:"format_list_bulleted",onclick:function(e,t,n){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_list_numbered",onclick:function(e,t,n){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_indent_increase",onclick:function(e,t,n){document.execCommand("indent",!0,null),document.queryCommandState("indent")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}]},e.form=function(t,n){var r,a={options:{}},o={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(t,n){e.alert(n)}};for(r in o)n&&n.hasOwnProperty(r)?a.options[r]=n[r]:a.options[r]=o[r];return a.options.validations||(a.options.validations={}),a.options.submitButton||(a.options.submitButton=t.querySelector("input[type=submit]")),a.options.submitButton&&a.options.url&&(a.options.submitButton.onclick=function(){a.save()}),a.options.validations.email||(a.options.validations.email=e.validations.email),a.options.validations.length||(a.options.validations.length=e.validations.length),a.options.validations.required||(a.options.validations.required=e.validations.required),a.setUrl=function(e){a.options.url=e},a.load=function(){e.ajax({url:a.options.url,method:"GET",dataType:"json",queue:!0,success:function(n){if("function"==typeof a.options.onbeforeload){var r=a.options.onbeforeload(t,n);r&&(n=r)}e.form.setElements(t,n),"function"==typeof a.options.onload&&a.options.onload(t,n)}})},a.save=function(){var n=a.validate();if(n)a.options.onerror(t,n);else{var r=e.form.getElements(t,!0);if("function"==typeof a.options.onbeforesave&&!1===(r=a.options.onbeforesave(t,r)))return;e.ajax({url:a.options.url,method:"POST",dataType:"json",data:r,success:function(e){"function"==typeof a.options.onsave&&a.options.onsave(t,r,e)}})}},a.remove=function(){if("function"==typeof a.options.onbeforeremove&&!1===a.options.onbeforeremove(t,a))return!1;e.ajax({url:a.options.url,method:"DELETE",dataType:"json",success:function(e){"function"==typeof a.options.onremove&&a.options.onremove(t,a,e),a.reset()}})},a.validateElement=function(n){var r=!1,o=e.form.getValue(n),i=n.getAttribute("data-validation");if("function"!=typeof a.options.validations[i]||a.options.validations[i](o,n)){if(n.classList.contains("error")){for(o=!1,n.classList.remove("error"),n.removeAttribute("title"),n=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<n.length;i++)n[i].getAttribute("data-validation")&&n[i].classList.contains("error")&&(o=!0);a.options.submitButton&&(o?a.options.submitButton.setAttribute("disabled",!0):a.options.submitButton.removeAttribute("disabled"))}}else n.classList.add("error"),a.options.submitButton&&a.options.submitButton.setAttribute("disabled",!0),r=n.getAttribute("data-error")||"There is an error in the form",n.setAttribute("title",r);return r},a.reset=function(){for(var e=t.querySelectorAll("input, select, textarea, div[name]"),n=0;n<e.length;n++)e[n].getAttribute("name")&&("checkbox"==e[n].type||"radio"==e[n].type?e[n].checked=!1:"function"==typeof e[n].val?e[n].val(""):e[n].value="")},a.validate=function(){for(var e=[],n=t.querySelectorAll("input, select, textarea, div[name]"),r=0;r<n.length;r++)if(n[r].getAttribute("data-validation")){var o=a.validateElement(n[r]);o&&e.push(o)}return 0<e.length&&e.join("<br>")},a.getError=function(){return!!a.validation()},a.setHash=function(){return a.getHash(e.form.getElements(t))},a.getHash=function(e){var t,n=0;if(0!==e.length)for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},a.isChanged=function(){var e=a.setHash();return a.options.currentHash!=e},a.resetTracker=function(){a.options.currentHash=a.setHash(),a.options.ignore=!1},a.setIgnore=function(e){a.options.ignore=!!e},setTimeout((function(){a.options.currentHash=a.setHash()}),1e3),t.addEventListener("keyup",(function(e){e.target.getAttribute("data-validation")&&a.validateElement(e.target)})),e.form.hasEvents||(window.addEventListener("beforeunload",(function(e){if(a.isChanged()&&0==a.options.ignore){var t=a.options.message?a.options.message:"o/";if(t)return"undefined"==typeof e&&(e=window.event),e&&(e.returnValue=t),t}})),e.form.hasEvents=!0),t.form=a},e.form.getValue=function(e){var t=null;if("checkbox"==e.type)1==e.checked&&(t=e.value||!0);else if("radio"==e.type)1==e.checked&&(t=e.value);else if("select"==e.tagName&&1==e.multiple){t=[],e=e.querySelectorAll("options[selected]");for(var n=0;n<e.length;n++)t.push(e[n].value)}else t="function"==typeof e.val?e.val():e.value||"";return t},e.form.getElements=function(t,n){for(var r,a={},o=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<o.length;i++)(r=o[i].getAttribute("name"))&&(a[r]=e.form.getValue(o[i])||"");return 1==n?a:JSON.stringify(a)},e.form.setElements=function(t,n){for(var r,a,o=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<o.length;i++){var l=o[i].getAttribute("type");(r=o[i].getAttribute("name"))&&(a=null,(r=r.replace(new RegExp(/\[(.*?)\]/gi),".$1")).match(/\./)?"undefined"!==typeof(r=e.path.call(n,r)||"")&&(a=r):"undefined"!==typeof n[r]&&(a=n[r]),null!==a&&("checkbox"==l||"radio"==l?o[i].checked=!!a:"function"==typeof o[i].val?o[i].val(a):o[i].value=a))}},e.tracker=e.form,e.focus=function(e){if(e.innerText.length){var t=document.createRange(),n=window.getSelection(),r=e.childNodes[e.childNodes.length-1];t.setStart(r,r.length),t.collapse(!0),n.removeAllRanges(),n.addRange(t),e.scrollLeft=e.scrollWidth}},e.isNumeric=function(e){return!isNaN(e)&&null!==e&&""!==e},e.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},e.getNode=function(){var e=document.getSelection().anchorNode;return e?3==e.nodeType?e.parentNode:e:null},e.hash=function(e){var t,n=0;if(0!==e.length)for(t=0;t<e.length;t++){var r=e.charCodeAt(t);32<r&&(n=(n<<5)-n+r,n|=0)}return n},e.randomColor=function(t){var n=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");6>n.length&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]);var r,a=[];for(r=0;3>r;r++){var o=parseInt(n.substr(2*r,2),16);o=Math.round(Math.min(Math.max(0,o+-.25*o),255)).toString(16),a.push(("00"+o).substr(o.length))}return 1==t?"#"+e.two(a[0].toString(16))+e.two(a[1].toString(16))+e.two(a[2].toString(16)):a},e.getWindowWidth=function(){var e=window,t=document,n=t.documentElement;return t=t.getElementsByTagName("body")[0],e.innerWidth||n.clientWidth||t.clientWidth},e.getWindowHeight=function(){var e=window,t=document,n=t.documentElement;return t=t.getElementsByTagName("body")[0],e.innerHeight||n.clientHeight||t.clientHeight},e.getPosition=function(e){if(e.changedTouches&&e.changedTouches[0]){var t=e.changedTouches[0].pageX;e=e.changedTouches[0].pageY}else t=window.Event?e.pageX:e.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),e=window.Event?e.pageY:e.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[t,e]},e.click=function(e){if(e.click)e.click();else{var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(t)}},e.findElement=function(e,t){var n=!1;return function e(r){r&&!n&&("function"==typeof t?n=t(r):"string"==typeof t&&r.classList&&r.classList.contains(t)&&(n=r)),r.parentNode&&!n&&e(r.parentNode)}(e),n},e.two=function(e){return 1==(e=""+e).length&&(e="0"+e),e},e.sha512=function(e){function t(e,t){this.highOrder=e,this.lowOrder=t}function n(e,n){var r=(65535&e.lowOrder)+(65535&n.lowOrder),a=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(r>>>16),o=(65535&a)<<16|65535&r;return r=(65535&e.highOrder)+(65535&n.highOrder)+(a>>>16),new t((65535&(a=(e.highOrder>>>16)+(n.highOrder>>>16)+(r>>>16)))<<16|65535&r,o)}function r(e,n,r,a){var o=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&r.lowOrder)+(65535&a.lowOrder),i=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(r.lowOrder>>>16)+(a.lowOrder>>>16)+(o>>>16),l=(65535&i)<<16|65535&o;return o=(65535&e.highOrder)+(65535&n.highOrder)+(65535&r.highOrder)+(65535&a.highOrder)+(i>>>16),new t((65535&(i=(e.highOrder>>>16)+(n.highOrder>>>16)+(r.highOrder>>>16)+(a.highOrder>>>16)+(o>>>16)))<<16|65535&o,l)}function a(e,n,r,a,o){var i=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&r.lowOrder)+(65535&a.lowOrder)+(65535&o.lowOrder),l=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(r.lowOrder>>>16)+(a.lowOrder>>>16)+(o.lowOrder>>>16)+(i>>>16),s=(65535&l)<<16|65535&i;return i=(65535&e.highOrder)+(65535&n.highOrder)+(65535&r.highOrder)+(65535&a.highOrder)+(65535&o.highOrder)+(l>>>16),new t((65535&(l=(e.highOrder>>>16)+(n.highOrder>>>16)+(r.highOrder>>>16)+(a.highOrder>>>16)+(o.highOrder>>>16)+(i>>>16)))<<16|65535&i,s)}function o(e,n){return 32>=n?new t(e.highOrder>>>n|e.lowOrder<<32-n,e.lowOrder>>>n|e.highOrder<<32-n):new t(e.lowOrder>>>n|e.highOrder<<32-n,e.highOrder>>>n|e.lowOrder<<32-n)}function i(e){var n=o(e,28),r=o(e,34);return e=o(e,39),new t(n.highOrder^r.highOrder^e.highOrder,n.lowOrder^r.lowOrder^e.lowOrder)}function l(e){var n=o(e,14),r=o(e,18);return e=o(e,41),new t(n.highOrder^r.highOrder^e.highOrder,n.lowOrder^r.lowOrder^e.lowOrder)}function s(e){var n=o(e,1),r=o(e,8);return e=c(e,7),new t(n.highOrder^r.highOrder^e.highOrder,n.lowOrder^r.lowOrder^e.lowOrder)}function u(e){var n=o(e,19),r=o(e,61);return e=c(e,6),new t(n.highOrder^r.highOrder^e.highOrder,n.lowOrder^r.lowOrder^e.lowOrder)}function c(e,n){return 32>=n?new t(e.highOrder>>>n,e.lowOrder>>>n|e.highOrder<<32-n):new t(0,e.highOrder<<32-n)}var d,p=[new t(1779033703,4089235720),new t(3144134277,2227873595),new t(1013904242,4271175723),new t(2773480762,1595750129),new t(1359893119,2917565137),new t(2600822924,725511199),new t(528734635,4215389547),new t(1541459225,327033209)],f=[new t(1116352408,3609767458),new t(1899447441,602891725),new t(3049323471,3964484399),new t(3921009573,2173295548),new t(961987163,4081628472),new t(1508970993,3053834265),new t(2453635748,2937671579),new t(2870763221,3664609560),new t(3624381080,2734883394),new t(310598401,1164996542),new t(607225278,1323610764),new t(1426881987,3590304994),new t(1925078388,4068182383),new t(2162078206,991336113),new t(2614888103,633803317),new t(3248222580,3479774868),new t(3835390401,2666613458),new t(4022224774,944711139),new t(264347078,2341262773),new t(604807628,2007800933),new t(770255983,1495990901),new t(1249150122,1856431235),new t(1555081692,3175218132),new t(1996064986,2198950837),new t(2554220882,3999719339),new t(2821834349,766784016),new t(2952996808,2566594879),new t(3210313671,3203337956),new t(3336571891,1034457026),new t(3584528711,2466948901),new t(113926993,3758326383),new t(338241895,168717936),new t(666307205,1188179964),new t(773529912,1546045734),new t(1294757372,1522805485),new t(1396182291,2643833823),new t(1695183700,2343527390),new t(1986661051,1014477480),new t(2177026350,1206759142),new t(2456956037,344077627),new t(2730485921,1290863460),new t(2820302411,3158454273),new t(3259730800,3505952657),new t(3345764771,106217008),new t(3516065817,3606008344),new t(3600352804,1432725776),new t(4094571909,1467031594),new t(275423344,851169720),new t(430227734,3100823752),new t(506948616,1363258195),new t(659060556,3750685593),new t(883997877,3785050280),new t(958139571,3318307427),new t(1322822218,3812723403),new t(1537002063,2003034995),new t(1747873779,3602036899),new t(1955562222,1575990012),new t(2024104815,1125592928),new t(2227730452,2716904306),new t(2361852424,442776044),new t(2428436474,593698344),new t(2756734187,3733110249),new t(3204031479,2999351573),new t(3329325298,3815920427),new t(3391569614,3928383900),new t(3515267271,566280711),new t(3940187606,3454069534),new t(4118630271,4000239992),new t(116418474,1914138554),new t(174292421,2731055270),new t(289380356,3203993006),new t(460393269,320620315),new t(685471733,587496836),new t(852142971,1086792851),new t(1017036298,365543100),new t(1126000580,2618297676),new t(1288033470,3409855158),new t(1501505948,4234509866),new t(1607167915,987167468),new t(1816402316,1246189591)],h=Array(64),m=8*(e=unescape(encodeURIComponent(e))).length;for((e=function(e){for(var t=[],n=8*e.length,r=0;r<n;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<24-r%32;return t}(e))[m>>5]|=128<<24-m%32,e[31+(m+128>>10<<5)]=m,m=0;m<e.length;m+=32){var g=p[0],v=p[1],y=p[2],b=p[3],w=p[4],C=p[5],E=p[6],x=p[7];for(d=0;80>d;d++){h[d]=16>d?new t(e[2*d+m],e[2*d+m+1]):r(u(h[d-2]),h[d-7],s(h[d-15]),h[d-16]);var A=a(x,l(w),new t(w.highOrder&C.highOrder^~w.highOrder&E.highOrder,w.lowOrder&C.lowOrder^~w.lowOrder&E.lowOrder),f[d],h[d]),N=n(i(g),new t(g.highOrder&v.highOrder^g.highOrder&y.highOrder^v.highOrder&y.highOrder,g.lowOrder&v.lowOrder^g.lowOrder&y.lowOrder^v.lowOrder&y.lowOrder));x=E,E=C,C=w,w=n(b,A),b=y,y=v,v=g,g=n(A,N)}p[0]=n(g,p[0]),p[1]=n(v,p[1]),p[2]=n(y,p[2]),p[3]=n(b,p[3]),p[4]=n(w,p[4]),p[5]=n(C,p[5]),p[6]=n(E,p[6]),p[7]=n(x,p[7])}for(e=[],m=0;m<p.length;m++)e.push(p[m].highOrder),e.push(p[m].lowOrder);return function(e){for(var t,n="",r=4*e.length,a=0;a<r;a+=1)t=e[a>>2]>>8*(3-a%4),n+="0123456789abcdef".charAt(t>>4&15)+"0123456789abcdef".charAt(15&t);return n}(e)},e.login||(e.login={},e.login.sha512=e.sha512),e.image=e.upload=function(t,n){var r,a={options:{}},o={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null,text:{extensionNotAllowed:"The extension is not allowed"}};for(r in o)n&&n.hasOwnProperty(r)?a.options[r]=n[r]:a.options[r]=o[r];1==a.options.multiple&&t.setAttribute("data-multiple",!0),t.content=[],t.classList.add("jupload"),1==a.options.input&&t.classList.add("input"),a.add=function(n){if(0==a.options.multiple&&(t.content=[],t.innerText=""),"image"==a.options.type){var r=document.createElement("img");r.setAttribute("src",n.file),r.setAttribute("tabindex",-1),t.getAttribute("name")||(r.className="jfile",r.content=n),t.appendChild(r)}else{r=n.name?n.name:n.file;var o=document.createElement("div");o.innerText=r||a.options.type,o.classList.add("jupload-item"),o.setAttribute("tabindex",-1),t.appendChild(o)}n.content&&(n.file=e.guid()),t.content.push(n),"function"==typeof a.options.onchange&&a.options.onchange(t,n)},a.addFromFile=function(e){if(e.type.split("/")[0]==a.options.type){var t=new FileReader;t.addEventListener("load",(function(t){t={file:t.srcElement.result,extension:e.name.substr(e.name.lastIndexOf(".")+1),name:e.name,size:e.size,lastmodified:e.lastModified,content:t.srcElement.result},a.add(t)})),t.readAsDataURL(e)}else alert(a.options.text.extensionNotAllowed)},a.addFromUrl=function(t){if("data"==t.substr(0,4)||a.options.remoteParser)if("data"==t.substr(0,4)){var n=t.split(";");(n=n[0].split("/"))[0].replace("data:","")==a.options.type?a.add({file:t,name:"",extension:n[1],content:t}):alert(a.options.text.extensionNotAllowed)}else n=t.substr(t.lastIndexOf(".")+1),t=a.options.remoteParser+t,e.ajax({url:t,type:"GET",dataType:"blob",success:function(e){}});else console.error("remoteParser not defined in your initialization")},o=a.options.type+"/"+a.options.extension;var i=document.createElement("input");i.type="file",i.setAttribute("accept",o),i.onchange=function(){for(var e=0;e<this.files.length;e++)a.addFromFile(this.files[e])},1==a.options.multiple&&i.setAttribute("multiple",!0);var l=null;return t.addEventListener("click",(function(n){l=null,t.children.length&&n.target!==t?n.target.parentNode==t&&(l=n.target):e.click(i)})),t.addEventListener("dblclick",(function(t){e.click(i)})),t.addEventListener("dragenter",(function(e){t.style.border="1px dashed #000"})),t.addEventListener("dragleave",(function(e){t.style.border="1px solid #eee"})),t.addEventListener("dragstop",(function(e){t.style.border="1px solid #eee"})),t.addEventListener("dragover",(function(e){e.preventDefault()})),t.addEventListener("keydown",(function(e){l&&46==e.which&&0<=(e=Array.prototype.indexOf.call(t.children,l))&&(t.content.splice(e,1),l.remove(),l=null)})),t.addEventListener("drop",(function(e){e.preventDefault(),e.stopPropagation();var n=(e.originalEvent||e).dataTransfer.getData("text/html");if((e.originalEvent||e).dataTransfer.files.length)for(n=0;n<e.dataTransfer.files.length;n++)a.addFromFile(e.dataTransfer.files[n]);else if(n&&(0==a.options.multiple&&(t.innerText=""),(e=document.createElement("div")).innerHTML=n,(e=e.querySelectorAll("img")).length))for(n=0;n<e.length;n++)a.addFromUrl(e[n].src);return t.style.border="1px solid #eee",!1})),t.val=function(e){if(void 0===e)return t.content&&t.content.length?t.content:null;if(t.innerText="",t.content=[],e)if(Array.isArray(e))for(var n=0;n<e.length;n++)"string"==typeof e[n]?a.add({file:e[n]}):a.add(e[n]);else"string"==typeof e&&a.add({file:e})},t.upload=t.image=a},e.image.create=function(e){var t=document.createElement("img");return t.setAttribute("src",e.file),t.className="jfile",t.setAttribute("tabindex",-1),t.content=e,t},e.lazyLoading=function(e,t){t.loadUp&&"function"==typeof t.loadUp||(t.loadUp=function(){return!1}),t.loadDown&&"function"==typeof t.loadDown||(t.loadDown=function(){return!1}),t.timer||(t.timer=100);var n=null,r=function(r){if(null==n){r=!1;var a=e.scrollTop;e.scrollTop+2*e.clientHeight>=e.scrollHeight?t.loadDown()&&(a==e.scrollTop&&(e.scrollTop-=e.clientHeight),r=!0):e.scrollTop<=e.clientHeight&&t.loadUp()&&(a==e.scrollTop&&(e.scrollTop+=e.clientHeight),r=!0),n=setTimeout((function(){n=null}),t.timer),r&&"function"==typeof t.onupdate&&t.onupdate()}};return e.onscroll=function(e){r(e)},e.onwheel=function(e){r(e)},{}},e.loading=function(){var e={},t=null;return e.show=function(){t||((t=document.createElement("div")).className="jloading"),document.body.appendChild(t)},e.hide=function(){t&&t.parentNode&&document.body.removeChild(t)},e}(),e.mask=function(){var t,n={currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:"YYYY YYY YY MMMMM MMMM MMM MM DDDDD DDDD DDD DD DY DAY WD D Q HH24 HH12 HH \\[H\\] H AM/PM PM AM MI SS MS MONTH MON Y M".split(" "),general:["A","0","[0-9a-zA-Z$]+","."]},r=function(){if(-1!==this.mask.toLowerCase().indexOf("[h]")){var t=0;this.date[4]&&(t=parseFloat(this.date[4]/60)),t=parseInt(this.date[3])+t,t/=24}else this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]?(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),t=e.two(this.date[0])+"-"+e.two(this.date[1])+"-"+e.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(t+=" "+e.two(this.date[3])+":"+e.two(this.date[4])+":"+e.two(this.date[5]))):t=e.two(this.date[3])+":"+e.two(this.date[4])+":"+e.two(this.date[5]);return t},a=function(e){return null===e||""===e||void 0===e},o=function(e){return"currency"===e||"percentage"===e||"numeric"===e},i=function(e){if(e&&Number(e)==e)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var t=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=t[1]}return e||(e=this.mask),(t=(t=RegExp("0{1}(.{1})0+","ig")).exec(e))&&t[1]&&1==t[1].length?(this.options.decimal=t[1],t[1]):(t=RegExp("#,##","ig"),e.match(t)?this.options.decimal=".":this.options.decimal=",",null)},l=function(e,t){return""==e?"":(t||(t=i.call(this)),(e=(""+e).split(t))[0]=e[0].match(/[\-0-9]+/g,""),e[0]&&(e[0]=e[0].join("")),e[0]?(void 0!==e[1]&&(e[1]=e[1].match(/[0-9]+/g,""),e[1]=e[1]?e[1].join(""):""),e):"")},s=function(e){if(""==e)return"";var t=i.call(this),n=Object.create(this.options||{});if(n.minimumFractionDigits||(n.minimumFractionDigits=1),""==(e=l.call(this,e)))return"";if(e[0]){var r=parseFloat(e.join("."));"percent"==n.style&&(r/=100)}else r=null;return(r=(n=(n=new Intl.NumberFormat(this.locale,n).format(r)).split(t))[1].replace(/[0-9]*/g,""))&&(n[2]=r),n[1]=void 0!==e[1]?t+e[1]:"",n.join("")},u=function(e){return(e=l.call(this,e))?parseFloat(e.join(".")):null},c=function(e,t){if(void 0===e){if("DIV"==this.tagName){var n=0,r=window.getSelection();return r&&0!==r.rangeCount&&(n=r.getRangeAt(0),(r=n.cloneRange()).selectNodeContents(this),r.setEnd(n.endContainer,n.endOffset),n=r.toString().length),n}return this.selectionStart}if(n=d.call(this),t){r=null;for(var a=0;a<n.length;a++)(n[a].match(/[\-0-9]/g)||"."==n[a]||","==n[a])&&(r=a);null===r&&(r=n.indexOf(" ")),e>=r&&(e=r+1)}e>n.length&&(e=n.length),e&&("DIV"==this.tagName?(r=window.getSelection(),(n=document.createRange()).setStart(this.childNodes[0],e),r.removeAllRanges(),r.addRange(n)):this.selectionEnd=this.selectionStart=e)},d=function(e,t,n){if("DIV"==this.tagName){if(void 0===e)return this.innerText;this.innerText!==e&&(this.innerText=e,t&&c.call(this,t,n))}else{if(void 0===e)return this.value;this.value!==e&&(this.value=e,t&&c.call(this,t,n))}},p=e.calendar.weekdays,f=e.calendar.weekdaysShort,h=e.calendar.months,m=e.calendar.monthsShort,g={YEAR:function(e,t){var n=""+(new Date).getFullYear();"undefined"===typeof this.values[this.index]&&(this.values[this.index]=""),0<=parseInt(e)&&10>=parseInt(e)&&this.values[this.index].length<t&&(this.values[this.index]+=e),this.values[this.index].length==t&&(2==t?n=n.substr(0,2)+this.values[this.index]:3==t?n=n.substr(0,1)+this.values[this.index]:4==t&&(n=this.values[this.index]),this.date[0]=n,this.index++)},YYYY:function(e){g.YEAR.call(this,e,4)},YYY:function(e){g.YEAR.call(this,e,3)},YY:function(e){g.YEAR.call(this,e,2)},FIND:function(e,t){a(this.values[this.index])&&(this.values[this.index]="");for(var n=0,r=0,o=(this.values[this.index]+e).toLowerCase(),i=0;i<t.length;i++)0==t[i].toLowerCase().indexOf(o)&&(n=i,r++);if(1<r)this.values[this.index]+=e;else if(1==r)return this.values[this.index]=t[n],this.index++,n},MMM:function(e){void 0!==(e=g.FIND.call(this,e,m))&&(this.date[1]=e+1)},MMMM:function(e){void 0!==(e=g.FIND.call(this,e,h))&&(this.date[1]=e+1)},MMMMM:function(e){a(this.values[this.index])&&(this.values[this.index]=""),e=(this.values[this.index]+e).toLowerCase();for(var t=0;t<h.length;t++)if(0==h[t][0].toLowerCase().indexOf(e)){this.values[this.index]=h[t][0],this.date[1]=t+1,this.index++;break}},MM:function(e){a(this.values[this.index])?1<parseInt(e)&&10>parseInt(e)?(this.date[1]=this.values[this.index]="0"+e,this.index++):2>parseInt(e)&&(this.values[this.index]=e):(1==this.values[this.index]&&3>parseInt(e)||0==this.values[this.index]&&0<parseInt(e)&&10>parseInt(e))&&(this.date[1]=this.values[this.index]+=e,this.index++)},M:function(e){var t=!1;0<=parseInt(e)&&10>parseInt(e)?a(this.values[this.index])?(this.values[this.index]=e,1<e&&(this.date[1]=this.values[this.index],this.index++)):1==this.values[this.index]&&3>parseInt(e)||0==this.values[this.index]&&0<parseInt(e)?(this.date[1]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t&&0<(e=parseInt(this.values[this.index]))&&12>e&&(this.date[2]=this.values[this.index],this.index++,this.position--)},D:function(e){var t=!1;0<=parseInt(e)&&10>parseInt(e)?a(this.values[this.index])?(this.values[this.index]=e,3<parseInt(e)&&(this.date[2]=this.values[this.index],this.index++)):3==this.values[this.index]&&2>parseInt(e)||1==this.values[this.index]||2==this.values[this.index]||0==this.values[this.index]&&0<parseInt(e)?(this.date[2]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t&&0<(e=parseInt(this.values[this.index]))&&32>e&&(this.date[2]=this.values[this.index],this.index++,this.position--)},DD:function(e){a(this.values[this.index])?3<parseInt(e)&&10>parseInt(e)?(this.date[2]=this.values[this.index]="0"+e,this.index++):10>parseInt(e)&&(this.values[this.index]=e):(3==this.values[this.index]&&2>parseInt(e)||(1==this.values[this.index]||2==this.values[this.index])&&10>parseInt(e)||0==this.values[this.index]&&0<parseInt(e)&&10>parseInt(e))&&(this.date[2]=this.values[this.index]+=e,this.index++)},DDD:function(e){g.FIND.call(this,e,f)},DDDD:function(e){g.FIND.call(this,e,p)},HH12:function(e,t){a(this.values[this.index])?1<parseInt(e)&&10>parseInt(e)?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):10>parseInt(e)&&(this.values[this.index]=e):(1==this.values[this.index]&&3>parseInt(e)||1>this.values[this.index]&&10>parseInt(e))&&(this.date[3]=this.values[this.index]+=e,this.index++)},HH24:function(e,t){0<=parseInt(e)&&10>parseInt(e)&&(null==this.values[this.index]||""==this.values[this.index]?2<parseInt(e)&&10>parseInt(e)?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):10>parseInt(e)&&(this.values[this.index]=e):(2==this.values[this.index]&&4>parseInt(e)||2>this.values[this.index]&&10>parseInt(e))&&(this.date[3]=this.values[this.index]+=e,this.index++))},HH:function(e){g.HH24.call(this,e,1)},H:function(e){g.HH24.call(this,e,0)},"\\[H\\]":function(e){void 0==this.values[this.index]&&(this.values[this.index]=""),e.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=e:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(e,t){null==this.values[this.index]||""==this.values[this.index]?5<parseInt(e)&&10>parseInt(e)?(this.date[t]=this.values[this.index]="0"+e,this.index++):10>parseInt(e)&&(this.values[this.index]=e):10>parseInt(e)&&(this.date[t]=this.values[this.index]+=e,this.index++)},MI:function(e){g.N60.call(this,e,4)},SS:function(e){g.N60.call(this,e,5)},"AM/PM":function(e){this.values[this.index]="",e&&(this.values[this.index]=12<this.date[3]?"PM":"AM"),this.index++},WD:function(e){"undefined"===typeof this.values[this.index]&&(this.values[this.index]=""),0<=parseInt(e)&&7>parseInt(e)&&(this.values[this.index]=e),1==this.value[this.index].length&&this.index++},"0{1}(.{1}0+)?":function(e){var t=i.call(this),n=!1;a(this.values[this.index])?this.values[this.index]="":"-"==this.values[this.index]&&(n=!0);var r=l.call(this,this.values[this.index],t);r&&(this.values[this.index]=r.join(t)),0<=parseInt(e)&&10>parseInt(e)?"0"==this.values[this.index]&&e!=t||(this.values[this.index]+=e):this.values[this.index]&&e==t?t&&-1==this.values[this.index].indexOf(t)&&(this.values[this.index]+=e):"-"==e&&(n=!0),!0===n&&"-"!==this.values[this.index][0]&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(e){g["0{1}(.{1}0+)?"].call(this,e),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&-1==this.values[this.index].indexOf("%")&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(e){g["0{1}(.{1}0+)?"].call(this,e),e=i.call(this);var t=this.tokens[this.index].substr(1,1),n="-"===this.values[this.index][0],r=l.call(this,this.values[this.index],e);if(""!==r){var a=r[0].match(/[0-9]/g);if(a){for(var o=[],s=0,u=(a=a.join("")).length-1;0<=u;u--)o.push(a[u]),++s%3||o.push(t);o=o.reverse(),r[0]=o.join(""),r[0].substr(0,1)==t&&(r[0]=r[0].substr(1))}else r[0]="";this.values[this.index]=r.join(e),n&&(this.values[this.index]="-"+this.values[this.index])}},0:function(e){e.match(/[0-9]/g)&&(this.values[this.index]=e,this.index++)},"[0-9a-zA-Z$]+":function(e){a(this.values[this.index])&&(this.values[this.index]="");var t=this.tokens[this.index];t[this.values[this.index].length]==e?(this.values[this.index]+=e,this.values[this.index]==t&&this.index++):(this.values[this.index]=t,this.index++,e.match(/[\-0-9]/g)&&this.position--)},A:function(e){e.match(/[a-zA-Z]/gi)&&(this.values[this.index]=e,this.index++)},".":function(e){g["[0-9a-zA-Z$]+"].call(this,e)}},v=function(e){var t="general"==this.type?[].concat(n.general):[].concat(n.currency,n.datetime,n.percentage,n.numeric,n.general);return t=new RegExp(t.join("|"),"gi"),e.match(t)},y=function(e){for(var t=this.type?"general"==this.type?["general"]:"datetime"==this.type?["numeric","datetime","general"]:["currency","percentage","numeric","general"]:Object.keys(n),r=0;r<t.length;r++)for(var a=t[r],o=0;o<n[a].length;o++)if(e.match(new RegExp(n[a][o],"gi")))return{type:a,method:n[a][o]}},b=function(e){var t=y.call(this,e);if(t)var n=t.type;if(n){var r=0;e=v.call(this,e);for(var a=0;a<e.length;a++)(t=y.call(this,e[a]))&&o(t.type)&&r++;1<r&&(n="general")}return n};t=function(e){return"="==(""+e)[0]};var w=function(n,a,l){var p,f={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if("object"==typeof n){if(f.input=n.target,f.value=d.call(n.target),f.caret=c.call(n.target),(p=n.target.getAttribute("data-mask"))&&(f.mask=p),(p=n.target.getAttribute("data-type"))&&(f.type=p),n.target.mask?(n.target.mask.options&&(f.options=n.target.mask.options),n.target.mask.locale&&(f.locale=n.target.mask.locale)):(p=n.target.getAttribute("data-locale"))&&(f.locale=p,f.mask&&(f.options.style=f.mask)),n.target.attributes&&n.target.attributes.length)for(p=0;p<n.target.attributes.length;p++){var h=n.target.attributes[p].name;a=n.target.attributes[p].value,"data"==h.substr(0,4)&&(f.options[h.substr(5)]=a)}}else{if("string"==typeof a)f.mask=a;else for(h=Object.keys(a),p=0;p<h.length;p++)f[h[p]]=a[h[p]];"number"===typeof n&&(i.call(f,f.mask),n=(""+n).replace(".",f.options.decimal)),f.value=n,f.input&&(d.call(f.input,n),e.focus(f.input),f.caret=c.call(f.input))}if(!t(f.value)&&(f.mask||f.locale)){if(f.mask&&(f.mask=f.mask.replace("[-]",""),f.mask.indexOf("##")&&((p=f.mask.split(";"))[0]&&(p[0]=p[0].replace("*",""),p[0]=p[0].replace(/_/g,""),p[0]=p[0].replace(/-/g,""),p[0]=p[0].replace("(",""),p[0]=p[0].replace(")","")),f.mask=p[0]),f.type||(f.type=b.call(f,f.mask)),f.tokens=v.call(f,f.mask)),"object"!==typeof n||!n.inputType||"insertText"==n.inputType||"insertFromPaste"==n.inputType)if(f.locale)if(f.input)n=f.input,(h=d.call(n))&&(i.call(f),h=(p=s.call(f,h)).length-h.length,h=c.call(n)+h,d.call(n,p,h,!0));else var m=s.call(f,f.value);else{for(m=f.tokens,n=[],p=0;p<m.length;p++)(h=y.call(f,m[p]))?n.push(h.method):n.push(null);for(p=0;p<n.length;p++)"MM"==n[p]&&(n[p-1]&&0<=n[p-1].indexOf("H")||n[p-2]&&0<=n[p-2].indexOf("H")||n[p+1]&&0<=n[p+1].indexOf("S")||n[p+2]&&0<=n[p+2].indexOf("S"))&&(n[p]="MI");for(f.methods=n;f.position<f.value.length&&"undefined"!==typeof f.tokens[f.index];)"function"==typeof g[f.methods[f.index]]?(g[f.methods[f.index]].call(f,f.value[f.position]),f.position++):(f.values[f.index]=f.tokens[f.index],f.index++);if(o(f.type)){for(;"undefined"!==typeof f.tokens[f.index];)(p=y.call(f,f.tokens[f.index]))&&"general"==p.type&&(f.values[f.index]=f.tokens[f.index]),f.index++;n=!0}else n=!1;m=f.values.join(""),f.input&&(p=m.length-f.value.length,d.call(f.input,m,0<p?f.caret+p:f.caret,n))}if(f.input&&(n=null,o(f.type)?(f.number=u.call(f,d.call(f.input)),n="percentage"==f.type?f.number/100:f.number):"datetime"==f.type&&(n=r.call(f),f.date[0]&&f.date[1]&&f.date[2]&&f.input.setAttribute("data-completed",!0)),n&&f.input.setAttribute("data-value",n)),void 0!==m)return l?f:m}};return w.prepare=function(e,t){return t||(t={}),v.call(t,e)},w.apply=function(e){var t=d.call(e.target);1==e.key.length&&(t+=e.key),d.call(e.target,w(t,e.target.getAttribute("data-mask")))},w.run=function(e,t,n){return w(e,{mask:t,decimal:n})},w.extract=function(t,n,o){if(a(t))return t;if("object"!=typeof n)return s;n.options||(n.options={}),!n.mask&&n.format&&(n.mask=n.format),i.call(n,n.mask);var l=null;if("percent"==n.type||"percent"==n.options.style?l="percentage":n.mask&&(l=b.call(n,n.mask)),"datetime"===l){t instanceof Date&&e.calendar.getDateString(s,n.mask),t=w(t,n,!0);var s=r.call(t);t.date[0]&&t.date[1]&&t.date[2]&&!(t.date[3]||t.date[4]||t.date[5])&&(s=e.calendar.now(t.date),s=e.calendar.dateToNum(s))}else s=u.call(n,t),"percentage"==l&&(s/=100),t=n;return t.value=s,o?t:s},w.render=function(t,n,r){if(a(t)||"object"!=typeof n)return t;n.options||(n.options={}),!n.mask&&n.format&&(n.mask=n.format);var o=null;"percent"==n.type||"percent"==n.options.style?o="percentage":n.mask?o=b.call(n,n.mask):t instanceof Date&&(o="datetime");var l=!1;if("datetime"==o||"calendar"==n.type?((o=e.calendar.getDateString(t,n.mask))&&(t=o),n.mask&&r&&(l=!0)):("percentage"==o&&(t*=100),"number"===typeof t?(n.mask&&r?(r=n.mask.match(RegExp("0{1}(.{1})0+","ig")))&&r[0]?(r=r[0].length-2,o=t.toFixed(r)):o=""+t:n.locale&&r?((r=(""+t).split("."))[1]||(r[1]="00"),o=r.join(".")):o=function(e){return(""+ +e).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,(function(e,t,n,r,a){return 0>a?t+"0."+Array(1-a-n.length).join(0)+n+r:t+n+r+Array(a-r.length+1).join(0)}))}(t),null!==o&&(t=o,i.call(n,n.mask),n.options.decimal&&(t=t.replace(".",n.options.decimal)))):n.mask&&r&&(l=!0)),l&&0<(l=n.mask.length-t.length))for(r=0;r<l;r++)t+=" ";return w(t,n)},w.set=function(e,t){if(t){e.setAttribute("data-mask",t);var n=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(n)}},"undefined"!==typeof document&&document.addEventListener("input",(function(e){(e.target.getAttribute("data-mask")||e.target.mask)&&w(e)})),w}(),e.modal=function(t,n){var r,a={options:{}},o={url:null,onopen:null,onclose:null,closed:!1,width:null,height:null,title:null,padding:null};for(r in o)n&&n.hasOwnProperty(r)?a.options[r]=n[r]:a.options[r]=o[r];for(!a.options.title&&t.getAttribute("title")&&(a.options.title=t.getAttribute("title")),o=document.createElement("div");t.children[0];)o.appendChild(t.children[0]);for(a.content=document.createElement("div"),a.content.className="jmodal_content",a.content.innerHTML=t.innerHTML;o.children[0];)a.content.appendChild(o.children[0]);a.container=document.createElement("div"),a.container.className="jmodal",a.container.appendChild(a.content),a.options.padding&&(a.content.style.padding=a.options.padding),a.options.width&&(a.container.style.width=a.options.width),a.options.height&&(a.container.style.height=a.options.height),a.options.title?a.container.setAttribute("title",a.options.title):a.container.classList.add("no-title"),t.innerHTML="",t.style.display="none",t.appendChild(a.container);var i=document.createElement("div");return i.className="jmodal_backdrop",i.onclick=function(){a.close()},t.appendChild(i),a.open=function(){t.style.display="block";var n=a.container.getBoundingClientRect();e.getWindowWidth()<n.width?(a.container.style.top="",a.container.style.left="",a.container.classList.add("jmodal_fullscreen"),e.animation.slideBottom(a.container,1)):i.style.display="block",e.modal.current=a,"function"==typeof a.options.onopen&&a.options.onopen(t,a)},a.resetPosition=function(){a.container.style.top="",a.container.style.left=""},a.isOpen=function(){return"none"!=t.style.display},a.close=function(){t.style.display="none",i.style.display="",e.modal.current=null,a.container.classList.remove("jmodal_fullscreen"),"function"==typeof a.options.onclose&&a.options.onclose(t,a)},e.modal.hasEvents||(e.modal.current=a,!0==="ontouchstart"in document.documentElement?document.addEventListener("touchstart",e.modal.mouseDownControls):(document.addEventListener("mousedown",e.modal.mouseDownControls),document.addEventListener("mousemove",e.modal.mouseMoveControls),document.addEventListener("mouseup",e.modal.mouseUpControls)),document.addEventListener("keydown",e.modal.keyDownControls),e.modal.hasEvents=!0),a.options.url?e.ajax({url:a.options.url,method:"GET",dataType:"text/html",success:function(e){a.content.innerHTML=e,a.options.closed||a.open()}}):a.options.closed||a.open(),t.modal=a},e.modal.current=null,e.modal.position=null,e.modal.keyDownControls=function(t){27==t.which&&e.modal.current&&e.modal.current.close()},e.modal.mouseUpControls=function(t){e.modal.current&&(e.modal.current.container.style.cursor="auto"),e.modal.position=null},e.modal.mouseMoveControls=function(t){if(e.modal.current&&e.modal.position)if(1==t.which||3==t.which){var n=e.modal.position;e.modal.current.container.style.top=n[1]+(t.clientY-n[3])+n[5]/2+"px",e.modal.current.container.style.left=n[0]+(t.clientX-n[2])+n[4]/2+"px",e.modal.current.container.style.cursor="move"}else e.modal.current.container.style.cursor="auto"},e.modal.mouseDownControls=function(t){e.modal.position=[],t.target.classList.contains("jmodal")&&setTimeout((function(){var n=t.target.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var r=t.changedTouches[0].clientX,a=t.changedTouches[0].clientY;else r=t.clientX,a=t.clientY;50>n.width-(r-n.left)&&50>a-n.top?setTimeout((function(){e.modal.current.close()}),100):t.target.getAttribute("title")&&50>a-n.top&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),e.modal.position=[n.left,n.top,t.clientX,t.clientY,n.width,n.height])}),100)},e.notification=function(t){var n={options:{}},r={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(o in r)t&&t.hasOwnProperty(o)?n.options[o]=t[o]:n.options[o]=r[o];var a=document.createElement("div");a.className="jnotification",n.options.error&&a.classList.add("jnotification-error"),(t=document.createElement("div")).className="jnotification-container",a.appendChild(t),(r=document.createElement("div")).className="jnotification-header",t.appendChild(r);var o=document.createElement("div");if(o.className="jnotification-image",r.appendChild(o),n.options.icon){var i=document.createElement("img");i.src=n.options.icon,o.appendChild(i)}if((o=document.createElement("div")).className="jnotification-name",o.innerHTML=n.options.name,r.appendChild(o),1==n.options.closeable&&((o=document.createElement("div")).className="jnotification-close",o.onclick=function(){n.hide()},r.appendChild(o)),(o=document.createElement("div")).className="jnotification-date",r.appendChild(o),(r=document.createElement("div")).className="jnotification-content",t.appendChild(r),n.options.title&&((t=document.createElement("div")).className="jnotification-title",t.innerHTML=n.options.title,r.appendChild(t)),(t=document.createElement("div")).className="jnotification-message",t.innerHTML=n.options.message,r.appendChild(t),n.show=function(){document.body.appendChild(a),800<e.getWindowWidth()?e.animation.fadeIn(a):e.animation.slideTop(a,1)},n.hide=function(){800<e.getWindowWidth()?e.animation.fadeOut(a,(function(){a.parentNode&&(a.parentNode.removeChild(a),l&&clearTimeout(l))})):e.animation.slideTop(a,0,(function(){a.parentNode&&(a.parentNode.removeChild(a),l&&clearTimeout(l))}))},n.show(),1==n.options.autoHide)var l=setTimeout((function(){n.hide()}),n.options.timeout);return 800>e.getWindowWidth()&&a.addEventListener("swipeup",(function(e){n.hide(),e.preventDefault(),e.stopPropagation()})),n},e.notification.isVisible=function(){var e=document.querySelector(".jnotification");return!(!e||!e.parentNode)},e.palette=function(e){var t={material:["#ffebee #fce4ec #f3e5f5 #e8eaf6 #e3f2fd #e0f7fa #e0f2f1 #e8f5e9 #f1f8e9 #f9fbe7 #fffde7 #fff8e1 #fff3e0 #fbe9e7 #efebe9 #fafafa #eceff1".split(" "),"#ffcdd2 #f8bbd0 #e1bee7 #c5cae9 #bbdefb #b2ebf2 #b2dfdb #c8e6c9 #dcedc8 #f0f4c3 #fff9c4 #ffecb3 #ffe0b2 #ffccbc #d7ccc8 #f5f5f5 #cfd8dc".split(" "),"#ef9a9a #f48fb1 #ce93d8 #9fa8da #90caf9 #80deea #80cbc4 #a5d6a7 #c5e1a5 #e6ee9c #fff59d #ffe082 #ffcc80 #ffab91 #bcaaa4 #eeeeee #b0bec5".split(" "),"#e57373 #f06292 #ba68c8 #7986cb #64b5f6 #4dd0e1 #4db6ac #81c784 #aed581 #dce775 #fff176 #ffd54f #ffb74d #ff8a65 #a1887f #e0e0e0 #90a4ae".split(" "),"#ef5350 #ec407a #ab47bc #5c6bc0 #42a5f5 #26c6da #26a69a #66bb6a #9ccc65 #d4e157 #ffee58 #ffca28 #ffa726 #ff7043 #8d6e63 #bdbdbd #78909c".split(" "),"#f44336 #e91e63 #9c27b0 #3f51b5 #2196f3 #00bcd4 #009688 #4caf50 #8bc34a #cddc39 #ffeb3b #ffc107 #ff9800 #ff5722 #795548 #9e9e9e #607d8b".split(" "),"#e53935 #d81b60 #8e24aa #3949ab #1e88e5 #00acc1 #00897b #43a047 #7cb342 #c0ca33 #fdd835 #ffb300 #fb8c00 #f4511e #6d4c41 #757575 #546e7a".split(" "),"#d32f2f #c2185b #7b1fa2 #303f9f #1976d2 #0097a7 #00796b #388e3c #689f38 #afb42b #fbc02d #ffa000 #f57c00 #e64a19 #5d4037 #616161 #455a64".split(" "),"#c62828 #ad1457 #6a1b9a #283593 #1565c0 #00838f #00695c #2e7d32 #558b2f #9e9d24 #f9a825 #ff8f00 #ef6c00 #d84315 #4e342e #424242 #37474f".split(" "),"#b71c1c #880e4f #4a148c #1a237e #0d47a1 #006064 #004d40 #1b5e20 #33691e #827717 #f57f17 #ff6f00 #e65100 #bf360c #3e2723 #212121 #263238".split(" ")],fire:["0b1a6d 840f38 b60718 de030b ff0c0c fd491c fc7521 faa331 fbb535 ffc73a".split(" "),"071147 5f0b28 930513 be0309 ef0000 fa3403 fb670b f9991b faad1e ffc123".split(" "),"03071e 370617 6a040f 9d0208 d00000 dc2f02 e85d04 f48c06 faa307 ffba08".split(" "),"020619 320615 61040d 8c0207 bc0000 c82a02 d05203 db7f06 e19405 efab00".split(" "),"020515 2d0513 58040c 7f0206 aa0000 b62602 b94903 c57205 ca8504 d89b00".split(" ")],baby:["eddcd2 fff1e6 fde2e4 fad2e1 c5dedd dbe7e4 f0efeb d6e2e9 bcd4e6 99c1de".split(" "),"e1c4b3 ffd5b5 fab6ba f5a8c4 aacecd bfd5cf dbd9d0 baceda 9dc0db 7eb1d5".split(" "),"daa990 ffb787 f88e95 f282a9 8fc4c3 a3c8be cec9b3 9dbcce 82acd2 649dcb".split(" "),"d69070 ff9c5e f66770 f05f8f 74bbb9 87bfae c5b993 83aac3 699bca 4d89c2".split(" "),"c97d5d f58443 eb4d57 e54a7b 66a9a7 78ae9c b5a67e 7599b1 5c88b7 4978aa".split(" ")]};return t[e]?t[e]:t.material},e.picker=function(t,n){if(t.picker)return t.picker.setOptions(n,!0);var r={type:"picker",options:{}},a=null,o=null;return r.setOptions=function(e,t){var n={value:0,data:null,render:null,onchange:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,content:!1,columns:null,height:null};for(var i in e&&e.options&&(e.data=e.options),n)e&&e.hasOwnProperty(i)?r.options[i]=e[i]:"undefined"!=typeof r.options[i]&&!0!==t||(r.options[i]=n[i]);for(a.style.display=!1===r.options.header?"none":"",a.style.width=r.options.width?parseInt(r.options.width)+"px":"",r.options.height?(o.style.maxHeight=r.options.height+"px",o.style.overflow="scroll"):o.style.overflow="",0<r.options.columns&&(o.classList.add("jpicker-columns"),o.style.width=r.options.width?r.options.width:36*r.options.columns+"px"),isNaN(r.options.value)&&(r.options.value="0"),o.innerHTML="",n=Object.keys(r.options.data),i=0;i<n.length;i++){var l=document.createElement("div");l.classList.add("jpicker-item"),l.k=n[i],l.v=r.options.data[n[i]],l.innerHTML=r.getLabel(n[i]),o.appendChild(l)}return r.setValue(r.options.value),r},r.getValue=function(){return r.options.value},r.setValue=function(e){r.setLabel(e),r.options.value=String(e),t.value!=r.options.value&&(t.value=r.options.value,"function"==typeof t.onchange)&&t.onchange({type:"change",target:t,value:t.value}),"generic"!==o.children[e].getAttribute("type")&&r.close()},r.getLabel=function(e){return e=r.options.data[e]||null,"function"==typeof r.options.render&&(e=r.options.render(e)),e},r.setLabel=function(e){e=r.options.content?'<i class="material-icons">'+r.options.content+"</i>":r.getLabel(e),a.innerHTML=e},r.open=function(){if(!t.classList.contains("jpicker-focus")){e.tracking(r,!0),t.classList.add("jpicker-focus"),t.focus();var n=a.getBoundingClientRect(),i=o.getBoundingClientRect();o.style.marginTop=window.innerHeight<n.bottom+i.height?-1*(i.height+4)+"px":n.height+2+"px",!0===r.options.right&&(o.style.marginLeft=-1*i.width+24+"px"),"function"==typeof r.options.onopen&&r.options.onopen(t,r)}},r.close=function(){t.classList.contains("jpicker-focus")&&(t.classList.remove("jpicker-focus"),e.tracking(r,!1),"function"==typeof r.options.onclose)&&r.options.onclose(t,r)},t.classList.add("jpicker"),t.setAttribute("tabindex","900"),t.onmousedown=function(e){t.classList.contains("jpicker-focus")||r.open()},(a=document.createElement("div")).classList.add("jpicker-header"),(o=document.createElement("div")).classList.add("jpicker-content"),o.onclick=function(n){(n=e.findElement(n.target,"jpicker-item"))&&n.parentNode===o&&(r.setValue(n.k),"function"==typeof r.options.onchange&&r.options.onchange.call(r,t,r,n.v,n.v,n.k))},t.appendChild(a),t.appendChild(o),t.value=n.value||0,r.setOptions(n),"function"==typeof r.options.onload&&r.options.onload(t,r),t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},t.picker=r,r},e.progressbar=function(e,t){var n,r={options:{}},a={value:0,onchange:null,width:null};for(n in a)t&&t.hasOwnProperty(n)?r.options[n]=t[n]:r.options[n]=a[n];e.classList.add("jprogressbar"),e.setAttribute("tabindex",1),e.setAttribute("data-value",r.options.value);var o=document.createElement("div");return o.style.width=r.options.value+"%",o.style.color="#fff",e.appendChild(o),r.options.width&&(e.style.width=r.options.width),r.setValue=function(t){t=parseInt(t),r.options.value=t,o.style.width=t+"%",e.setAttribute("data-value",t+"%"),e.style.color=6>t?"#000":"#fff",r.options.value=t,"function"==typeof r.options.onchange&&r.options.onchange(e,t),e.value!=r.options.value&&(e.value=r.options.value,"function"==typeof e.onchange)&&e.onchange({type:"change",target:e,value:e.value})},r.getValue=function(){return r.options.value},a=function(t){if(t.which){var n=e.getBoundingClientRect();r.setValue(Math.round(((t.changedTouches&&t.changedTouches[0]?t.changedTouches[0].clientX:t.clientX)-n.left)/n.width*100))}},!0==="touchstart"in document.documentElement?(e.addEventListener("touchstart",a),e.addEventListener("touchend",a)):(e.addEventListener("mousedown",a),e.addEventListener("mousemove",a)),e.change=r.setValue,e.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},e.progressbar=r},e.rating=function(e,t){if(e.rating)return e.rating.setOptions(t,!0);var n={options:{},setOptions:function(t,r){var a={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(o in a)t&&t.hasOwnProperty(o)?n.options[o]=t[o]:"undefined"!=typeof n.options[o]&&!0!==r||(n.options[o]=a[o]);for(e.innerHTML="",a=0;a<n.options.number;a++){var o=document.createElement("div");o.setAttribute("data-index",a+1),o.setAttribute("title",n.options.tooltip[a]),e.appendChild(o)}if(n.options.value)for(a=0;a<n.options.number;a++)a<n.options.value&&e.children[a].classList.add("jrating-selected");return n},setValue:function(t){for(var r=0;r<n.options.number;r++)r<t?e.children[r].classList.add("jrating-selected"):(e.children[r].classList.remove("jrating-over"),e.children[r].classList.remove("jrating-selected"));n.options.value=t,"function"==typeof n.options.onchange&&n.options.onchange(e,t),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.onchange)&&e.onchange({type:"change",target:e,value:e.value})},getValue:function(){return n.options.value}};return n.setOptions(t),e.classList.add("jrating"),e.addEventListener("click",(function(e){void 0!=(e=e.target.getAttribute("data-index"))&&(e==n.options.value?n.setValue(0):n.setValue(e))})),e.addEventListener("mouseover",(function(t){t=t.target.getAttribute("data-index");for(var r=0;r<n.options.number;r++)r<t?e.children[r].classList.add("jrating-over"):e.children[r].classList.remove("jrating-over")})),e.addEventListener("mouseout",(function(t){for(t=0;t<n.options.number;t++)e.children[t].classList.remove("jrating-over")})),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.rating=n,n},e.search=function(t,n){if(t.search)return t.search;var r=null,a=function(e){if(s.innerHTML="",e.length){t.style.display="block";for(var n=11>e.length?e.length:10,r=0;r<n;r++){var a=e[r].text;!a&&e[r].name&&(a=e[r].name);var o=e[r].value;!o&&e[r].id&&(o=e[r].id);var i=document.createElement("div");i.setAttribute("data-value",o),i.setAttribute("data-text",a),i.className="jsearch_item",e[r].id&&i.setAttribute("id",e[r].id),0==r&&i.classList.add("selected"),o=document.createElement("img"),e[r].image?o.src=e[r].image:o.style.display="none",i.appendChild(o),(o=document.createElement("div")).innerHTML=a,i.appendChild(o),s.appendChild(i)}}else t.style.display=""},o=function(t){if(t!=l.terms)if(l.terms=t,r=0,Array.isArray(l.options.data)){var n=l.options.data.filter((function(e){e:{for(var n in e)if(0<=(""+e[n]).toLowerCase().search(t)){e=!0;break e}e=!1}return e}));a(n)}else e.ajax({url:l.options.data+t,method:"GET",dataType:"json",success:function(e){a(e)}})},i=null,l=function(e){i&&clearTimeout(i),i=setTimeout((function(){o(e)}),500)};l.options={data:n.data||null,input:n.input||null,onselect:n.onselect||null},l.selectIndex=function(e){var t=e.getAttribute("id"),n=e.getAttribute("data-text");e=e.getAttribute("data-value"),"function"==typeof l.options.onselect&&l.options.onselect(l,n,e,t),l.close()},l.open=function(){t.style.display="block"},l.close=function(){i&&clearTimeout(i),l.terms="",s.innerHTML="",t.style.display=""},l.isOpened=function(){return!!t.style.display},l.keydown=function(e){l.isOpened()&&("Enter"==e.key?s.children[r]&&(l.selectIndex(s.children[r]),e.preventDefault()):"ArrowUp"===e.key?(s.children[0]&&(s.children[r].classList.remove("selected"),0<r&&r--,s.children[r].classList.add("selected")),e.preventDefault()):"ArrowDown"===e.key&&(s.children[r].classList.remove("selected"),9>r&&s.children[r+1]&&r++,s.children[r].classList.add("selected"),e.preventDefault()))},l.keyup=function(t){l.options.input?l(l.options.input.value):(t=e.getNode())&&l(t.innerText)};var s=document.createElement("div");return s.classList.add("jsearch_container"),s.onmousedown=function(e){var t=e.target.classList.contains("jsearch_item")?e.target:e.target.parentNode;l.selectIndex(t),e.preventDefault()},t.appendChild(s),t.classList.add("jsearch"),t.search=l},e.slider=function(e,t){var n={options:{},currentImage:null};if(t&&(n.options=t),e.setAttribute("tabindex","900"),n.options.items=[],!e.classList.contains("jslider")){if(e.classList.add("jslider"),e.classList.add("unselectable"),n.options.height&&(e.style.minHeight=n.options.height),n.options.width&&(e.style.width=n.options.width),n.options.grid){e.classList.add("jslider-grid");var r=e.children.length;4<r&&e.setAttribute("data-total",r-4),e.setAttribute("data-number",4<r?4:r)}var a=document.createElement("div");if(a.classList.add("jslider-counter"),0<e.children.length)for(r=0;r<e.children.length;r++){n.options.items.push(e.children[r]);var o=document.createElement("div");o.onclick=function(){var e=Array.prototype.slice.call(a.children).indexOf(this);n.show(n.currentImage=n.options.items[e])},a.appendChild(o)}(r=document.createElement("div")).className="jslider-caption";var i=document.createElement("div");(o=document.createElement("div")).className="jslider-close",o.innerHTML="",o.onclick=function(){n.close()},i.appendChild(r),i.appendChild(o)}return n.updateCounter=function(e){for(var t=0;t<a.children.length;t++)if(a.children[t].classList.contains("jslider-counter-focus")){a.children[t].classList.remove("jslider-counter-focus");break}a.children[e].classList.add("jslider-counter-focus")},n.show=function(t){t||(t=e.children[0]),e.classList.add("jslider-focus"),e.classList.remove("jslider-grid"),e.appendChild(i),e.appendChild(a);var r=n.options.items.indexOf(t);for(n.updateCounter(r),r=0;r<e.children.length;r++)e.children[r].style.display="";t.style.display="block",t.previousElementSibling?e.classList.add("jslider-left"):e.classList.remove("jslider-left"),t.nextElementSibling&&"IMG"==t.nextElementSibling.tagName?e.classList.add("jslider-right"):e.classList.remove("jslider-right"),n.currentImage=t,n.currentImage.offsetHeight>n.currentImage.offsetWidth&&n.currentImage.classList.add("jslider-vertical"),i.children[0].innerText=n.currentImage.getAttribute("title")},n.open=function(){n.show(),"function"==typeof n.options.onopen&&n.options.onopen(e)},n.close=function(){e.classList.remove("jslider-focus"),e.classList.remove("jslider-left"),e.classList.remove("jslider-right"),n.options.grid&&e.classList.add("jslider-grid");for(var t=0;t<e.children.length;t++)e.children[t].style.display="";a.remove(),i.remove(),n.currentImage=null,"function"==typeof n.options.onclose&&n.options.onclose(e)},n.reset=function(){e.innerHTML=""},n.next=function(){var e=n.currentImage.nextElementSibling;e&&"IMG"===e.tagName&&n.show(n.currentImage.nextElementSibling)},n.prev=function(){n.currentImage.previousElementSibling&&n.show(n.currentImage.previousElementSibling)},r=function(e){if("IMG"==e.target.tagName)n.show(e.target);else if(!e.target.classList.contains("jslider-close")&&!e.target.parentNode.classList.contains("jslider-counter")&&!e.target.classList.contains("jslider-counter")){var t=e.offsetX||e.changedTouches[0].clientX;40>e.target.clientWidth-t?n.next():40>t&&n.prev()}},!0==="ontouchend"in document.documentElement?e.addEventListener("touchend",r):e.addEventListener("mouseup",r),e.addEventListener("swipeleft",(function(e){n.next(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("swiperight",(function(e){n.prev(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("keydown",(function(e){27==e.which&&n.close()})),e.slider=n},e.sorting=function(e,t){var n,r={},a={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},o=null;for(n in a)t&&t.hasOwnProperty(n)?r[n]=t[n]:r[n]=a[n];e.classList.add("jsorting"),e.addEventListener("dragstart",(function(t){var n=Array.prototype.indexOf.call(t.target.parentNode.children,t.target);o={element:t.target,o:n,d:n},t.target.style.opacity="0.25","function"==typeof r.ondragstart&&r.ondragstart(e,t.target,t)})),e.addEventListener("dragover",(function(e){e.preventDefault(),i(e.target)&&o&&"true"==e.target.getAttribute("draggable")&&o.element!=e.target&&((r.direction?e.target.clientWidth/2>e.offsetX:e.target.clientHeight/2>e.offsetY)?e.target.parentNode.insertBefore(o.element,e.target):e.target.parentNode.insertBefore(o.element,e.target.nextSibling),o.d=Array.prototype.indexOf.call(e.target.parentNode.children,o.element))})),e.addEventListener("dragleave",(function(e){e.preventDefault()})),e.addEventListener("dragend",(function(t){t.preventDefault(),o&&("function"==typeof r.ondragend&&r.ondragend(e,o.element,t),o.o<o.d?t.target.parentNode.insertBefore(o.element,t.target.parentNode.children[o.o]):t.target.parentNode.insertBefore(o.element,t.target.parentNode.children[o.o].nextSibling),o.element.style.opacity="",o=null)})),e.addEventListener("drop",(function(t){t.preventDefault(),o&&o.o!=o.d&&"function"==typeof r.ondrop&&r.ondrop(e,o.o,o.d,o.element,t.target,t),o.element.style.opacity="",o=null}));var i=function(e){var t=!1;return function e(n){n.className&&n.classList.contains("jsorting")&&(t=!0),t||e(n.parentNode)}(e),t};for(a=0;a<e.children.length;a++)e.children[a].hasAttribute("draggable")||e.children[a].setAttribute("draggable","true");return e.val=function(){for(var t,n=[],r=0;r<e.children.length;r++)(t=e.children[r].getAttribute("data-id"))&&n.push(t);return n},e},e.tabs=function(t,n){var r={options:{}},a={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null};for(c in a)n&&n.hasOwnProperty(c)?r.options[c]=n[c]:r.options[c]=a[c];t.classList.add("jtabs");var o=null,i=null,l=null,s=function(e){if(r.options.animation){var t=r.headers.children[e].getBoundingClientRect();"modern"==r.options.palette?(l.style.width=t.width-4+"px",l.style.left=r.headers.children[e].offsetLeft+2+"px"):(l.style.width=t.width+"px",l.style.left=r.headers.children[e].offsetLeft+"px"),"bottom"==r.options.position?l.style.top="0px":l.style.bottom="0px"}},u=function(e){"function"==typeof r.headers.scrollTo?r.headers.scrollTo({left:e,behavior:"smooth"}):r.headers.scrollLeft=e,1>=e?o.classList.add("disabled"):o.classList.remove("disabled"),e>=r.headers.scrollWidth-r.headers.offsetWidth?i.classList.add("disabled"):i.classList.remove("disabled"),r.headers.scrollWidth<=r.headers.offsetWidth?(o.style.display="none",i.style.display="none"):(o.style.display="",i.style.display="")};if(r.setBorder=s,r.open=function(e){for(var n=null,a=0;a<r.headers.children.length;a++)r.headers.children[a].classList.contains("jtabs-selected")&&(n=a),r.headers.children[a].classList.remove("jtabs-selected"),r.content.children[a]&&r.content.children[a].classList.remove("jtabs-selected");if(r.headers.children[e].classList.add("jtabs-selected"),r.content.children[e]&&r.content.children[e].classList.add("jtabs-selected"),n!=e&&"function"==typeof r.options.onchange&&r.content.children[e]&&r.options.onchange(t,r,e,r.headers.children[e],r.content.children[e]),1==r.options.hideHeaders&&3>r.headers.children.length&&0==r.options.allowCreate)r.headers.parentNode.style.display="none";else{s(e),r.headers.parentNode.style.display="",e=(n=r.headers.children[e].offsetLeft)+r.headers.children[e].offsetWidth;var o=(a=r.headers.scrollLeft)+r.headers.offsetWidth;a<=n&&o>=e||u(n-1)}},r.selectIndex=function(e){return 0<=(e=Array.prototype.indexOf.call(r.headers.children,e))&&r.open(e),e},r.rename=function(e,t){t||(t=prompt("New title",r.headers.children[e].innerText)),r.headers.children[e].innerText=t,r.open(e)},r.create=function(e,n){if("function"==typeof r.options.onbeforecreate){var a=r.options.onbeforecreate(t);if(!1===a)return!1;e=a}return a=r.appendElement(e),"function"==typeof r.options.oncreate&&r.options.oncreate(t,a),a},r.remove=function(e){return r.deleteElement(e)},r.nextNumber=function(){for(var e=0,t=0;t<r.headers.children.length;t++){var n=r.headers.children[t].innerText.match(/[0-9].*/);n>e&&(e=parseInt(n))}return e?e++:e=1,e},r.deleteElement=function(e){if(!r.headers.children[e])return!1;r.headers.removeChild(r.headers.children[e]),r.content.removeChild(r.content.children[e]),r.open(0),"function"==typeof r.options.ondelete&&r.options.ondelete(t,e)},r.appendElement=function(e){if(e||(e=prompt("Title?","")),e){var t=document.createElement("div");r.content.appendChild(t);var n=document.createElement("div");return n.innerHTML=e,n.content=t,r.headers.insertBefore(n,r.headers.lastChild),r.options.allowChangePosition&&n.setAttribute("draggable","true"),r.selectIndex(n),t}},r.getActive=function(){for(var e=0;e<r.headers.children.length;e++)if(r.headers.children[e].classList.contains("jtabs-selected"))return e;return 0},r.updateContent=function(e,t){"string"===typeof t&&(document.createElement("div").innerHTML=t),r.content.children[e].classList.contains("jtabs-selected")&&t.classList.add("jtabs-selected"),r.content.replaceChild(t,r.content.children[e])},r.updatePosition=function(e,t){e>t?r.content.insertBefore(r.content.children[e],r.content.children[t]):r.content.insertBefore(r.content.children[e],r.content.children[t].nextSibling),r.open(t),"function"==typeof r.options.onchangeposition&&r.options.onchangeposition(r.headers,e,t)},r.move=function(e,t){e>t?r.headers.insertBefore(r.headers.children[e],r.headers.children[t]):r.headers.insertBefore(r.headers.children[e],r.headers.children[t].nextSibling),r.updatePosition(e,t)},r.setBorder=s,r.init=function(){t.innerHTML="",r.headers=document.createElement("div"),r.content=document.createElement("div"),r.headers.classList.add("jtabs-headers"),r.content.classList.add("jtabs-content"),r.options.palette?t.classList.add("jtabs-modern"):t.classList.remove("jtabs-modern"),r.options.padding&&(r.content.style.padding=parseInt(r.options.padding)+"px");var n=document.createElement("div");n.className="jtabs-headers-container",n.appendChild(r.headers);var a=document.createElement("div");for(a.className="jtabs-controls",a.setAttribute("draggable","false"),n.appendChild(a),"bottom"==r.options.position?(t.appendChild(r.content),t.appendChild(n)):(t.appendChild(n),t.appendChild(r.content)),1==r.options.allowCreate&&((n=document.createElement("div")).className="jtabs-add",n.onclick=function(){r.create()},a.appendChild(n)),(o=document.createElement("div")).className="jtabs-prev",o.onclick=function(){u(r.headers.scrollLeft-r.headers.offsetWidth)},a.appendChild(o),(i=document.createElement("div")).className="jtabs-next",i.onclick=function(){u(r.headers.scrollLeft+r.headers.offsetWidth)},a.appendChild(i),a=0;a<r.options.data.length;a++){if(n=r.options.data[a].titleElement?r.options.data[a].titleElement:document.createElement("div"),r.options.data[a].icon){var s=document.createElement("div"),c=document.createElement("i");c.classList.add("material-icons"),c.innerHTML=r.options.data[a].icon,s.appendChild(c),n.appendChild(s)}r.options.data[a].title&&(s=document.createTextNode(r.options.data[a].title),n.appendChild(s)),r.options.data[a].width&&(n.style.width=r.options.data[a].width),r.options.data[a].contentElement?s=r.options.data[a].contentElement:(s=document.createElement("div")).innerHTML=r.options.data[a].content,r.headers.appendChild(n),r.content.appendChild(s)}(l=document.createElement("div")).className="jtabs-border",r.headers.appendChild(l),r.options.animation&&t.classList.add("jtabs-animation"),r.headers.addEventListener("click",(function(e){e=e.target.parentNode.classList.contains("jtabs-headers")?e.target:"I"==e.target.tagName?e.target.parentNode.parentNode:e.target.parentNode,e=r.selectIndex(e),"function"==typeof r.options.onclick&&r.options.onclick(t,r,e,r.headers.children[e],r.content.children[e])})),r.headers.addEventListener("contextmenu",(function(e){r.selectIndex(e.target)})),r.headers.children.length&&r.open(0),u(0),1==r.options.allowChangePosition&&e.sorting(r.headers,{direction:1,ondrop:function(e,t,n){r.updatePosition(t,n)}}),"function"==typeof r.options.onload&&r.options.onload(t,r)},t.children[0]&&t.children[0].children.length)for(a=0;a<t.children[0].children.length;a++){var c=r.options.data&&r.options.data[a]?r.options.data[a]:{};t.children[1]&&t.children[1].children[a]?(c.titleElement=t.children[0].children[a],c.contentElement=t.children[1].children[a]):c.contentElement=t.children[0].children[a],r.options.data[a]=c}if(c=!1,r.options.data)for(a=0;a<r.options.data.length;a++)r.options.data[a].url&&(e.ajax({url:r.options.data[a].url,type:"GET",dataType:"text/html",index:a,success:function(e){r.options.data[this.index].content=e},complete:function(){r.init()}}),c=!0);return c||r.init(),t.tabs=r},e.tags=function(t,n){if(t.tags)return t.tags.setOptions(n,!0);var r={type:"tags",options:{}},a=function(){return!!(r.options.limit&&t.children.length>=r.options.limit)},o=null,i=null;r.setOptions=function(n,a){var l,s={value:"",limit:null,limitMessage:"The limit of entries is: ",search:null,placeholder:null,validation:null,onbeforechange:null,onchange:null,onfocus:null,onblur:null,onload:null,colors:null};for(l in s)n&&n.hasOwnProperty(l)?r.options[l]=n[l]:"undefined"!=typeof r.options[l]&&!0!==a||(r.options[l]=s[l]);return r.options.placeholder?t.setAttribute("data-placeholder",r.options.placeholder):t.removeAttribute("data-placeholder"),t.placeholder=r.options.placeholder,r.setValue(r.options.value),c(),r.options.search?i||(i=document.createElement("div"),t.parentNode.insertBefore(i,t.nextSibling),o=e.search(i,{data:r.options.search,onselect:function(e,t,n){r.selectIndex(t,n)}})):i&&(o=null,i.remove(),i=null),r},r.add=function(n,i){if("function"==typeof r.options.onbeforechange){var c=r.options.onbeforechange(t,r,r.options.value,n);if(!1===c)return!1;null!=c&&(n=c)}if(o&&o.close(),a())alert(r.options.limitMessage+" "+r.options.limit);else{if(!((c=e.getNode())&&c.parentNode&&c.parentNode.classList.contains("jtags")&&c.nextSibling)||c.nextSibling.innerText&&c.nextSibling.innerText.trim()){if(t.lastChild&&(t.lastChild.innerText.trim()||t.removeChild(t.lastChild)),n&&"string"!=typeof n){for(c=0;c<=n.length;c++)if(!a()){if(n[c]&&"string"!=typeof n[c])d=n[c].text,p=n[c].value;else var d=n[c]||"",p=null;d=s(d,p)}}else d=s(n,n,c);u()}else d=c.nextSibling;i&&l(d)}},r.remove=function(e){e.parentNode.removeChild(e),t.children.length?u():r.add("",!0)},r.getData=function(){for(var e=[],n=0;n<t.children.length;n++){var r=t.children[n].innerText.replace("\n",""),a=t.children[n].getAttribute("data-value");a||(a=r),(r||a)&&e.push({text:r,value:a})}return e},r.getValue=function(e){var n;if(null!=e)(n=t.children[e].getAttribute("data-value"))||(n=t.children[e].innerText.replace("\n",""));else{e=[];for(var a=0;a<t.children.length;a++)(n=t.children[a].innerText.replace("\n",""))&&e.push(r.getValue(a));n=e.join(",")}return n},r.setValue=function(e){e?t.value!=e&&(Array.isArray(e)||(e=(""+e).trim(),e=p(e),t.innerHTML=""),r.add(e)):r.reset()},r.reset=function(){t.classList.add("jtags-empty"),t.innerHTML="<div></div>",u()},r.isValid=function(){for(var e=0,n=0;n<t.children.length;n++)t.children[n].classList.contains("jtags_error")&&e++;return 0==e},r.selectIndex=function(t,n){var o=e.getNode();o&&(o.innerText=t,n&&o.setAttribute("data-value",n),o.classList.remove("jtags_error"),a()||r.add("",!0))},r.search=function(e){},r.destroy=function(){t.removeEventListener("mouseup",v),t.removeEventListener("keydown",h),t.removeEventListener("keyup",m),t.removeEventListener("paste",g),t.removeEventListener("focus",y),t.removeEventListener("blur",b),t.parentNode.removeChild(t)};var l=function(e){var t=document.createRange(),n=window.getSelection();t.setStart(e,e.innerText.length||0),t.collapse(!0),n.removeAllRanges(),n.addRange(t),e.scrollLeft=e.scrollWidth},s=function(e,n,r){var a=document.createElement("div");return a.innerHTML=e||"",n&&a.setAttribute("data-value",n),r&&r.parentNode.classList.contains("jtags")?t.insertBefore(a,r.nextSibling):t.appendChild(a),a},u=function(){var e=r.getValue();e!=r.options.value&&(r.options.value=e,"function"==typeof r.options.onchange&&r.options.onchange(t,r,r.options.value),t.value!=r.options.value&&(t.value=r.options.value,"function"==typeof t.onchange)&&t.onchange({type:"change",target:t,value:t.value})),c()},c=function(){for(var e=0;e<t.children.length;e++)r.getValue(e)?(t.children[e].classList.add("jtags_label"),"function"==typeof r.options.validation&&r.getValue(e)?r.options.validation(t.children[e],t.children[e].innerText,t.children[e].getAttribute("data-value"))?t.children[e].classList.remove("jtags_error"):t.children[e].classList.add("jtags_error"):t.children[e].classList.remove("jtags_error")):t.children[e].classList.remove("jtags_label");d()},d=function(){t.innerText.trim()?t.classList.remove("jtags-empty"):(t.innerHTML="<div></div>",t.classList.add("jtags-empty"))},p=function(e){var t=[],n="";if(e=e.trim()){for(var r=0;r<e.length;r++)","==e[r]||";"==e[r]||"\n"==e[r]?n&&(t.push(n.trim()),n=""):n+=e[r];n&&t.push(n)}return t},f=0,h=function(e){if(f=window.getSelection().anchorOffset,d(),"Tab"===e.key||";"===e.key||","===e.key){var n=window.getSelection().anchorOffset;1<n&&(a()||r.add("",!0)),e.preventDefault()}else"Enter"==e.key?o&&o.isOpened()||(1<(n=window.getSelection().anchorOffset)&&(a()||r.add("",!0)),e.preventDefault()):"Backspace"==e.key&&1==t.children.length&&1>window.getSelection().anchorOffset&&e.preventDefault();o&&o.keydown(e)},m=function(e){39==e.which?1<(e=window.getSelection().anchorOffset)&&e==f&&r.add("",!0):13==e.which||38==e.which||40==e.which?e.preventDefault():o&&o.keyup(e),c()},g=function(e){if(e.clipboardData||e.originalEvent.clipboardData)var t=(e.originalEvent||e).clipboardData.getData("text/plain");else window.clipboardData&&(t=window.clipboardData.getData("Text"));1<(t=p(t)).length&&(r.add(t,!0),e.preventDefault())},v=function(e){if(e.target.parentNode&&e.target.parentNode.classList.contains("jtags")&&(e.target.classList.contains("jtags_label")||e.target.classList.contains("jtags_error"))){var n=e.target.getBoundingClientRect();16>n.width-(e.clientX-n.left)&&r.remove(e.target)}e.target==t&&l(t.lastChild)},y=function(){t.classList.contains("jtags-focus")||(t.children.length&&!r.getValue(t.children.length-1)||a()||s(""),"function"==typeof r.options.onfocus&&r.options.onfocus(t,r,r.getValue()),t.classList.add("jtags-focus"))},b=function(){if(t.classList.contains("jtags-focus")){o&&o.close();for(var e=0;e<t.children.length-1;e++)r.getValue(e)||t.removeChild(t.children[e]);u(),t.classList.remove("jtags-focus"),"function"==typeof r.options.onblur&&r.options.onblur(t,r,r.getValue())}};return!0==="touchend"in document.documentElement?t.addEventListener("touchend",v):t.addEventListener("mouseup",v),t.addEventListener("keydown",h),t.addEventListener("keyup",m),t.addEventListener("paste",g),t.addEventListener("focus",y),t.addEventListener("blur",b),t.setAttribute("contenteditable",!0),t.classList.add("jtags"),r.setOptions(n),"function"==typeof r.options.onload&&r.options.onload(t,r),t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},t.tags=r,r},e.toolbar=function(t,n){var r,a={options:{}},o={app:null,container:!1,badge:!1,title:!1,responsive:!1,items:[]};for(r in o)n&&n.hasOwnProperty(r)?a.options[r]=n[r]:a.options[r]=o[r];!t&&n.app&&n.app.el&&(t=document.createElement("div"),n.app.el.appendChild(t));var i=document.createElement("div");i.classList.add("jtoolbar-item"),i.classList.add("jtoolbar-arrow");var l=document.createElement("div");l.classList.add("jtoolbar-floating"),i.appendChild(l),a.selectItem=function(e){for(var t=s.children,n=0;n<t.length;n++)e!=t[n]&&t[n].classList.remove("jtoolbar-selected");e.classList.add("jtoolbar-selected")},a.hide=function(){e.animation.slideBottom(t,0,(function(){t.style.display="none"}))},a.show=function(){t.style.display="",e.animation.slideBottom(t,1)},a.get=function(){return t},a.setBadge=function(e,t){s.children[e].children[1].firstChild.innerHTML=t},a.destroy=function(){toolbar.remove(),t.innerHTML=""},a.update=function(e,n){for(var r=0;r<s.children.length;r++){var o=s.children[r];"function"==typeof o.updateState&&o.updateState(t,a,o,e,n)}},a.create=function(n){s.innerHTML="";for(var r=0;r<n.length;r++){var o=document.createElement("div");if(o.classList.add("jtoolbar-item"),n[r].width&&(o.style.width=parseInt(n[r].width)+"px"),n[r].k&&(o.k=n[r].k),n[r].tooltip&&o.setAttribute("title",n[r].tooltip),n[r].id&&o.setAttribute("id",n[r].id),n[r].updateState&&(o.updateState=n[r].updateState),n[r].active&&o.classList.add("jtoolbar-active"),"select"==n[r].type||"dropdown"==n[r].type)e.picker(o,n[r]);else if("divisor"==n[r].type)o.classList.add("jtoolbar-divisor");else if("label"==n[r].type)o.classList.add("jtoolbar-label"),o.innerHTML=n[r].content;else{var i=document.createElement("i");if("undefined"===typeof n[r].class)i.classList.add("material-icons");else for(var l=n[r].class.split(" "),u=0;u<l.length;u++)i.classList.add(l[u]);i.innerHTML=n[r].content?n[r].content:"",o.appendChild(i),1==a.options.badge&&((i=document.createElement("div")).classList.add("jbadge"),(l=document.createElement("div")).innerHTML=n[r].badge?n[r].badge:"",i.appendChild(l),o.appendChild(i)),n[r].title&&(1==a.options.title?((i=document.createElement("span")).innerHTML=n[r].title,o.appendChild(i)):o.setAttribute("title",n[r].title)),a.options.app&&n[r].route&&(o.route=n[r].route,o.onclick=function(){a.options.app.pages(this.route)},a.options.app.pages(n[r].route,{toolbarItem:o,closed:!0}))}n[r].onclick&&(o.onclick=n[r].onclick.bind(n[r],t,a,o)),s.appendChild(o)}a.refresh()},a.open=function(){i.classList.add("jtoolbar-arrow-selected"),l.getBoundingClientRect().bottom>window.innerHeight?l.style.bottom="0":l.style.removeProperty("bottom"),l.style.right="0",i.children[0].focus(),e.tracking(a,!0)},a.close=function(){i.classList.remove("jtoolbar-arrow-selected"),e.tracking(a,!1)},a.refresh=function(){if(1==a.options.responsive){for(i.remove();l.firstChild;)s.appendChild(l.firstChild);var e=t.parentNode.getBoundingClientRect().width;if(e<s.offsetWidth)for(e-=50;s.lastChild&&e<s.offsetWidth;)l.insertBefore(s.lastChild,l.firstChild);0<l.children.length&&s.appendChild(i)}},t.onclick=function(t){var n=e.findElement(t.target,"jtoolbar-item");n&&a.selectItem(n),t.target.classList.contains("jtoolbar-arrow")&&a.open()},window.addEventListener("resize",(function(){a.refresh()})),t.classList.add("jtoolbar"),t.innerHTML="",1==a.options.container&&t.classList.add("jtoolbar-container");var s=document.createElement("div");return t.appendChild(s),a.options.app&&t.classList.add("jtoolbar-mobile"),a.create(a.options.items),t.toolbar=a},e.validations=function(t,n){return"function"===typeof e.validations[n.type]?e.validations[n.type](t,n):null},e.validations.email=function(e){var t=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!(!e||!t.test(e))},e.validations.required=function(e){return!!e.trim()},e.validations.number=function(t){return e.isNumber(t)},e.validations.login=function(e){var t=new RegExp(/^[a-zA-Z0-9_\-\.\s+]+$/);return!(!e||!t.test(e))};var t=function(e,t){return"="===t.constraint?e===t.reference:"<"===t.constraint?e<t.reference:"<="===t.constraint?e<=t.reference:">"===t.constraint?e>t.reference:">="===t.constraint?e>=t.reference:"between"===t.constraint?e>=t.reference[0]&&e<=t.reference[1]:"not between"===t.constraint?e<t.reference[0]||e>t.reference[1]:null};return e.validations.number=function(n,r){return!!e.isNumeric(n)&&(void 0===r||void 0===r.constraint||t(n,r))},e.validations.date=function(e,n){return"Invalid Date"!=new Date(e)&&(void 0===n||void 0===n.constraint||("object"===typeof n?(e=new Date(e).getTime(),Array.isArray(n.reference)?n.reference=n.reference.map((function(e){return new Date(e).getTime()})):n.reference=new Date(n.reference).getTime(),t(e,n)):null))},e.validations.itemList=function(e,t){return t.reference.some((function(t){return t==e}))},e.validations.text=function(t,n){return"string"===typeof t&&(void 0===n||void 0===n.constraint||("="===n.constraint?t===n.reference:"contains"===n.constraint?t.includes(n.reference):"not contain"===n.constraint?!t.includes(n.reference):"email"===n.constraint?e.validations.email(t):"url"===n.constraint?!!new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(t):null))},e.validations.constraints=function(){},e},"object"===typeof n&&"undefined"!==typeof t?t.exports=a():r.jSuites=a()},{}],3:[function(T,S,U){if(!r&&"function"===typeof T)var r=T("jsuites");if(!w&&"function"===typeof w)var w=T("@jspreadsheet/formula");var k,v;k=this,v=function(){var k=function(){var e={title:"Jspreadsheet",version:"4.9.0",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join("\r\n")}};return function(){return e}}(),v=function(e){return"="==(e=(""+e)[0])||"#"==e},d=function(e){if(e.format||e.mask||e.locale){var t={};return e.mask?t.mask=e.mask:e.format?t.mask=e.format:(t.locale=e.locale,t.options=e.options),e.decimal&&(t.options||(t.options={}),t.options={decimal:e.decimal}),t}return null},_n=function n(q,y){var a={options:{}};if(!(q instanceof Element||q instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if("TABLE"==q.tagName){if(!(y=_n.createFromTable(q,y)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var x=document.createElement("div");q.parentNode.insertBefore(x,q),q.remove(),q=x}for(var A in x={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0},x)if(y&&y.hasOwnProperty(A))if("text"===A)for(var H in a.options[A]=x[A],y[A])y[A].hasOwnProperty(H)&&(a.options[A][H]=y[A][H]);else a.options[A]=y[A];else a.options[A]=x[A];a.el=q,a.corner=null,a.contextMenu=null,a.textarea=null,a.ads=null,a.content=null,a.table=null,a.thead=null,a.tbody=null,a.rows=[],a.results=null,a.searchInput=null,a.toolbar=null,a.pagination=null,a.pageNumber=null,a.headerContainer=null,a.colgroupContainer=null,a.headers=[],a.records=[],a.history=[],a.formula=[],a.colgroup=[],a.selection=[],a.highlighted=[],a.selectedCell=null,a.selectedContainer=null,a.style=[],a.data=null,a.filter=null,a.filters=[],a.cursor=null,a.historyIndex=-1,a.ignoreEvents=!1,a.ignoreHistory=!1,a.edition=null,a.hashString=null,a.resizing=null,a.dragging=null,1==a.options.lazyLoading&&0==a.options.tableOverflow&&0==a.options.fullscreen&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),a.options.lazyLoading=!1),a.fullscreen=function(e){null==e&&(e=!a.options.fullscreen),a.options.fullscreen!=e&&(a.options.fullscreen=e,1==e?q.classList.add("fullscreen"):q.classList.remove("fullscreen"))},a.dispatch=function(e){if(!a.ignoreEvents){if("function"==typeof a.options.onevent)var t=a.options.onevent.apply(this,arguments);"function"==typeof a.options[e]&&(t=a.options[e].apply(this,Array.prototype.slice.call(arguments,1)))}if("onafterchanges"==e&&a.options.persistance){var n=1==a.options.persistance?a.options.url:a.options.persistance,r=a.prepareJson(arguments[2]);a.save(n,r)}return t},a.prepareTable=function(){var e=a.options.columns.length;if(a.options.data&&"undefined"!==typeof a.options.data[0]){var t=Object.keys(a.options.data[0]);t.length>e&&(e=t.length)}a.options.minDimensions[0]>e&&(e=a.options.minDimensions[0]);for(var n=[],o=0;o<e;o++)a.options.colHeaders[o]||(a.options.colHeaders[o]=""),a.options.colWidths[o]||(a.options.colWidths[o]=a.options.defaultColWidth),a.options.colAlignments[o]||(a.options.colAlignments[o]=a.options.defaultColAlign),a.options.columns[o]?a.options.columns[o].type||(a.options.columns[o].type="text"):a.options.columns[o]={type:"text"},a.options.columns[o].name||(a.options.columns[o].name=t&&t[o]?t[o]:o),a.options.columns[o].source||(a.options.columns[o].source=[]),a.options.columns[o].options||(a.options.columns[o].options=[]),a.options.columns[o].editor||(a.options.columns[o].editor=null),a.options.columns[o].allowEmpty||(a.options.columns[o].allowEmpty=!1),a.options.columns[o].title||(a.options.columns[o].title=a.options.colHeaders[o]?a.options.colHeaders[o]:""),a.options.columns[o].width||(a.options.columns[o].width=a.options.colWidths[o]?a.options.colWidths[o]:a.options.defaultColWidth),a.options.columns[o].align||(a.options.columns[o].align=a.options.colAlignments[o]?a.options.colAlignments[o]:"center"),"autocomplete"==a.options.columns[o].type||"dropdown"==a.options.columns[o].type?a.options.columns[o].url&&n.push({url:a.options.columns[o].url,index:o,method:"GET",dataType:"json",success:function(e){for(var t=0;t<e.length;t++)a.options.columns[this.index].source.push(e[t])}}):"calendar"!=a.options.columns[o].type||a.options.columns[o].options.format||(a.options.columns[o].options.format="DD/MM/YYYY");n.length?r.ajax(n,(function(){a.createTable()})):a.createTable()},a.createTable=function(){a.table=document.createElement("table"),a.thead=document.createElement("thead"),a.tbody=document.createElement("tbody"),a.headers=[],a.colgroup=[],a.content=document.createElement("div"),a.content.classList.add("jexcel_content"),a.content.onscroll=function(e){a.scrollControls(e)},a.content.onwheel=function(e){a.wheelControls(e)},a.toolbar=document.createElement("div"),a.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div"),t=document.createTextNode(a.options.text.search+": ");a.searchInput=document.createElement("input"),a.searchInput.classList.add("jexcel_search"),e.appendChild(t),e.appendChild(a.searchInput),a.searchInput.onfocus=function(){a.resetSelection()};var n=document.createElement("div");if(0<a.options.pagination&&a.options.paginationOptions&&0<a.options.paginationOptions.length){a.paginationDropdown=document.createElement("select"),a.paginationDropdown.classList.add("jexcel_pagination_dropdown"),a.paginationDropdown.onchange=function(){a.options.pagination=parseInt(this.value),a.page(0)};for(var o=0;o<a.options.paginationOptions.length;o++)(t=document.createElement("option")).value=a.options.paginationOptions[o],t.innerHTML=a.options.paginationOptions[o],a.paginationDropdown.appendChild(t);a.paginationDropdown.value=a.options.pagination,n.appendChild(document.createTextNode(a.options.text.show)),n.appendChild(a.paginationDropdown),n.appendChild(document.createTextNode(a.options.text.entries))}if((t=document.createElement("div")).classList.add("jexcel_filter"),t.appendChild(n),t.appendChild(e),a.colgroupContainer=document.createElement("colgroup"),(o=document.createElement("col")).setAttribute("width","50"),a.colgroupContainer.appendChild(o),a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(o=0;o<a.options.nestedHeaders.length;o++)a.thead.appendChild(a.createNestedHeader(a.options.nestedHeaders[o]));else a.thead.appendChild(a.createNestedHeader(a.options.nestedHeaders));for(a.headerContainer=document.createElement("tr"),(o=document.createElement("td")).classList.add("jexcel_selectall"),a.headerContainer.appendChild(o),o=0;o<a.options.columns.length;o++)a.createCellHeader(o),a.headerContainer.appendChild(a.headers[o]),a.colgroupContainer.appendChild(a.colgroup[o]);if(a.thead.appendChild(a.headerContainer),1==a.options.filters){for(a.filter=document.createElement("tr"),e=document.createElement("td"),a.filter.appendChild(e),o=0;o<a.options.columns.length;o++)(e=document.createElement("td")).innerHTML="&nbsp;",e.setAttribute("data-x",o),e.className="jexcel_column_filter","hidden"==a.options.columns[o].type&&(e.style.display="none"),a.filter.appendChild(e);a.thead.appendChild(a.filter)}a.table=document.createElement("table"),a.table.classList.add("jexcel"),a.table.setAttribute("cellpadding","0"),a.table.setAttribute("cellspacing","0"),a.table.setAttribute("unselectable","yes"),a.table.appendChild(a.colgroupContainer),a.table.appendChild(a.thead),a.table.appendChild(a.tbody),a.options.textOverflow||a.table.classList.add("jexcel_overflow"),a.corner=document.createElement("div"),a.corner.className="jexcel_corner",a.corner.setAttribute("unselectable","on"),a.corner.setAttribute("onselectstart","return false"),0==a.options.selectionCopy&&(a.corner.style.display="none"),a.textarea=document.createElement("textarea"),a.textarea.className="jexcel_textarea",a.textarea.id="jexcel_textarea",a.textarea.tabIndex="-1",a.contextMenu=document.createElement("div"),a.contextMenu.className="jexcel_contextmenu",r.contextmenu(a.contextMenu,{onclick:function(){a.contextMenu.contextmenu.close(!1)}}),(o=document.createElement("a")).setAttribute("href","https://bossanova.uk/jspreadsheet/"),a.ads=document.createElement("div"),a.ads.className="jexcel_about";try{if("undefined"!==typeof sessionStorage&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var i=document.createElement("img");i.src="//bossanova.uk/jspreadsheet/logo.png",o.appendChild(i)}}catch(l){}if((i=document.createElement("span")).innerHTML="Jspreadsheet CE",o.appendChild(i),a.ads.appendChild(o),document.createElement("div").classList.add("jexcel_table"),a.pagination=document.createElement("div"),a.pagination.classList.add("jexcel_pagination"),i=document.createElement("div"),o=document.createElement("div"),a.pagination.appendChild(i),a.pagination.appendChild(o),a.options.pagination||(a.pagination.style.display="none"),1==a.options.search&&q.appendChild(t),a.content.appendChild(a.table),a.content.appendChild(a.corner),a.content.appendChild(a.textarea),q.appendChild(a.toolbar),q.appendChild(a.content),q.appendChild(a.pagination),q.appendChild(a.contextMenu),q.appendChild(a.ads),q.classList.add("jexcel_container"),a.options.toolbar&&a.options.toolbar.length&&a.createToolbar(),1==a.options.fullscreen?q.classList.add("fullscreen"):1==a.options.tableOverflow&&(a.options.tableHeight&&(a.content.style["overflow-y"]="auto",a.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",a.content.style.maxHeight=a.options.tableHeight),a.options.tableWidth&&(a.content.style["overflow-x"]="auto",a.content.style.width=a.options.tableWidth)),1!=a.options.tableOverflow&&a.options.toolbar&&q.classList.add("with-toolbar"),1==a.options.columnDrag&&a.thead.classList.add("draggable"),1==a.options.columnResize&&a.thead.classList.add("resizable"),1==a.options.rowDrag&&a.tbody.classList.add("draggable"),1==a.options.rowResize&&a.tbody.classList.add("resizable"),a.setData(),a.options.style&&a.setStyle(a.options.style,null,null,1,1),a.options.classes)for(t=Object.keys(a.options.classes),o=0;o<t.length;o++)i=_n.getIdFromColumnName(t[o],!0),a.records[i[1]][i[0]].classList.add(a.options.classes[t[o]])},a.refresh=function(){a.options.url?(1==a.options.loadingSpin&&r.loading.show(),r.ajax({url:a.options.url,method:a.options.method,data:a.options.requestVariables,dataType:"json",success:function(e){a.options.data=e.data?e.data:e,a.setData(),1==a.options.loadingSpin&&r.loading.hide()}})):a.setData()},a.setData=function(e){if(e&&("string"==typeof e&&(e=JSON.parse(e)),a.options.data=e),a.options.data||(a.options.data=[]),a.options.data&&a.options.data[0]&&!Array.isArray(a.options.data[0])){e=[];for(var t=0;t<a.options.data.length;t++){for(var n=[],r=0;r<a.options.columns.length;r++)n[r]=a.options.data[t][a.options.columns[r].name];e.push(n)}a.options.data=e}for(e=a.options.columns.length,t=a.options.data.length,e=(n=a.options.minDimensions[0])>e?n:e,n=(r=a.options.minDimensions[1])>t?r:t,t=0;t<n;t++)for(r=0;r<e;r++)void 0==a.options.data[t]&&(a.options.data[t]=[]),void 0==a.options.data[t][r]&&(a.options.data[t][r]="");for(a.rows=[],a.results=null,a.records=[],a.history=[],a.historyIndex=-1,a.tbody.innerHTML="",1==a.options.lazyLoading?(r=0,e=100>a.options.data.length?a.options.data.length:100,a.options.pagination&&(a.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))):a.options.pagination?(a.pageNumber||(a.pageNumber=0),r=a.options.pagination*a.pageNumber,e=a.options.pagination*a.pageNumber+a.options.pagination,a.options.data.length<e&&(e=a.options.data.length)):(r=0,e=a.options.data.length),t=0;t<a.options.data.length;t++)n=a.createRow(t,a.options.data[t]),t>=r&&t<e&&a.tbody.appendChild(n);if(1!=a.options.lazyLoading&&a.options.pagination&&a.updatePagination(),a.options.mergeCells)for(t=Object.keys(a.options.mergeCells),r=0;r<t.length;r++)e=a.options.mergeCells[t[r]],a.setMerge(t[r],e[0],e[1],1);a.updateTable(),a.dispatch("onload",q,a)},a.getData=function(e,t){for(var n,r=[],o=0,i=1==t||0==a.options.copyCompatibility,l=a.options.columns.length,s=a.options.data.length,u=0;u<s;u++){for(var c=n=0;c<l;c++)e&&!a.records[u][c].classList.contains("highlight")||(r[o]||(r[o]=[]),r[o][n]=i?a.options.data[u][c]:a.records[u][c].innerHTML,n++);0<n&&o++}return r},a.getJsonRow=function(e){e=a.options.data[e];for(var t=a.options.columns.length,n={},r=0;r<t;r++)a.options.columns[r].name||(a.options.columns[r].name=r),n[a.options.columns[r].name]=e[r];return n},a.getJson=function(e){for(var t=[],n=a.options.columns.length,r=a.options.data.length,o=0;o<r;o++){for(var i=null,l=0;l<n;l++)e&&!a.records[o][l].classList.contains("highlight")||(null==i&&(i={}),a.options.columns[l].name||(a.options.columns[l].name=l),i[a.options.columns[l].name]=a.options.data[o][l]);null!=i&&t.push(i)}return t},a.prepareJson=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n].x,o=e[n].y;r=a.options.columns[r].name?a.options.columns[r].name:r,t[o]||(t[o]={row:o,data:{}}),t[o].data[r]=e[n].newValue}return t.filter((function(e){return null!=e}))},a.save=function(e,t){var n=a.dispatch("onbeforesave",q,a,t);if(n)t=n;else if(!1===n)return!1;r.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(t)},success:function(e){a.dispatch("onsave",q,a,t)}})},a.getRowData=function(e){return a.options.data[e]},a.setRowData=function(e,t){for(var n=0;n<a.headers.length;n++){var r=_n.getColumnNameFromId([n,e]);null!=t[n]&&a.setValue(r,t[n])}},a.getColumnData=function(e){for(var t=[],n=0;n<a.options.data.length;n++)t.push(a.options.data[n][e]);return t},a.setColumnData=function(e,t){for(var n=0;n<a.rows.length;n++){var r=_n.getColumnNameFromId([e,n]);null!=t[n]&&a.setValue(r,t[n])}},a.createRow=function(e,t){a.records[e]||(a.records[e]=[]),t||(t=a.options.data[e]),a.rows[e]=document.createElement("tr"),a.rows[e].setAttribute("data-y",e);var n=null;a.options.defaultRowHeight&&(a.rows[e].style.height=a.options.defaultRowHeight+"px"),a.options.rows[e]&&(a.options.rows[e].height&&(a.rows[e].style.height=a.options.rows[e].height),a.options.rows[e].title&&(n=a.options.rows[e].title)),n||(n=parseInt(e+1));var r=document.createElement("td");for(r.innerHTML=n,r.setAttribute("data-y",e),r.className="jexcel_row",a.rows[e].appendChild(r),n=0;n<a.options.columns.length;n++)a.records[e][n]=a.createCell(n,e,t[n]),a.rows[e].appendChild(a.records[e][n]);return a.rows[e]},a.parseValue=function(e,t,n,o){return"="==(""+n).substr(0,1)&&1==a.options.parseFormulas&&(n=a.executeFormula(n,e,t)),(e=a.options.columns[e])&&!v(n)&&(t=d(e))&&(n&&n==Number(n)&&(n=Number(n)),e=r.mask.render(n,t,!0),o&&t.mask&&(t=t.mask.split(";"))[1]&&(t[1].match(RegExp("\\[Red\\]","gi"))&&(0>n?o.classList.add("red"):o.classList.remove("red")),t[1].match(RegExp("\\(","gi"))&&0>n&&(e="("+e+")")),e&&(n=e)),n},a.createCell=function(e,t,n){var o=document.createElement("td");if(o.setAttribute("data-x",e),o.setAttribute("data-y",t),"="==(""+n).substr(0,1)&&1==a.options.secureFormulas){var i=h(n);i!=n&&(n=i)}return a.options.columns[e].editor?(!1===a.options.stripHTML||!1===a.options.columns[e].stripHTML?o.innerHTML=n:o.innerText=n,"function"==typeof a.options.columns[e].editor.createCell&&(o=a.options.columns[e].editor.createCell(o))):"hidden"==a.options.columns[e].type?(o.style.display="none",o.innerText=n):"checkbox"==a.options.columns[e].type||"radio"==a.options.columns[e].type?((i=document.createElement("input")).type=a.options.columns[e].type,i.name="c"+e,i.checked=1==n||1==n||"true"==n,i.onclick=function(){a.setValue(o,this.checked)},1!=a.options.columns[e].readOnly&&0!=a.options.editable||i.setAttribute("disabled","disabled"),o.appendChild(i),a.options.data[t][e]=i.checked):"calendar"==a.options.columns[e].type?(i=r.calendar.extractDateFromString(n,a.options.columns[e].options.format),o.innerText=r.calendar.getDateString(i||n,a.options.columns[e].options.format)):"dropdown"==a.options.columns[e].type||"autocomplete"==a.options.columns[e].type?(o.classList.add("jexcel_dropdown"),o.innerText=a.getDropDownValue(e,n)):"color"==a.options.columns[e].type?"square"==a.options.columns[e].render?((i=document.createElement("div")).className="color",i.style.backgroundColor=n,o.appendChild(i)):(o.style.color=n,o.innerText=n):"image"==a.options.columns[e].type?n&&"data:image"==n.substr(0,10)&&((i=document.createElement("img")).src=n,o.appendChild(i)):"html"==a.options.columns[e].type||!1===a.options.stripHTML||!1===a.options.columns[e].stripHTML?o.innerHTML=B(a.parseValue(e,t,n,o)):o.innerText=a.parseValue(e,t,n,o),1==a.options.columns[e].readOnly&&(o.className="readonly"),o.style.textAlign=a.options.columns[e].align?a.options.columns[e].align:"center",0!=a.options.columns[e].wordWrap&&(1==a.options.wordWrap||1==a.options.columns[e].wordWrap||200<o.innerHTML.length)&&(o.style.whiteSpace="pre-wrap"),0<e&&1==this.options.textOverflow&&(n||o.innerHTML?a.records[t][e-1].style.overflow="hidden":e==a.options.columns.length-1&&(o.style.overflow="hidden")),o},a.createCellHeader=function(e){var t=a.options.columns[e].width?a.options.columns[e].width:a.options.defaultColWidth,n=a.options.columns[e].align?a.options.columns[e].align:a.options.defaultColAlign;a.headers[e]=document.createElement("td"),a.options.stripHTML?a.headers[e].innerText=a.options.columns[e].title?a.options.columns[e].title:_n.getColumnName(e):a.headers[e].innerHTML=a.options.columns[e].title?a.options.columns[e].title:_n.getColumnName(e),a.headers[e].setAttribute("data-x",e),a.headers[e].style.textAlign=n,a.options.columns[e].title&&a.headers[e].setAttribute("title",a.options.columns[e].title),a.options.columns[e].id&&a.headers[e].setAttribute("id",a.options.columns[e].id),a.colgroup[e]=document.createElement("col"),a.colgroup[e].setAttribute("width",t),"hidden"==a.options.columns[e].type&&(a.headers[e].style.display="none",a.colgroup[e].style.display="none")},a.updateNestedHeader=function(e,t,n){a.options.nestedHeaders[t][e].title&&(a.options.nestedHeaders[t][e].title=n,a.options.nestedHeaders[t].element.children[e+1].innerText=n)},a.createNestedHeader=function(e){var t=document.createElement("tr");t.classList.add("jexcel_nested");var n=document.createElement("td");t.appendChild(n),e.element=t;for(var r=0,o=0;o<e.length;o++){e[o].colspan||(e[o].colspan=1),e[o].align||(e[o].align="center"),e[o].title||(e[o].title=""),n=e[o].colspan;for(var i=[],l=0;l<n;l++)a.options.columns[r]&&"hidden"==a.options.columns[r].type&&n++,i.push(r),r++;(n=document.createElement("td")).setAttribute("data-column",i.join(",")),n.setAttribute("colspan",e[o].colspan),n.setAttribute("align",e[o].align),n.innerText=e[o].title,t.appendChild(n)}return t},a.createToolbar=function(e){e?a.options.toolbar=e:e=a.options.toolbar;for(var t=0;t<e.length;t++)if("i"==e[t].type){var n=document.createElement("i");n.classList.add("jexcel_toolbar_item"),n.classList.add("material-icons"),n.setAttribute("data-k",e[t].k),n.setAttribute("data-v",e[t].v),n.setAttribute("id",e[t].id),e[t].tooltip&&n.setAttribute("title",e[t].tooltip),n.onclick=e[t].onclick&&(e[t].onclick,1)?function(t){return function(){e[t].onclick(q,a,this)}}(t):function(){var e=this.getAttribute("data-k"),t=this.getAttribute("data-v");a.setStyle(a.highlighted,e,t)},n.innerText=e[t].content,a.toolbar.appendChild(n)}else if("select"==e[t].type){(n=document.createElement("select")).classList.add("jexcel_toolbar_item"),n.setAttribute("data-k",e[t].k),e[t].tooltip&&n.setAttribute("title",e[t].tooltip),n.onchange=e[t].onchange&&(e[t].onchange,1)?e[t].onchange:function(){var e=this.getAttribute("data-k");a.setStyle(a.highlighted,e,this.value)};for(var o=0;o<e[t].v.length;o++){var i=document.createElement("option");i.value=e[t].v[o],i.innerText=e[t].v[o],n.appendChild(i)}a.toolbar.appendChild(n)}else"color"==e[t].type&&((n=document.createElement("i")).classList.add("jexcel_toolbar_item"),n.classList.add("material-icons"),n.setAttribute("data-k",e[t].k),n.setAttribute("data-v",""),e[t].tooltip&&n.setAttribute("title",e[t].tooltip),a.toolbar.appendChild(n),n.innerText=e[t].content,r.color(n,{onchange:function(e,t){var n=e.getAttribute("data-k");a.setStyle(a.highlighted,n,t)}}))},a.setMerge=function(e,t,n,r){var o=!1;if(!e){if(!a.highlighted.length)return alert(a.options.text.noCellsSelected),null;t=parseInt(a.highlighted[0].getAttribute("data-x")),n=parseInt(a.highlighted[0].getAttribute("data-y"));var i=parseInt(a.highlighted[a.highlighted.length-1].getAttribute("data-x")),l=parseInt(a.highlighted[a.highlighted.length-1].getAttribute("data-y"));e=_n.getColumnNameFromId([t,n]),t=i-t+1,n=l-n+1}if(l=_n.getIdFromColumnName(e,!0),a.options.mergeCells[e])a.records[l[1]][l[0]].getAttribute("data-merged")&&(o=a.options.text.cellAlreadyMerged);else if((!t||2>t)&&(!n||2>n))o=a.options.text.invalidMergeProperties;else for(i=l[1];i<l[1]+n;i++)for(var s=l[0];s<l[0]+t;s++)_n.getColumnNameFromId([s,i]),a.records[i][s].getAttribute("data-merged")&&(o=a.options.text.thereIsAConflictWithAnotherMergedCell);if(o)alert(o);else{for(1<t?a.records[l[1]][l[0]].setAttribute("colspan",t):t=1,1<n?a.records[l[1]][l[0]].setAttribute("rowspan",n):n=1,a.options.mergeCells[e]=[t,n,[]],a.records[l[1]][l[0]].setAttribute("data-merged","true"),a.records[l[1]][l[0]].style.overflow="hidden",o=[],i=l[1];i<l[1]+n;i++)for(s=l[0];s<l[0]+t;s++)l[0]==s&&l[1]==i||(o.push(a.options.data[i][s]),a.updateCell(s,i,"",!0),a.options.mergeCells[e][2].push(a.records[i][s]),a.records[i][s].style.display="none",a.records[i][s]=a.records[l[1]][l[0]]);a.updateSelection(a.records[l[1]][l[0]]),r||(a.setHistory({action:"setMerge",column:e,colspan:t,rowspan:n,data:o}),a.dispatch("onmerge",q,e,t,n))}},a.getMerge=function(e){var t={};if(e)t=a.options.mergeCells[e]?[a.options.mergeCells[e][0],a.options.mergeCells[e][1]]:null;else if(a.options.mergeCells){e=Object.keys(a.options.mergeCells);for(var n=0;n<e.length;n++)t[e[n]]=[a.options.mergeCells[e[n]][0],a.options.mergeCells[e[n]][1]]}return t},a.removeMerge=function(e,t,n){if(a.options.mergeCells[e]){var r=_n.getIdFromColumnName(e,!0);a.records[r[1]][r[0]].removeAttribute("colspan"),a.records[r[1]][r[0]].removeAttribute("rowspan"),a.records[r[1]][r[0]].removeAttribute("data-merged");for(var o=a.options.mergeCells[e],i=0,l=0;l<o[1];l++)for(var s=0;s<o[0];s++)(0<l||0<s)&&(a.records[r[1]+l][r[0]+s]=o[2][i],a.records[r[1]+l][r[0]+s].style.display="",t&&t[i]&&a.updateCell(r[0]+s,r[1]+l,t[i]),i++);a.updateSelection(a.records[r[1]][r[0]],a.records[r[1]+l-1][r[0]+s-1]),n||delete a.options.mergeCells[e]}},a.destroyMerged=function(e){if(a.options.mergeCells)for(var t=Object.keys(a.options.mergeCells),n=0;n<t.length;n++)a.removeMerge(t[n],null,e)},a.isColMerged=function(e,t){var n=[];if(a.options.mergeCells)for(var r=Object.keys(a.options.mergeCells),o=0;o<r.length;o++){var i=_n.getIdFromColumnName(r[o],!0),l=a.options.mergeCells[r[o]][0],s=i[0];i=i[0]+(1<l?l-1:0),null==t?s<=e&&i>=e&&n.push(r[o]):t?s<e&&i>=e&&n.push(r[o]):s<=e&&i>e&&n.push(r[o])}return n},a.isRowMerged=function(e,t){var n=[];if(a.options.mergeCells)for(var r=Object.keys(a.options.mergeCells),o=0;o<r.length;o++){var i=_n.getIdFromColumnName(r[o],!0),l=a.options.mergeCells[r[o]][1],s=i[1];i=i[1]+(1<l?l-1:0),null==t?s<=e&&i>=e&&n.push(r[o]):t?s<e&&i>=e&&n.push(r[o]):s<=e&&i>e&&n.push(r[o])}return n},a.openFilter=function(e){if(a.options.filters){e=parseInt(e),a.resetSelection();var t=[];if("checkbox"==a.options.columns[e].type)t.push({id:"true",name:"True"}),t.push({id:"false",name:"False"});else{for(var n=[],o=!1,i=0;i<a.options.data.length;i++){t=a.options.data[i][e];var l=a.records[i][e].innerHTML;t&&l?n[t]=l:o=!0}for(l=Object.keys(n),t=[],i=0;i<l.length;i++)t.push({id:l[i],name:n[l[i]]});o&&t.push({value:"",id:"",name:"(Blanks)"})}n=document.createElement("div"),a.filter.children[e+1].innerHTML="",a.filter.children[e+1].appendChild(n),a.filter.children[e+1].style.paddingLeft="0px",a.filter.children[e+1].style.paddingRight="0px",a.filter.children[e+1].style.overflow="initial",r.dropdown(n,{data:t,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==a.filters[e]?a.filters[e]:null,width:"100%",position:1==a.options.tableOverflow||1==a.options.fullscreen,onclose:function(t){a.resetFilters(),a.filters[e]=t.dropdown.getValue(!0),a.filter.children[e+1].innerHTML=t.dropdown.getText(),a.filter.children[e+1].style.paddingLeft="",a.filter.children[e+1].style.paddingRight="",a.filter.children[e+1].style.overflow="",a.closeFilter(e),a.refreshSelection()}})}else console.log("Jspreadsheet: filters not enabled.")},a.resetFilters=function(){if(a.options.filters)for(var e=0;e<a.filter.children.length;e++)a.filter.children[e].innerHTML="&nbsp;",a.filters[e]=null},a.closeFilter=function(e){if(!e)for(var t=0;t<a.filter.children.length;t++)a.filters[t]&&(e=t);t=a.filters[e],a.results=[];for(var n=0;n<a.options.data.length;n++){e:{for(var r=t,o=e,i=n,l=0;l<r.length;l++)if(""==r[l]&&(!1===a.options.data[i][o]||""==""+a.options.data[i][o])||""!=r[l]&&(0<=(""+a.options.data[i][o]).search(r[l])||0<=(""+a.records[i][o].innerHTML).search(r[l]))){r=!0;break e}r=!1}r&&a.results.push(n)}a.results.length||(a.results=null),a.updateResult()},a.openEditor=function(e,t,n){var o=e.getAttribute("data-y"),i=e.getAttribute("data-x");a.dispatch("oneditionstart",q,e,i,o),0<i&&(a.records[o][i-1].style.overflow="hidden");var l=function(t){var n=e.getBoundingClientRect();return(t=document.createElement(t)).style.width=n.width+"px",t.style.height=n.height-2+"px",t.style.minHeight=n.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(t),a.dispatch("oncreateeditor",q,e,i,o,t),t};if(1!=e.classList.contains("readonly"))if(a.edition=[a.records[o][i],a.records[o][i].innerHTML,i,o],a.options.columns[i].editor)a.options.columns[i].editor.openEditor(e,q,t,n);else if("hidden"!=a.options.columns[i].type)if("checkbox"==a.options.columns[i].type||"radio"==a.options.columns[i].type)t=!e.children[0].checked,a.setValue(e,t),a.edition=null;else if("dropdown"==a.options.columns[i].type||"autocomplete"==a.options.columns[i].type){t=a.options.data[o][i],a.options.columns[i].multiple&&!Array.isArray(t)&&(t=t.split(";"));var s="function"==typeof a.options.columns[i].filter?a.options.columns[i].filter(q,e,i,o,a.options.columns[i].source):a.options.columns[i].source;n=[];for(var u=0;u<s.length;u++)n.push(s[u]);l=l("div"),s={data:n,multiple:!!a.options.columns[i].multiple,autocomplete:!(!a.options.columns[i].autocomplete&&"autocomplete"!=a.options.columns[i].type),opened:!0,value:t,width:"100%",height:l.style.minHeight,position:1==a.options.tableOverflow||1==a.options.fullscreen,onclose:function(){a.closeEditor(e,!0)}},a.options.columns[i].options&&a.options.columns[i].options.type&&(s.type=a.options.columns[i].options.type),r.dropdown(l,s)}else"calendar"==a.options.columns[i].type||"color"==a.options.columns[i].type?(t=a.options.data[o][i],(l=l("input")).value=t,1!=a.options.tableOverflow&&1!=a.options.fullscreen||(a.options.columns[i].options.position=!0),a.options.columns[i].options.value=a.options.data[o][i],a.options.columns[i].options.opened=!0,a.options.columns[i].options.onclose=function(t,n){a.closeEditor(e,!0)},"color"==a.options.columns[i].type?r.color(l,a.options.columns[i].options):r.calendar(l,a.options.columns[i].options),l.focus()):"html"==a.options.columns[i].type?(t=a.options.data[o][i],(l=l("div")).style.position="relative",(n=document.createElement("div")).classList.add("jexcel_richtext"),l.appendChild(n),r.editor(n,{focus:!0,value:t}),t=e.getBoundingClientRect(),l=n.getBoundingClientRect(),n.style.top=window.innerHeight<t.bottom+l.height?t.top-(l.height+2)+"px":t.top+"px"):"image"==a.options.columns[i].type?(t=e.children[0],(l=l("div")).style.position="relative",(n=document.createElement("div")).classList.add("jclose"),t&&t.src&&n.appendChild(t),l.appendChild(n),r.image(n,a.options.imageOptions),t=e.getBoundingClientRect(),l=n.getBoundingClientRect(),n.style.top=window.innerHeight<t.bottom+l.height?t.top-(l.height+2)+"px":t.top+"px"):(t=1==t?"":a.options.data[o][i],(l=0==a.options.columns[i].wordWrap||1!=a.options.wordWrap&&1!=a.options.columns[i].wordWrap?l("input"):l("textarea")).focus(),l.value=t,s=a.options.columns[i],n=null,!v(t)&&(n=d(s))&&(s.disabledMaskOnEdition||(s.mask?(s=s.mask.split(";"),l.setAttribute("data-mask",s[0])):s.locale&&l.setAttribute("data-locale",s.locale)),n.input=l,l.mask=n,r.mask.render(t,n,!1)),l.onblur=function(){a.closeEditor(e,!0)},l.scrollLeft=l.scrollWidth)},a.closeEditor=function(e,t){var n=parseInt(e.getAttribute("data-x")),o=parseInt(e.getAttribute("data-y"));if(1==t){if(a.options.columns[n].editor)var i=a.options.columns[n].editor.closeEditor(e,t);else if("checkbox"!=a.options.columns[n].type&&"radio"!=a.options.columns[n].type&&"hidden"!=a.options.columns[n].type)if("dropdown"==a.options.columns[n].type||"autocomplete"==a.options.columns[n].type)i=e.children[0].dropdown.close(!0);else if("calendar"==a.options.columns[n].type)i=e.children[0].calendar.close(!0);else if("color"==a.options.columns[n].type)i=e.children[0].color.close(!0);else if("html"==a.options.columns[n].type)i=e.children[0].children[0].editor.getData();else if("image"==a.options.columns[n].type)i=(i=e.children[0].children[0].children[0])&&"IMG"==i.tagName?i.src:"";else if("numeric"==a.options.columns[n].type)"="!=(i=e.children[0].value).substr(0,1)&&""==i&&(i=a.options.columns[n].allowEmpty?"":0),e.children[0].onblur=null;else{var l;i=e.children[0].value,e.children[0].onblur=null,(l=d(a.options.columns[n]))&&""!==i&&!v(i)&&"number"!==typeof i&&(l=r.mask.extract(i,l,!0))&&""!==l.value&&(i=l.value)}a.options.data[o][n]==i?e.innerHTML=a.edition[1]:a.setValue(e,i)}else a.options.columns[n].editor?a.options.columns[n].editor.closeEditor(e,t):"dropdown"==a.options.columns[n].type||"autocomplete"==a.options.columns[n].type?e.children[0].dropdown.close(!0):"calendar"==a.options.columns[n].type?e.children[0].calendar.close(!0):"color"==a.options.columns[n].type?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=a.edition&&a.edition[1]?a.edition[1]:"";a.dispatch("oneditionend",q,e,n,o,i,t),e.classList.remove("editor"),a.edition=null},a.getCell=function(e){return e=_n.getIdFromColumnName(e,!0),a.records[e[1]][e[0]]},a.getCellFromCoords=function(e,t){return a.records[t][e]},a.getLabel=function(e){return e=_n.getIdFromColumnName(e,!0),a.records[e[1]][e[0]].innerHTML},a.getLabelFromCoords=function(e,t){return a.records[t][e].innerHTML},a.getValue=function(e,t){if("object"==typeof e)var n=e.getAttribute("data-x"),r=e.getAttribute("data-y");else n=(e=_n.getIdFromColumnName(e,!0))[0],r=e[1];var o=null;return null!=n&&null!=r&&(a.records[r]&&a.records[r][n]&&(t||1==a.options.copyCompatibility)?o=a.records[r][n].innerHTML:a.options.data[r]&&"undefined"!=a.options.data[r][n]&&(o=a.options.data[r][n])),o},a.getValueFromCoords=function(e,t,n){var r=null;return null!=e&&null!=t&&(a.records[t]&&a.records[t][e]&&n||1==a.options.copyCompatibility?r=a.records[t][e].innerHTML:a.options.data[t]&&"undefined"!=a.options.data[t][e]&&(r=a.options.data[t][e])),r},a.setValue=function(e,t,n){var r=[];if("string"==typeof e){var o=_n.getIdFromColumnName(e,!0),i=o[0];o=o[1],r.push(a.updateCell(i,o,t,n)),a.updateFormulaChain(i,o,r)}else if(o=i=null,e&&e.getAttribute&&(i=e.getAttribute("data-x"),o=e.getAttribute("data-y")),null!=i&&null!=o)r.push(a.updateCell(i,o,t,n)),a.updateFormulaChain(i,o,r);else{var l=Object.keys(e);if(0<l.length)for(var s=0;s<l.length;s++)"string"==typeof e[s]?(i=(o=_n.getIdFromColumnName(e[s],!0))[0],o=o[1]):null!=e[s].x&&null!=e[s].y?(i=e[s].x,o=e[s].y,null!=e[s].newValue?t=e[s].newValue:null!=e[s].value&&(t=e[s].value)):(i=e[s].getAttribute("data-x"),o=e[s].getAttribute("data-y")),null!=i&&null!=o&&(r.push(a.updateCell(i,o,t,n)),a.updateFormulaChain(i,o,r))}a.setHistory({action:"setValue",records:r,selection:a.selectedCell}),a.updateTable(),a.onafterchanges(q,r)},a.setValueFromCoords=function(e,t,n,r){var o=[];o.push(a.updateCell(e,t,n,r)),a.updateFormulaChain(e,t,o),a.setHistory({action:"setValue",records:o,selection:a.selectedCell}),a.updateTable(),a.onafterchanges(q,o)},a.setCheckRadioValue=function(){for(var e=[],t=Object.keys(a.highlighted),n=0;n<t.length;n++){var r=a.highlighted[n].getAttribute("data-x"),o=a.highlighted[n].getAttribute("data-y");"checkbox"!=a.options.columns[r].type&&"radio"!=a.options.columns[r].type||e.push(a.updateCell(r,o,!a.options.data[o][r]))}e.length&&(a.setHistory({action:"setValue",records:e,selection:a.selectedCell}),a.onafterchanges(q,e))};var B=function(e){var t,n=new Option;for(n.innerHTML=e,e=n.getElementsByTagName("script");t=e[0];)t.parentNode.removeChild(t);return n.innerHTML};a.updateCell=function(e,t,n,o){if(1!=a.records[t][e].classList.contains("readonly")||o){if("="==(""+n).substr(0,1)&&1==a.options.secureFormulas){var i=h(n);i!=n&&(n=i)}if(void 0!=(i=a.dispatch("onbeforechange",q,a.records[t][e],e,t,n))&&(n=i),a.options.columns[e].editor&&"function"==typeof a.options.columns[e].editor.updateCell&&(n=a.options.columns[e].editor.updateCell(a.records[t][e],n,o)),o={x:e,y:t,col:e,row:t,newValue:n,oldValue:a.options.data[t][e]},a.options.columns[e].editor)a.options.data[t][e]=n;else if("checkbox"==a.options.columns[e].type||"radio"==a.options.columns[e].type){if("radio"==a.options.columns[e].type)for(i=0;i<a.options.data.length;i++)a.options.data[i][e]=!1;a.records[t][e].children[0].checked=1==n||1==n||"true"==n||"TRUE"==n,a.options.data[t][e]=a.records[t][e].children[0].checked}else"dropdown"==a.options.columns[e].type||"autocomplete"==a.options.columns[e].type?(a.options.data[t][e]=n,a.records[t][e].innerText=a.getDropDownValue(e,n)):"calendar"==a.options.columns[e].type?(i=r.calendar.extractDateFromString(n,a.options.columns[e].options.format),a.options.data[t][e]=n,a.records[t][e].innerText=r.calendar.getDateString(i||n,a.options.columns[e].options.format)):"color"==a.options.columns[e].type?(a.options.data[t][e]=n,"square"==a.options.columns[e].render?((i=document.createElement("div")).className="color",i.style.backgroundColor=n,a.records[t][e].innerText="",a.records[t][e].appendChild(i)):(a.records[t][e].style.color=n,a.records[t][e].innerText=n)):"image"==a.options.columns[e].type?(n=""+n,a.options.data[t][e]=n,a.records[t][e].innerHTML="",n&&"data:image"==n.substr(0,10)&&((i=document.createElement("img")).src=n,a.records[t][e].appendChild(i))):(a.options.data[t][e]=n,"html"==a.options.columns[e].type?a.records[t][e].innerHTML=B(a.parseValue(e,t,n)):!1===a.options.stripHTML||!1===a.options.columns[e].stripHTML?a.records[t][e].innerHTML=B(a.parseValue(e,t,n,a.records[t][e])):a.records[t][e].innerText=a.parseValue(e,t,n,a.records[t][e]),a.records[t][e].style.whiteSpace=0!=a.options.columns[e].wordWrap&&(1==a.options.wordWrap||1==a.options.columns[e].wordWrap||200<a.records[t][e].innerHTML.length)?"pre-wrap":"");0<e&&(a.records[t][e-1].style.overflow=n?"hidden":""),a.dispatch("onchange",q,a.records[t]&&a.records[t][e]?a.records[t][e]:null,e,t,n,o.oldValue)}else o={x:e,y:t,col:e,row:t};return o},a.copyData=function(e,t){var n=a.getData(!0,!0),r=a.selectedContainer,o=parseInt(e.getAttribute("data-x")),i=parseInt(e.getAttribute("data-y")),l=parseInt(t.getAttribute("data-x")),s=parseInt(t.getAttribute("data-y")),u=[],c=!1;if(r[0]==o)var d=i<r[1]?i-r[1]:1,p=0;else p=o<r[0]?o-r[0]:1,d=0;for(var f=0,h=i;h<=s;h++)if(!a.rows[h]||"none"!=a.rows[h].style.display){void 0==n[f]&&(f=0),i=0,r[0]!=o&&(p=o<r[0]?o-r[0]:1);for(var m=o;m<=l;m++){if(a.records[h][m]&&!a.records[h][m].classList.contains("readonly")&&"none"!=a.records[h][m].style.display&&0==c){if(!a.selection.length&&""!=a.options.data[h][m]){c=!0;continue}(void 0==n[f]||void 0==n[f][i])&&(i=0);var g=n[f][i];if(g&&!n[1]&&1==a.options.autoIncrement)if("text"==a.options.columns[m].type||"number"==a.options.columns[m].type)if("="==(""+g).substr(0,1)){var v=g.match(/([A-Z]+[0-9]+)/g);if(v){for(var y=[],b=0;b<v.length;b++){var w=_n.getIdFromColumnName(v[b],1);w[0]+=p,w[1]+=d,0>w[1]&&(w[1]=0),(w=_n.getColumnNameFromId([w[0],w[1]]))!=v[b]&&(y[v[b]]=w)}y&&(g=a.updateFormula(g,y))}}else g==Number(g)&&(g=Number(g)+d);else"calendar"==a.options.columns[m].type&&((g=new Date(g)).setDate(g.getDate()+d),g=g.getFullYear()+"-"+_n.doubleDigitFormat(parseInt(g.getMonth()+1))+"-"+_n.doubleDigitFormat(g.getDate())+" 00:00:00");u.push(a.updateCell(m,h,g)),a.updateFormulaChain(m,h,u)}i++,r[0]!=o&&p++}f++,d++}a.setHistory({action:"setValue",records:u,selection:a.selectedCell}),a.updateTable(),a.onafterchanges(q,u)},a.refreshSelection=function(){a.selectedCell&&a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3])},a.conditionalSelectionUpdate=function(e,t,n){1==e?a.selectedCell&&(t>=a.selectedCell[1]&&t<=a.selectedCell[3]||n>=a.selectedCell[1]&&n<=a.selectedCell[3])&&a.resetSelection():a.selectedCell&&(t>=a.selectedCell[0]&&t<=a.selectedCell[2]||n>=a.selectedCell[0]&&n<=a.selectedCell[2])&&a.resetSelection()},a.resetSelection=function(e){if(a.highlighted.length){l=1;for(var t=0;t<a.highlighted.length;t++){a.highlighted[t].classList.remove("highlight"),a.highlighted[t].classList.remove("highlight-left"),a.highlighted[t].classList.remove("highlight-right"),a.highlighted[t].classList.remove("highlight-top"),a.highlighted[t].classList.remove("highlight-bottom"),a.highlighted[t].classList.remove("highlight-selected");var n=parseInt(a.highlighted[t].getAttribute("data-x")),r=parseInt(a.highlighted[t].getAttribute("data-y"));if(a.highlighted[t].getAttribute("data-merged")){var o=parseInt(a.highlighted[t].getAttribute("colspan")),i=parseInt(a.highlighted[t].getAttribute("rowspan"));o=0<o?n+(o-1):n,i=0<i?r+(i-1):r}else o=n,i=r;for(;n<=o;n++)a.headers[n]&&a.headers[n].classList.remove("selected");for(n=r;n<=i;n++)a.rows[n]&&a.rows[n].classList.remove("selected")}}else var l=0;return a.highlighted=[],a.selectedCell=null,a.corner.style.top="-2000px",a.corner.style.left="-2000px",1==e&&1==l&&a.dispatch("onblur",q),l},a.updateSelection=function(e,t,n){var r=e.getAttribute("data-x");if(e=e.getAttribute("data-y"),t){var o=t.getAttribute("data-x");t=t.getAttribute("data-y")}else o=r,t=e;a.updateSelectionFromCoords(r,e,o,t,n)},a.updateSelectionFromCoords=function(e,t,n,r,o){var i=a.resetSelection();if(null==t&&(t=0,r=a.rows.length-1),null==n&&(n=e),null==r&&(r=t),e>=a.headers.length&&(e=a.headers.length-1),t>=a.rows.length&&(t=a.rows.length-1),n>=a.headers.length&&(n=a.headers.length-1),r>=a.rows.length&&(r=a.rows.length-1),a.selectedCell=[e,t,n,r],null!=e){if(a.records[t][e]&&a.records[t][e].classList.add("highlight-selected"),parseInt(e)<parseInt(n)){var l=parseInt(e);e=parseInt(n)}else l=parseInt(n),e=parseInt(e);for(parseInt(t)<parseInt(r)?(n=parseInt(t),t=parseInt(r)):(n=parseInt(r),t=parseInt(t)),r=l;r<=e;r++)for(var s=n;s<=t;s++)if(a.records[s][r]&&a.records[s][r].getAttribute("data-merged")){var u=parseInt(a.records[s][r].getAttribute("data-x")),c=parseInt(a.records[s][r].getAttribute("data-y")),d=parseInt(a.records[s][r].getAttribute("colspan")),p=parseInt(a.records[s][r].getAttribute("rowspan"));1<d&&(u<l&&(l=u),u+d>e&&(e=u+d-1)),p&&(c<n&&(n=c),c+p>t&&(t=c+p-1))}for(p=d=c=u=null,s=n;s<=t;s++)"none"!=a.rows[s].style.display&&(null==d&&(d=s),p=s);for(r=l;r<=e;r++){for(s=n;s<=t;s++)"none"!=a.rows[s].style.display&&"none"!=a.records[s][r].style.display&&(a.records[s][r].classList.add("highlight"),a.highlighted.push(a.records[s][r]));"hidden"!=a.options.columns[r].type&&(null==u&&(u=r),c=r)}for(u||(u=0),c||(c=0),r=u;r<=c;r++)"hidden"!=a.options.columns[r].type&&(a.records[d]&&a.records[d][r]&&a.records[d][r].classList.add("highlight-top"),a.records[p]&&a.records[p][r]&&a.records[p][r].classList.add("highlight-bottom"),a.headers[r].classList.add("selected"));for(s=d;s<=p;s++)a.rows[s]&&"none"!=a.rows[s].style.display&&(a.records[s][u].classList.add("highlight-left"),a.records[s][c].classList.add("highlight-right"),a.rows[s].classList.add("selected"));a.selectedContainer=[u,d,c,p]}0==i&&(a.dispatch("onfocus",q),a.removeCopyingSelection()),a.dispatch("onselection",q,u,d,c,p,o),a.updateCornerPosition()},a.removeCopySelection=function(){for(var e=0;e<a.selection.length;e++)a.selection[e].classList.remove("selection"),a.selection[e].classList.remove("selection-left"),a.selection[e].classList.remove("selection-right"),a.selection[e].classList.remove("selection-top"),a.selection[e].classList.remove("selection-bottom");a.selection=[]},a.updateCopySelection=function(e,t){a.removeCopySelection();var n=a.selectedContainer[0],r=a.selectedContainer[1],o=a.selectedContainer[2],i=a.selectedContainer[3];if(null!=e&&null!=t){if(0<e-o)var l=parseInt(o)+1,s=parseInt(e);else l=parseInt(e),s=parseInt(n)-1;if(0<t-i)var u=parseInt(i)+1,c=parseInt(t);else u=parseInt(t),c=parseInt(r)-1;for(s-l<=c-u?(l=parseInt(n),s=parseInt(o)):(u=parseInt(r),c=parseInt(i)),n=u;n<=c;n++)for(r=l;r<=s;r++)a.records[n][r]&&"none"!=a.rows[n].style.display&&"none"!=a.records[n][r].style.display&&(a.records[n][r].classList.add("selection"),a.records[u][r].classList.add("selection-top"),a.records[c][r].classList.add("selection-bottom"),a.records[n][l].classList.add("selection-left"),a.records[n][s].classList.add("selection-right"),a.selection.push(a.records[n][r]))}},a.updateCornerPosition=function(){if(a.highlighted.length){var e=a.highlighted[a.highlighted.length-1],t=a.content.getBoundingClientRect(),n=t.left;t=t.top;var r=e.getBoundingClientRect();e=r.left;var o=r.width,i=e-n+a.content.scrollLeft+o-4;a.corner.style.top=r.top-t+a.content.scrollTop+r.height-4+"px",a.corner.style.left=i+"px",a.options.freezeColumns&&e-n+o<(t=a.getFreezeWidth())?a.corner.style.display="none":1==a.options.selectionCopy&&(a.corner.style.display="")}else a.corner.style.top="-2000px",a.corner.style.left="-2000px"},a.updateScroll=function(e){var t=a.content.getBoundingClientRect(),n=t.left,r=t.top,o=t.width;t=t.height;var i=a.records[a.selectedCell[3]][a.selectedCell[2]].getBoundingClientRect(),l=i.left,s=i.top,u=i.width;i=i.height,0==e||1==e?(e=l-n+a.content.scrollLeft,r=s-r+a.content.scrollTop-2):(e=l-n+a.content.scrollLeft+u,r=s-r+a.content.scrollTop+i),r>a.content.scrollTop+30&&r<a.content.scrollTop+t||(a.content.scrollTop=r<a.content.scrollTop+30?r-i:r-(t-2)),r=a.getFreezeWidth(),e>a.content.scrollLeft+r&&e<a.content.scrollLeft+o||(e<a.content.scrollLeft+30?(a.content.scrollLeft=e,50>a.content.scrollLeft&&(a.content.scrollLeft=0)):a.content.scrollLeft=e<a.content.scrollLeft+r?e-r-1:e-(o-20))},a.getWidth=function(e){if(e)"object"==typeof e&&(e=$(e).getAttribute("data-x")),e=a.colgroup[e].getAttribute("width");else{e=[];for(var t=0;t<a.headers.length;t++)e.push(a.options.columns[t].width)}return e},a.setWidth=function(e,t,n){if(t){if(Array.isArray(e)){n||(n=[]);for(var r=0;r<e.length;r++){n[r]||(n[r]=a.colgroup[e[r]].getAttribute("width"));var o=Array.isArray(t)&&t[r]?t[r]:t;a.colgroup[e[r]].setAttribute("width",o),a.options.columns[e[r]].width=o}}else n||(n=a.colgroup[e].getAttribute("width")),a.colgroup[e].setAttribute("width",t),a.options.columns[e].width=t;a.setHistory({action:"setWidth",column:e,oldValue:n,newValue:t}),a.dispatch("onresizecolumn",q,e,t,n),a.updateCornerPosition()}},a.setHeight=function(e,t,n){0<t&&("object"==typeof e&&(e=e.getAttribute("data-y")),n||(n=a.rows[e].getAttribute("height"))||(n=a.rows[e].getBoundingClientRect().height),t=parseInt(t),a.rows[e].style.height=t+"px",a.options.rows[e]||(a.options.rows[e]={}),a.options.rows[e].height=t,a.setHistory({action:"setHeight",row:e,oldValue:n,newValue:t}),a.dispatch("onresizerow",q,e,t,n),a.updateCornerPosition())},a.getHeight=function(e){if(e)"object"==typeof e&&(e=$(e).getAttribute("data-y")),e=a.rows[e].style.height;else{e=[];for(var t=0;t<a.rows.length;t++){var n=a.rows[t].style.height;n&&(e[t]=n)}}return e},a.setFooter=function(e){if(e&&(a.options.footers=e),a.options.footers)for(a.tfoot||(a.tfoot=document.createElement("tfoot"),a.table.appendChild(a.tfoot)),e=0;e<a.options.footers.length;e++){if(a.tfoot.children[e])var t=a.tfoot.children[e];else{t=document.createElement("tr");var n=document.createElement("td");t.appendChild(n),a.tfoot.appendChild(t)}for(var r=0;r<a.headers.length;r++)a.options.footers[e][r]||(a.options.footers[e][r]=""),a.tfoot.children[e].children[r+1]?n=a.tfoot.children[e].children[r+1]:(n=document.createElement("td"),t.appendChild(n),n.style.textAlign=a.options.columns[r].align?a.options.columns[r].align:"center"),n.innerText=a.parseValue(r,e,a.options.footers[e][r])}},a.getHeader=function(e){return a.headers[e].innerText},a.setHeader=function(e,t){if(a.headers[e]){var n=a.headers[e].innerText;t||(t=prompt(a.options.text.columnName,n)),t&&(a.headers[e].innerText=t,a.headers[e].setAttribute("title",t),a.options.columns[e].title=t),a.setHistory({action:"setHeader",column:e,oldValue:n,newValue:t}),a.dispatch("onchangeheader",q,e,n,t)}},a.getHeaders=function(e){for(var t=[],n=0;n<a.headers.length;n++)t.push(a.getHeader(n));return e?t:t.join(a.options.csvDelimiter)},a.getMeta=function(e,t){return e?t?a.options.meta[e]&&a.options.meta[e][t]?a.options.meta[e][t]:null:a.options.meta[e]?a.options.meta[e]:null:a.options.meta},a.setMeta=function(e,t,n){if(a.options.meta||(a.options.meta={}),t&&n)a.options.meta[e]||(a.options.meta[e]={}),a.options.meta[e][t]=n;else for(var r=Object.keys(e),o=0;o<r.length;o++){a.options.meta[r[o]]||(a.options.meta[r[o]]={});for(var i=Object.keys(e[r[o]]),l=0;l<i.length;l++)a.options.meta[r[o]][i[l]]=e[r[o]][i[l]]}a.dispatch("onchangemeta",q,e,t,n)},a.updateMeta=function(e){if(a.options.meta){for(var t={},n=Object.keys(a.options.meta),r=0;r<n.length;r++)e[n[r]]?t[e[n[r]]]=a.options.meta[n[r]]:t[n[r]]=a.options.meta[n[r]];a.options.meta=t}},a.getStyle=function(e,t){if(e)return e=_n.getIdFromColumnName(e,!0),t?a.records[e[1]][e[0]].style[t]:a.records[e[1]][e[0]].getAttribute("style");for(var n={},r=a.options.data[0].length,o=a.options.data.length,i=0;i<o;i++)for(var l=0;l<r;l++){var s=t?a.records[i][l].style[t]:a.records[i][l].getAttribute("style");s&&(n[_n.getColumnNameFromId([l,i])]=s)}return n},a.resetStyle=function(e,t){for(var n=Object.keys(e),r=0;r<n.length;r++){var o=_n.getIdFromColumnName(n[r],!0);a.records[o[1]]&&a.records[o[1]][o[0]]&&a.records[o[1]][o[0]].setAttribute("style","")}a.setStyle(e,null,null,null,t)},a.setStyle=function(e,t,n,r,o){var i={},l={},s=function(e,t,n){var o=_n.getIdFromColumnName(e,!0);if(a.records[o[1]]&&a.records[o[1]][o[0]]&&(0==a.records[o[1]][o[0]].classList.contains("readonly")||r)){var s=a.records[o[1]][o[0]].style[t];s!=n||r?a.records[o[1]][o[0]].style[t]=n:(n="",a.records[o[1]][o[0]].style[t]=""),l[e]||(l[e]=[]),i[e]||(i[e]=[]),l[e].push([t+":"+s]),i[e].push([t+":"+n])}};if(t&&n)if("string"==typeof e)s(e,t,n);else for(var u=[],c=0;c<e.length;c++){var d=e[c].getAttribute("data-x"),p=e[c].getAttribute("data-y");u[d=_n.getColumnNameFromId([d,p])]||(s(d,t,n),u[d]=!0)}else for(u=Object.keys(e),c=0;c<u.length;c++)for("string"==typeof(d=e[u[c]])&&(d=d.split(";")),p=0;p<d.length;p++)"string"==typeof d[p]&&(d[p]=d[p].split(":")),d[p][0].trim()&&s(u[c],d[p][0].trim(),d[p][1]);for(u=Object.keys(l),c=0;c<u.length;c++)l[u[c]]=l[u[c]].join(";");for(u=Object.keys(i),c=0;c<u.length;c++)i[u[c]]=i[u[c]].join(";");o||a.setHistory({action:"setStyle",oldValue:l,newValue:i}),a.dispatch("onchangestyle",q,e,t,n)},a.getComments=function(e,t){if(e)return"string"==typeof e&&(e=_n.getIdFromColumnName(e,!0)),t?[a.records[e[1]][e[0]].getAttribute("title"),a.records[e[1]][e[0]].getAttribute("author")]:a.records[e[1]][e[0]].getAttribute("title")||"";for(var n={},r=0;r<a.options.data.length;r++)for(var o=0;o<a.options.columns.length;o++){var i=a.records[r][o].getAttribute("title");i&&(n[e=_n.getColumnNameFromId([o,r])]=i)}return n},a.setComments=function(e,t,n){var r="string"==typeof e?_n.getIdFromColumnName(e,!0):e,o=a.records[r[1]][r[0]].getAttribute("title"),i=[o,n=a.records[r[1]][r[0]].getAttribute("data-author")];a.records[r[1]][r[0]].setAttribute("title",t||""),a.records[r[1]][r[0]].setAttribute("data-author",n||""),t?a.records[r[1]][r[0]].classList.add("jexcel_comments"):a.records[r[1]][r[0]].classList.remove("jexcel_comments"),a.setHistory({action:"setComments",column:e,newValue:[t,n],oldValue:i}),a.dispatch("oncomments",q,t,o,r,r[0],r[1])},a.getConfig=function(){var e=a.options;return e.style=a.getStyle(),e.mergeCells=a.getMerge(),e.comments=a.getComments(),e},a.orderBy=function(e,t){if(0<=e){if(0<Object.keys(a.options.mergeCells).length){if(!confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;a.destroyMerged()}t=null==t?a.headers[e].classList.contains("arrow-down")?1:0:t?1:0;var n=[];if("number"==a.options.columns[e].type||"percentage"==a.options.columns[e].type||"autonumber"==a.options.columns[e].type||"color"==a.options.columns[e].type)for(var r=0;r<a.options.data.length;r++)n[r]=[r,Number(a.options.data[r][e])];else if("calendar"==a.options.columns[e].type||"checkbox"==a.options.columns[e].type||"radio"==a.options.columns[e].type)for(r=0;r<a.options.data.length;r++)n[r]=[r,a.options.data[r][e]];else for(r=0;r<a.options.data.length;r++)n[r]=[r,a.records[r][e].innerText.toLowerCase()];"function"!==typeof a.options.sorting&&(a.options.sorting=function(e){return function(t,n){var r=t[1],a=n[1];return e?""===r&&""!==a?1:""!==r&&""===a||r>a?-1:r<a?1:0:""===r&&""!==a?1:""!==r&&""===a?-1:r>a?1:r<a?-1:0}}),n=n.sort(a.options.sorting(t));var o=[];for(r=0;r<n.length;r++)o[r]=n[r][0];return a.setHistory({action:"orderBy",rows:o,column:e,order:t}),a.updateOrderArrow(e,t),a.updateOrder(o),a.dispatch("onsort",q,e,t),!0}},a.updateOrderArrow=function(e,t){for(var n=0;n<a.headers.length;n++)a.headers[n].classList.remove("arrow-up"),a.headers[n].classList.remove("arrow-down");t?a.headers[e].classList.add("arrow-up"):a.headers[e].classList.add("arrow-down")},a.updateOrder=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=a.options.data[e[n]];for(a.options.data=t,t=[],n=0;n<e.length;n++)t[n]=a.records[e[n]];for(a.records=t,t=[],n=0;n<e.length;n++)t[n]=a.rows[e[n]];if(a.rows=t,a.updateTableReferences(),a.results&&a.results.length)a.searchInput.value?a.search(a.searchInput.value):a.closeFilter();else if(a.results=null,a.pageNumber=0,0<a.options.pagination)a.page(0);else if(1==a.options.lazyLoading)a.loadPage(0);else for(n=0;n<a.rows.length;n++)a.tbody.appendChild(a.rows[n])},a.moveRow=function(e,t,n){if(0<Object.keys(a.options.mergeCells).length){var r=e>t?1:0;if(a.isRowMerged(e).length||a.isRowMerged(t,r).length){if(!confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;a.destroyMerged()}}if(1==a.options.search){if(a.results&&a.results.length!=a.rows.length){if(!confirm(a.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;a.resetSearch()}a.results=null}n||(0<=Array.prototype.indexOf.call(a.tbody.children,a.rows[t])?e>t?a.tbody.insertBefore(a.rows[e],a.rows[t]):a.tbody.insertBefore(a.rows[e],a.rows[t].nextSibling):a.tbody.removeChild(a.rows[e])),a.rows.splice(t,0,a.rows.splice(e,1)[0]),a.records.splice(t,0,a.records.splice(e,1)[0]),a.options.data.splice(t,0,a.options.data.splice(e,1)[0]),0<a.options.pagination&&a.tbody.children.length!=a.options.pagination&&a.page(a.pageNumber),a.setHistory({action:"moveRow",oldValue:e,newValue:t}),a.updateTableReferences(),a.dispatch("onmoverow",q,e,t)},a.insertRow=function(e,t,n){if(1==a.options.allowInsertRow){var r=[];if(0<e)var o=e;else o=1,e&&(r=e);if(n=!!n,e=a.options.data.length-1,(void 0==t||t>=parseInt(e)||0>t)&&(t=e),!1===a.dispatch("onbeforeinsertrow",q,t,o,n))return!1;if(0<Object.keys(a.options.mergeCells).length&&a.isRowMerged(t,n).length){if(!confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;a.destroyMerged()}if(1==a.options.search){if(a.results&&a.results.length!=a.rows.length){if(!confirm(a.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;a.resetSearch()}a.results=null}e=n?t:t+1;for(var i=a.records.splice(e),l=a.options.data.splice(e),s=a.rows.splice(e),u=[],c=[],d=[],p=e;p<o+e;p++){a.options.data[p]=[];for(var f=0;f<a.options.columns.length;f++)a.options.data[p][f]=r[f]?r[f]:"";f=a.createRow(p,a.options.data[p]),s[0]?0<=Array.prototype.indexOf.call(a.tbody.children,s[0])&&a.tbody.insertBefore(f,s[0]):0<=Array.prototype.indexOf.call(a.tbody.children,a.rows[t])&&a.tbody.appendChild(f),u.push(a.records[p]),c.push(a.options.data[p]),d.push(f)}Array.prototype.push.apply(a.records,i),Array.prototype.push.apply(a.options.data,l),Array.prototype.push.apply(a.rows,s),0<a.options.pagination&&a.page(a.pageNumber),a.setHistory({action:"insertRow",rowNumber:t,numOfRows:o,insertBefore:n,rowRecords:u,rowData:c,rowNode:d}),a.updateTableReferences(),a.dispatch("oninsertrow",q,t,o,u,n)}},a.deleteRow=function(e,t){if(1==a.options.allowDeleteRow)if(1==a.options.allowDeletingAllRows||1<a.options.data.length){if(void 0==e){var n=a.getSelectedRows();n[0]?(e=parseInt(n[0].getAttribute("data-y")),t=n.length):(e=a.options.data.length-1,t=1)}if(n=a.options.data.length-1,(void 0==e||e>n||0>e)&&(e=n),t||(t=1),e+t>=a.options.data.length&&(t=a.options.data.length-e),!1===a.dispatch("onbeforedeleterow",q,e,t))return!1;if(-1<parseInt(e)){var r=!1;if(0<Object.keys(a.options.mergeCells).length)for(var o=e;o<e+t;o++)a.isRowMerged(o,!1).length&&(r=!0);if(r){if(!confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;a.destroyMerged()}if(1==a.options.search){if(a.results&&a.results.length!=a.rows.length){if(!confirm(a.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;a.resetSearch()}a.results=null}for(0==a.options.allowDeletingAllRows&&n+1===t&&(t--,console.error("Jspreadsheet: It is not possible to delete the last row")),o=e;o<e+t;o++)0<=Array.prototype.indexOf.call(a.tbody.children,a.rows[o])&&(a.rows[o].className="",a.rows[o].parentNode.removeChild(a.rows[o]));n=a.records.splice(e,t),r=a.options.data.splice(e,t),o=a.rows.splice(e,t),0<a.options.pagination&&a.tbody.children.length!=a.options.pagination&&a.page(a.pageNumber),a.conditionalSelectionUpdate(1,e,e+t-1),a.setHistory({action:"deleteRow",rowNumber:e,numOfRows:t,insertBefore:1,rowRecords:n,rowData:r,rowNode:o}),a.updateTableReferences(),a.dispatch("ondeleterow",q,e,t,n)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},a.moveColumn=function(e,t){if(0<Object.keys(a.options.mergeCells).length){var n=e>t?1:0;if(a.isColMerged(e).length||a.isColMerged(t,n).length){if(!confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;a.destroyMerged()}}if((e=parseInt(e))>(t=parseInt(t)))for(a.headerContainer.insertBefore(a.headers[e],a.headers[t]),a.colgroupContainer.insertBefore(a.colgroup[e],a.colgroup[t]),n=0;n<a.rows.length;n++)a.rows[n].insertBefore(a.records[n][e],a.records[n][t]);else for(a.headerContainer.insertBefore(a.headers[e],a.headers[t].nextSibling),a.colgroupContainer.insertBefore(a.colgroup[e],a.colgroup[t].nextSibling),n=0;n<a.rows.length;n++)a.rows[n].insertBefore(a.records[n][e],a.records[n][t].nextSibling);for(a.options.columns.splice(t,0,a.options.columns.splice(e,1)[0]),a.headers.splice(t,0,a.headers.splice(e,1)[0]),a.colgroup.splice(t,0,a.colgroup.splice(e,1)[0]),n=0;n<a.rows.length;n++)a.options.data[n].splice(t,0,a.options.data[n].splice(e,1)[0]),a.records[n].splice(t,0,a.records[n].splice(e,1)[0]);if(a.options.footers)for(n=0;n<a.options.footers.length;n++)a.options.footers[n].splice(t,0,a.options.footers[n].splice(e,1)[0]);a.setHistory({action:"moveColumn",oldValue:e,newValue:t}),a.updateTableReferences(),a.dispatch("onmovecolumn",q,e,t)},a.insertColumn=function(e,t,n,r){if(1==a.options.allowInsertColumn){var o=[];if(0<e)var i=e;else i=1,e&&(o=e);if(n=!!n,e=a.options.columns.length-1,(void 0==t||t>=parseInt(e)||0>t)&&(t=e),!1===a.dispatch("onbeforeinsertcolumn",q,t,i,n))return!1;if(0<Object.keys(a.options.mergeCells).length&&a.isColMerged(t,n).length){if(!confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;a.destroyMerged()}r||(r=[]);for(var l=0;l<i;l++)r[l]||(r[l]={type:"text",source:[],options:[],width:a.options.defaultColWidth,align:a.options.defaultColAlign});e=n?t:t+1,a.options.columns=_n.injectArray(a.options.columns,e,r);var s=a.headers.splice(e),u=a.colgroup.splice(e),c=[],d=[],p=[],f=[],h=[];for(l=e;l<i+e;l++)a.createCellHeader(l),a.headerContainer.insertBefore(a.headers[l],a.headerContainer.children[l+1]),a.colgroupContainer.insertBefore(a.colgroup[l],a.colgroupContainer.children[l+1]),c.push(a.headers[l]),d.push(a.colgroup[l]);if(a.options.footers)for(var m=0;m<a.options.footers.length;m++){for(h[m]=[],l=0;l<i;l++)h[m].push("");a.options.footers[m].splice(e,0,h[m])}for(m=0;m<a.options.data.length;m++){var g=a.options.data[m].splice(e),v=a.records[m].splice(e);for(f[m]=[],p[m]=[],l=e;l<i+e;l++){var y=o[m]?o[m]:"";a.options.data[m][l]=y;var b=a.createCell(l,m,a.options.data[m][l]);a.records[m][l]=b,a.rows[m]&&a.rows[m].insertBefore(b,a.rows[m].children[l+1]),f[m].push(y),p[m].push(b)}Array.prototype.push.apply(a.options.data[m],g),Array.prototype.push.apply(a.records[m],v)}if(Array.prototype.push.apply(a.headers,s),Array.prototype.push.apply(a.colgroup,u),a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(m=0;m<a.options.nestedHeaders.length;m++){for(o=parseInt(a.options.nestedHeaders[m][a.options.nestedHeaders[m].length-1].colspan)+i,a.options.nestedHeaders[m][a.options.nestedHeaders[m].length-1].colspan=o,a.thead.children[m].children[a.thead.children[m].children.length-1].setAttribute("colspan",o),o=(o=a.thead.children[m].children[a.thead.children[m].children.length-1].getAttribute("data-column")).split(","),l=e;l<i+e;l++)o.push(l);a.thead.children[m].children[a.thead.children[m].children.length-1].setAttribute("data-column",o)}else o=parseInt(a.options.nestedHeaders[0].colspan)+i,a.options.nestedHeaders[0].colspan=o,a.thead.children[0].children[a.thead.children[0].children.length-1].setAttribute("colspan",o);a.setHistory({action:"insertColumn",columnNumber:t,numOfColumns:i,insertBefore:n,columns:r,headers:c,colgroup:d,records:p,footers:h,data:f}),a.updateTableReferences(),a.dispatch("oninsertcolumn",q,t,i,p,n)}},a.deleteColumn=function(e,t){if(1==a.options.allowDeleteColumn)if(1<a.headers.length){if(void 0==e){var n=a.getSelectedColumns(!0);n.length?(e=parseInt(n[0]),t=parseInt(n.length)):(e=a.headers.length-1,t=1)}if(n=a.options.data[0].length-1,(void 0==e||e>n||0>e)&&(e=n),t||(t=1),t>a.options.data[0].length-e&&(t=a.options.data[0].length-e),!1===a.dispatch("onbeforedeletecolumn",q,e,t))return!1;if(-1<parseInt(e)){if(n=!1,0<Object.keys(a.options.mergeCells).length)for(var r=e;r<e+t;r++)a.isColMerged(r,!1).length&&(n=!0);if(n){if(!confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;a.destroyMerged()}for(n=a.options.columns.splice(e,t),r=e;r<e+t;r++)a.colgroup[r].className="",a.headers[r].className="",a.colgroup[r].parentNode.removeChild(a.colgroup[r]),a.headers[r].parentNode.removeChild(a.headers[r]);for(var o=a.headers.splice(e,t),i=a.colgroup.splice(e,t),l=[],s=[],u=[],c=0;c<a.options.data.length;c++)for(r=e;r<e+t;r++)a.records[c][r].className="",a.records[c][r].parentNode.removeChild(a.records[c][r]);for(c=0;c<a.options.data.length;c++)s[c]=a.options.data[c].splice(e,t),l[c]=a.records[c].splice(e,t);if(a.options.footers)for(c=0;c<a.options.footers.length;c++)u[c]=a.options.footers[c].splice(e,t);if(a.conditionalSelectionUpdate(0,e,e+t-1),a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(r=0;r<a.options.nestedHeaders.length;r++)c=parseInt(a.options.nestedHeaders[r][a.options.nestedHeaders[r].length-1].colspan)-t,a.options.nestedHeaders[r][a.options.nestedHeaders[r].length-1].colspan=c,a.thead.children[r].children[a.thead.children[r].children.length-1].setAttribute("colspan",c);else c=parseInt(a.options.nestedHeaders[0].colspan)-t,a.options.nestedHeaders[0].colspan=c,a.thead.children[0].children[a.thead.children[0].children.length-1].setAttribute("colspan",c);a.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:t,insertBefore:1,columns:n,headers:o,colgroup:i,records:l,footers:u,data:s}),a.updateTableReferences(),a.dispatch("ondeletecolumn",q,e,t,l)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},a.getSelectedRows=function(e){for(var t=[],n=0;n<a.rows.length;n++)a.rows[n].classList.contains("selected")&&(e?t.push(n):t.push(a.rows[n]));return t},a.getSelectedColumns=function(){for(var e=[],t=0;t<a.headers.length;t++)a.headers[t].classList.contains("selected")&&e.push(t);return e},a.getHighlighted=function(){return a.highlighted},a.updateTableReferences=function(){for(var e=0;e<a.headers.length;e++){var t=a.headers[e].getAttribute("data-x");t!=e&&(a.headers[e].setAttribute("data-x",e),a.headers[e].getAttribute("title")||(a.headers[e].innerHTML=_n.getColumnName(e)))}for(var n=0;n<a.rows.length;n++)if(a.rows[n]){var r=a.rows[n].getAttribute("data-y");r!=n&&(a.rows[n].setAttribute("data-y",n),a.rows[n].children[0].setAttribute("data-y",n),a.rows[n].children[0].innerHTML=n+1)}var o=[],i=[],l=function(e,t,n,r){e!=n&&a.records[r][n].setAttribute("data-x",n),t!=r&&a.records[r][n].setAttribute("data-y",r),e==n&&t==r||(e=_n.getColumnNameFromId([e,t]),n=_n.getColumnNameFromId([n,r]),o[e]=n)};for(n=0;n<a.records.length;n++)for(e=0;e<a.records[0].length;e++)if(a.records[n][e])if(t=a.records[n][e].getAttribute("data-x"),r=a.records[n][e].getAttribute("data-y"),a.records[n][e].getAttribute("data-merged")){var s=_n.getColumnNameFromId([t,r]),u=_n.getColumnNameFromId([e,n]);null==i[s]&&(s==u?i[s]=!1:(t=parseInt(e-t),r=parseInt(n-r),i[s]=[u,t,r]))}else l(t,r,e,n);var c=Object.keys(i);if(c.length)for(e=0;e<c.length;e++)if(i[c[e]]){for(l(t=(n=_n.getIdFromColumnName(c[e],!0))[0],r=n[1],t+i[c[e]][1],r+i[c[e]][2]),s=c[e],u=i[c[e]][0],n=0;n<a.options.mergeCells[s][2].length;n++)t=parseInt(a.options.mergeCells[s][2][n].getAttribute("data-x")),r=parseInt(a.options.mergeCells[s][2][n].getAttribute("data-y")),a.options.mergeCells[s][2][n].setAttribute("data-x",t+i[c[e]][1]),a.options.mergeCells[s][2][n].setAttribute("data-y",r+i[c[e]][2]);a.options.mergeCells[u]=a.options.mergeCells[s],delete a.options.mergeCells[s]}a.updateFormulas(o),a.updateMeta(o),a.refreshSelection(),a.updateTable()},a.updateTable=function(){if(0<a.options.minSpareRows){for(var e=0,t=a.rows.length-1;0<=t;t--){for(var n=!1,r=0;r<a.headers.length;r++)a.options.data[t][r]&&(n=!0);if(n)break;e++}0<a.options.minSpareRows-e&&a.insertRow(a.options.minSpareRows-e)}if(0<a.options.minSpareCols){for(e=0,r=a.headers.length-1;0<=r;r--){for(n=!1,t=0;t<a.rows.length;t++)a.options.data[t][r]&&(n=!0);if(n)break;e++}0<a.options.minSpareCols-e&&a.insertColumn(a.options.minSpareCols-e)}if("function"==typeof a.options.updateTable){for(a.options.detachForUpdates&&q.removeChild(a.content),t=0;t<a.rows.length;t++)for(r=0;r<a.headers.length;r++)a.options.updateTable(q,a.records[t][r],r,t,a.options.data[t][r],a.records[t][r].innerText,_n.getColumnNameFromId([r,t]));a.options.detachForUpdates&&q.insertBefore(a.content,a.pagination)}a.options.footers&&a.setFooter(),setTimeout((function(){a.updateCornerPosition()}),0)},a.isReadOnly=function(e){if(e=a.getCell(e))return!!e.classList.contains("readonly")},a.setReadOnly=function(e,t){(e=a.getCell(e))&&(t?e.classList.add("readonly"):e.classList.remove("readonly"))},a.showRow=function(e){a.rows[e].style.display=""},a.hideRow=function(e){a.rows[e].style.display="none"},a.showColumn=function(e){a.headers[e].style.display="",a.colgroup[e].style.display="";for(var t=0;t<a.options.data.length;t++)a.records[t][e].style.display=""},a.hideColumn=function(e){a.headers[e].style.display="none",a.colgroup[e].style.display="none";for(var t=0;t<a.options.data.length;t++)a.records[t][e].style.display="none"},a.showIndex=function(){a.table.classList.remove("jexcel_hidden_index")},a.hideIndex=function(){a.table.classList.add("jexcel_hidden_index")};var t=[];a.updateFormulaChain=function(e,n,r){var o=_n.getColumnNameFromId([e,n]);if(a.formula[o]&&0<a.formula[o].length)if(t[o])a.records[n][e].innerHTML="#ERROR",a.formula[o]="";else for(t[o]=!0,e=0;e<a.formula[o].length;e++){n=_n.getIdFromColumnName(a.formula[o][e],!0);var i=""+a.options.data[n[1]][n[0]];"="==i.substr(0,1)?r.push(a.updateCell(n[0],n[1],i,!0)):Object.keys(a.formula)[e]=null,a.updateFormulaChain(n[0],n[1],r)}t=[]},a.updateFormulas=function(e){for(var t=0;t<a.options.data.length;t++)for(var n=0;n<a.options.data[0].length;n++){var r=""+a.options.data[t][n];if("="==r.substr(0,1)){var o=a.updateFormula(r,e);o!=r&&(a.options.data[t][n]=o)}}o=[];var i=Object.keys(a.formula);for(t=0;t<i.length;t++){var l=i[t];for(r=a.formula[l],e[l]&&(l=e[l]),o[l]=[],n=0;n<r.length;n++){var s=r[n];e[s]&&(s=e[s]),o[l].push(s)}}a.formula=o},a.updateFormula=function(e,t){for(var n=/[A-Z]/,r=/[0-9]/,a="",o=null,i=null,l="",s=0;s<e.length;s++)n.exec(e[s])?(o=1,i=0,l+=e[s]):r.exec(e[s])?(i=o?1:0,l+=e[s]):(o&&i&&(l=t[l]?t[l]:l),a+=l,a+=e[s],i=o=0,l="");return l&&(o&&i&&(l=t[l]?t[l]:l),a+=l),a};var h=function(e){for(var t="",n=0,r=0;r<e.length;r++)'"'==e[r]&&(n=0==n?1:0),t=1==n?t+e[r]:t+e[r].toUpperCase();return t};a.executeFormula=function(b,c,e){var g=[],l=[],p=function p(u,m,z){var D=_n.getColumnNameFromId([m,z]);if(l[D])return console.error("Reference loop detected"),"#ERROR";l[D]=!0;var E=function(e){for(var t=0;t<e.length;t++){var n=[],r=e[t].split(":"),a=_n.getIdFromColumnName(r[0],!0),o=_n.getIdFromColumnName(r[1],!0);if(a[0]<=o[0]){r=a[0];var i=o[0]}else r=o[0],i=a[0];if(a[1]<=o[1]){var l=a[1];a=o[1]}else l=o[1],a=a[1];for(;l<=a;l++)for(o=r;o<=i;o++)n.push(_n.getColumnNameFromId([o,l]));u=u.replace(e[t],n.join(","))}};u=u.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var C=u.match(/([A-Z]+[0-9]+):([A-Z]+[0-9]+)/g);if(C&&C.length&&E(C),(C=u.match(/([A-Z]+[0-9]+)/g))&&-1<C.indexOf(D))return console.error("Self Reference detected"),"#ERROR";if(E={},C)for(var F=0;F<C.length;F++)if(a.formula[C[F]]||(a.formula[C[F]]=[]),0>a.formula[C[F]].indexOf(D)&&a.formula[C[F]].push(D),eval("typeof("+C[F]+') == "undefined"')){var I=_n.getIdFromColumnName(C[F],1),J="undefined"!=typeof a.options.data[I[1]]&&"undefined"!=typeof a.options.data[I[1]][I[0]]?a.options.data[I[1]][I[0]]:"";"="==(""+J).substr(0,1)&&(g[C[F]]?J=g[C[F]]:(J=p(J,I[0],I[1]),g[C[F]]=J)),""==(""+J).trim()?E[C[F]]=null:J==Number(J)&&1==a.options.autoCasting?E[C[F]]=Number(J):(I=a.parseNumber(J,I[0]),E[C[F]]=1==a.options.autoCasting&&I?I:'"'+J+'"')}try{var M=_n.formula(u.substr(1),E,m,z,a)}catch(P){M="#ERROR",console.log(P)}return M};return p(b,c,e)},a.parseNumber=function(e,t){var n=(""+e).split(t&&a.options.columns[t].decimal?a.options.columns[t].decimal:".");return n[0]=n[0].match(/[+-]?[0-9]/g),n[0]&&(n[0]=n[0].join("")),n[1]&&(n[1]=n[1].match(/[0-9]*/g).join("")),n[0]&&0<=Number(n[0])?n[1]?Number(n[0]+"."+n[1]):Number(n[0]+".00"):null},a.row=function(e){},a.col=function(e){},a.up=function(e,t){if(e?0<a.selectedCell[3]&&a.up.visible(1,t?0:1):(0<a.selectedCell[1]&&a.up.visible(0,t?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]),1==a.options.lazyLoading)if(0==a.selectedCell[1]||0==a.selectedCell[3])a.loadPage(0),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);else if(a.loadValidation())a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);else{var n=parseInt(a.tbody.firstChild.getAttribute("data-y"));30>a.selectedCell[1]-n&&(a.loadUp(),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]))}else 0<a.options.pagination&&(n=a.whichPage(a.selectedCell[3]))!=a.pageNumber&&a.page(n);a.updateScroll(1)},a.up.visible=function(e,t){if(0==e)var n=parseInt(a.selectedCell[0]),r=parseInt(a.selectedCell[1]);else n=parseInt(a.selectedCell[2]),r=parseInt(a.selectedCell[3]);if(0==t){for(var o=0;o<r;o++)if("none"!=a.records[o][n].style.display&&"none"!=a.rows[o].style.display){r=o;break}}else r=a.up.get(n,r);0==e?(a.selectedCell[0]=n,a.selectedCell[1]=r):(a.selectedCell[2]=n,a.selectedCell[3]=r)},a.up.get=function(e,t){e=parseInt(e);for(var n=(t=parseInt(t))-1;0<=n;n--)if("none"!=a.records[n][e].style.display&&"none"!=a.rows[n].style.display&&(!a.records[n][e].getAttribute("data-merged")||a.records[n][e]!=a.records[t][e])){t=n;break}return t},a.down=function(e,t){if(e?a.selectedCell[3]<a.records.length-1&&a.down.visible(1,t?0:1):(a.selectedCell[1]<a.records.length-1&&a.down.visible(0,t?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]),1==a.options.lazyLoading)a.selectedCell[1]==a.records.length-1||a.selectedCell[3]==a.records.length-1?(a.loadPage(-1),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3])):a.loadValidation()?a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]):30>parseInt(a.tbody.lastChild.getAttribute("data-y"))-a.selectedCell[3]&&(a.loadDown(),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]));else if(0<a.options.pagination){var n=a.whichPage(a.selectedCell[3]);n!=a.pageNumber&&a.page(n)}a.updateScroll(3)},a.down.visible=function(e,t){if(0==e)var n=parseInt(a.selectedCell[0]),r=parseInt(a.selectedCell[1]);else n=parseInt(a.selectedCell[2]),r=parseInt(a.selectedCell[3]);if(0==t){for(var o=a.rows.length-1;o>r;o--)if("none"!=a.records[o][n].style.display&&"none"!=a.rows[o].style.display){r=o;break}}else r=a.down.get(n,r);0==e?(a.selectedCell[0]=n,a.selectedCell[1]=r):(a.selectedCell[2]=n,a.selectedCell[3]=r)},a.down.get=function(e,t){e=parseInt(e);for(var n=(t=parseInt(t))+1;n<a.rows.length;n++)if("none"!=a.records[n][e].style.display&&"none"!=a.rows[n].style.display&&(!a.records[n][e].getAttribute("data-merged")||a.records[n][e]!=a.records[t][e])){t=n;break}return t},a.right=function(e,t){e?a.selectedCell[2]<a.headers.length-1&&a.right.visible(1,t?0:1):(a.selectedCell[0]<a.headers.length-1&&a.right.visible(0,t?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]),a.updateScroll(2)},a.right.visible=function(e,t){if(0==e)var n=parseInt(a.selectedCell[0]),r=parseInt(a.selectedCell[1]);else n=parseInt(a.selectedCell[2]),r=parseInt(a.selectedCell[3]);if(0==t){for(var o=a.headers.length-1;o>n;o--)if("none"!=a.records[r][o].style.display){n=o;break}}else n=a.right.get(n,r);0==e?(a.selectedCell[0]=n,a.selectedCell[1]=r):(a.selectedCell[2]=n,a.selectedCell[3]=r)},a.right.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=e+1;n<a.headers.length;n++)if("none"!=a.records[t][n].style.display&&(!a.records[t][n].getAttribute("data-merged")||a.records[t][n]!=a.records[t][e])){e=n;break}return e},a.left=function(e,t){e?0<a.selectedCell[2]&&a.left.visible(1,t?0:1):(0<a.selectedCell[0]&&a.left.visible(0,t?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]),a.updateScroll(0)},a.left.visible=function(e,t){if(0==e)var n=parseInt(a.selectedCell[0]),r=parseInt(a.selectedCell[1]);else n=parseInt(a.selectedCell[2]),r=parseInt(a.selectedCell[3]);if(0==t){for(var o=0;o<n;o++)if("none"!=a.records[r][o].style.display){n=o;break}}else n=a.left.get(n,r);0==e?(a.selectedCell[0]=n,a.selectedCell[1]=r):(a.selectedCell[2]=n,a.selectedCell[3]=r)},a.left.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=e-1;0<=n;n--)if("none"!=a.records[t][n].style.display&&(!a.records[t][n].getAttribute("data-merged")||a.records[t][n]!=a.records[t][e])){e=n;break}return e},a.first=function(e,t){if(e?t?a.selectedCell[3]=0:a.left.visible(1,0):(t?a.selectedCell[1]=0:a.left.visible(0,0),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]),1!=a.options.lazyLoading||0!=a.selectedCell[1]&&0!=a.selectedCell[3]){if(0<a.options.pagination){var n=a.whichPage(a.selectedCell[3]);n!=a.pageNumber&&a.page(n)}}else a.loadPage(0);a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]),a.updateScroll(1)},a.last=function(e,t){if(e?t?a.selectedCell[3]=a.records.length-1:a.right.visible(1,0):(t?a.selectedCell[1]=a.records.length-1:a.right.visible(0,0),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]),1!=a.options.lazyLoading||a.selectedCell[1]!=a.records.length-1&&a.selectedCell[3]!=a.records.length-1){if(0<a.options.pagination){var n=a.whichPage(a.selectedCell[3]);n!=a.pageNumber&&a.page(n)}}else a.loadPage(-1);a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]),a.updateScroll(3)},a.selectAll=function(){a.selectedCell||(a.selectedCell=[]),a.selectedCell[0]=0,a.selectedCell[1]=0,a.selectedCell[2]=a.headers.length-1,a.selectedCell[3]=a.records.length-1,a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3])},a.loadPage=function(e){var t=1==a.options.search&&a.results?a.results:a.rows;null!=e&&-1!=e||(e=Math.ceil(t.length/100)-1),(e=100*e+100)>t.length&&(e=t.length);var n=e-100;for(0>n&&(n=0);n<e;n++)1==a.options.search&&a.results?a.tbody.appendChild(a.rows[t[n]]):a.tbody.appendChild(a.rows[n]),100<a.tbody.children.length&&a.tbody.removeChild(a.tbody.firstChild)},a.loadUp=function(){var e=1==a.options.search&&a.results?a.results:a.rows,t=0;if(100<e.length){var n=parseInt(a.tbody.firstChild.getAttribute("data-y"));if(1==a.options.search&&a.results&&(n=e.indexOf(n)),0<n)for(var r=0;30>r;r++)-1<--n&&(1==a.options.search&&a.results?a.tbody.insertBefore(a.rows[e[n]],a.tbody.firstChild):a.tbody.insertBefore(a.rows[n],a.tbody.firstChild),100<a.tbody.children.length&&(a.tbody.removeChild(a.tbody.lastChild),t=1))}return t},a.loadDown=function(){var e=1==a.options.search&&a.results?a.results:a.rows,t=0;if(100<e.length){var n=parseInt(a.tbody.lastChild.getAttribute("data-y"));if(1==a.options.search&&a.results&&(n=e.indexOf(n)),n<a.rows.length-1)for(var r=0;30>=r;r++)n<e.length&&(1==a.options.search&&a.results?a.tbody.appendChild(a.rows[e[n]]):a.tbody.appendChild(a.rows[n]),100<a.tbody.children.length&&(a.tbody.removeChild(a.tbody.firstChild),t=1)),n+=1}return t},a.loadValidation=function(){if(a.selectedCell){var e=parseInt(a.tbody.firstChild.getAttribute("data-y"))/100,t=parseInt(a.selectedCell[3]/100),n=parseInt(a.rows.length/100);if(e!=t&&t<=n&&!Array.prototype.indexOf.call(a.tbody.children,a.rows[a.selectedCell[3]]))return a.loadPage(t),!0}return!1},a.resetSearch=function(){a.searchInput.value="",a.search(""),a.results=null},a.search=function(e){if(e&&(e=e.toLowerCase()),a.options.filters&&a.resetFilters(),a.resetSelection(),a.pageNumber=0,a.results=[],e){var t=function(e){-1==a.results.indexOf(e)&&a.results.push(e)};a.options.data.filter((function(n,r){e:{for(var o=e,i=0;i<n.length;i++)if(0<=(""+n[i]).toLowerCase().search(o)||0<=(""+a.records[r][i].innerHTML).toLowerCase().search(o)){o=!0;break e}o=!1}if(o){if((o=a.isRowMerged(r)).length)for(i=0;i<o.length;i++)for(var l=_n.getIdFromColumnName(o[i],!0),s=0;s<a.options.mergeCells[o[i]][1];s++)t(l[1]+s);else t(r);return!0}return!1}))}else a.results=null;return a.updateResult()},a.updateResult=function(){var e,t=0;for(e=1==a.options.lazyLoading?100:0<a.options.pagination?a.options.pagination:a.results?a.results.length:a.rows.length;a.tbody.firstChild;)a.tbody.removeChild(a.tbody.firstChild);for(var n=0;n<a.rows.length;n++)!a.results||-1<a.results.indexOf(n)?(t<e&&(a.tbody.appendChild(a.rows[n]),t++),a.rows[n].style.display=""):a.rows[n].style.display="none";return 0<a.options.pagination&&a.updatePagination(),a.updateCornerPosition(),e},a.whichPage=function(e){return 1==a.options.search&&a.results&&(e=a.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(a.options.pagination))-1},a.page=function(e){var t=a.pageNumber,n=1==a.options.search&&a.results?a.results:a.rows,r=parseInt(a.options.pagination);null!=e&&-1!=e||(e=Math.ceil(n.length/r)-1),a.pageNumber=e;var o=e*r;for((r=e*r+r)>n.length&&(r=n.length),0>o&&(o=0);a.tbody.firstChild;)a.tbody.removeChild(a.tbody.firstChild);for(;o<r;o++)1==a.options.search&&a.results?a.tbody.appendChild(a.rows[n[o]]):a.tbody.appendChild(a.rows[o]);0<a.options.pagination&&a.updatePagination(),a.updateCornerPosition(),a.dispatch("onchangepage",q,e,t)},a.updatePagination=function(){if(a.pagination.children[0].innerHTML="",a.pagination.children[1].innerHTML="",a.options.pagination){var e=1==a.options.search&&a.results?a.results.length:a.rows.length;if(e){if(e=Math.ceil(e/a.options.pagination),6>a.pageNumber)var t=1,n=10>e?e:10;else 5>e-a.pageNumber?(n=e,1>(t=e-9)&&(t=1)):(t=a.pageNumber-4,n=a.pageNumber+5);if(1<t){var r=document.createElement("div");r.className="jexcel_page",r.innerHTML="<",r.title=1,a.pagination.children[1].appendChild(r)}for(;t<=n;t++)(r=document.createElement("div")).className="jexcel_page",r.innerHTML=t,a.pagination.children[1].appendChild(r),a.pageNumber==t-1&&r.classList.add("jexcel_page_selected");n<e&&((r=document.createElement("div")).className="jexcel_page",r.innerHTML=">",r.title=e,a.pagination.children[1].appendChild(r)),a.pagination.children[0].innerHTML=function(e){var t=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,(function(e,n){return"undefined"!=typeof t[n]?t[n]:e}))}(a.options.text.showingPage,a.pageNumber+1,e)}else a.pagination.children[0].innerHTML=a.options.text.noRecordsFound}},a.download=function(e){if(0==a.options.allowExport)console.error("Export not allowed");else{e=""+a.copy(!1,a.options.csvDelimiter,!0,e,!0);var t=new Blob(["\ufeff"+e],{type:"text/csv;charset=utf-8;"});window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(t,a.options.csvFileName+".csv"):(e=document.createElement("a"),t=URL.createObjectURL(t),e.href=t,e.setAttribute("download",a.options.csvFileName+".csv"),document.body.appendChild(e),e.click(),e.parentNode.removeChild(e))}},a.setHistory=function(e){if(1!=a.ignoreHistory){var t=++a.historyIndex;a.history=a.history.slice(0,t+1),a.history[t]=e}},a.copy=function(e,t,n,r,o){t||(t="\t");var i,l=new RegExp(t,"ig"),s=[],u=[],c=[],d=a.options.data[0].length,p=a.options.data.length,f=!1,h="",m="",g=0,v=0;if(o&&1==a.options.includeHeadersOnDownload||!o&&1==a.options.includeHeadersOnCopy||r){if(a.options.nestedHeaders&&0<a.options.nestedHeaders.length){var y=a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0]?a.options.nestedHeaders:[a.options.nestedHeaders];for(r=0;r<y.length;r++){for(f=[],o=0;o<y[r].length;o++){var b=parseInt(y[r][o].colspan);for(f.push(y[r][o].title),i=0;i<b-1;i++)f.push("")}m+=f.join(t)+"\r\n"}}f=!0}for(a.style=[],r=0;r<p;r++){for(b=[],i=[],o=0;o<d;o++)e&&!a.records[r][o].classList.contains("highlight")||(1==f&&s.push(a.headers[o].innerText),(y=a.options.data[r][o]).match&&(y.match(l)||y.match(/,/g)||y.match(/\n/)||y.match(/"/))&&(y='"'+(y=y.replace(RegExp('"',"g"),'""'))+'"'),b.push(y),"checkbox"!=a.options.columns[o].type&&"radio"!=a.options.columns[o].type&&(y=1==a.options.stripHTMLOnCopy?a.records[r][o].innerText:a.records[r][o].innerHTML).match&&(y.match(l)||y.match(/,/g)||y.match(/\n/)||y.match(/"/))&&(y='"'+(y=y.replace(RegExp('"',"g"),'""'))+'"'),i.push(y),y=(y=a.records[r][o].getAttribute("style")).replace("display: none;",""),a.style.push(y||""));b.length&&(f&&(g=b.length,u.push(s.join(t))),u.push(b.join(t))),i.length&&(v++,f&&(c.push(s.join(t)),f=!1),c.push(i.join(t)))}if(d==g&&p==v&&(h=m),e=h+u.join("\r\n"),h+=c.join("\r\n"),n||(a.textarea.value=1==a.options.copyCompatibility?h:e,a.textarea.select(),document.execCommand("copy")),a.data=1==a.options.copyCompatibility?h:e,a.hashString=a.hash(a.data),!n){if(a.removeCopyingSelection(),a.highlighted)for(o=0;o<a.highlighted.length;o++)a.highlighted[o].classList.add("copying"),a.highlighted[o].classList.contains("highlight-left")&&a.highlighted[o].classList.add("copying-left"),a.highlighted[o].classList.contains("highlight-right")&&a.highlighted[o].classList.add("copying-right"),a.highlighted[o].classList.contains("highlight-top")&&a.highlighted[o].classList.add("copying-top"),a.highlighted[o].classList.contains("highlight-bottom")&&a.highlighted[o].classList.add("copying-bottom");a.dispatch("oncopy",q,1==a.options.copyCompatibility?c:u,a.hashString)}return a.data},a.paste=function(e,t,n){var r=a.dispatch("onbeforepaste",q,n,e,t);if(!1===r)return!1;r&&(n=r);var o=a.hash(n);if(r=o==a.hashString?a.style:null,1==a.options.copyCompatibility&&o==a.hashString&&(n=a.data),n=a.parseCSV(n,"\t"),null!=e&&null!=t&&n){for(var i,l=0,s=[],u={},c={},d=0,p=parseInt(e),f=parseInt(t);i=n[l];){for(o=0,p=parseInt(e);null!=i[o];){var h=a.updateCell(p,f,i[o]);if(s.push(h),a.updateFormulaChain(p,f,s),r&&r[d]&&(u[h=_n.getColumnNameFromId([p,f])]=r[d],c[h]=a.getStyle(h),a.records[f][p].setAttribute("style",r[d]),d++),null!=i[++o]){if(p>=a.headers.length-1){if(1!=a.options.allowInsertColumn)break;a.insertColumn()}p=a.right.get(p,f)}}if(n[++l]){if(f>=a.rows.length-1){if(1!=a.options.allowInsertRow)break;a.insertRow()}f=a.down.get(e,f)}}a.updateSelectionFromCoords(e,t,p,f),a.setHistory({action:"setValue",records:s,selection:a.selectedCell,newStyle:u,oldStyle:c}),a.updateTable(),a.dispatch("onpaste",q,n),a.onafterchanges(q,s)}a.removeCopyingSelection()},a.removeCopyingSelection=function(){for(var e=document.querySelectorAll(".jexcel .copying"),t=0;t<e.length;t++)e[t].classList.remove("copying"),e[t].classList.remove("copying-left"),e[t].classList.remove("copying-right"),e[t].classList.remove("copying-top"),e[t].classList.remove("copying-bottom")},a.historyProcessRow=function(e,t){var n=t.insertBefore?+t.rowNumber:t.rowNumber+1;if(1==a.options.search&&a.results&&a.results.length!=a.rows.length&&a.resetSearch(),1==e){for(var r=t.numOfRows,o=n;o<r+n;o++)a.rows[o].parentNode.removeChild(a.rows[o]);a.records.splice(n,r),a.options.data.splice(n,r),a.rows.splice(n,r),a.conditionalSelectionUpdate(1,n,r+n-1)}else for(a.records=_n.injectArray(a.records,n,t.rowRecords),a.options.data=_n.injectArray(a.options.data,n,t.rowData),a.rows=_n.injectArray(a.rows,n,t.rowNode),r=0,o=n;o<t.numOfRows+n;o++)a.tbody.insertBefore(t.rowNode[r],a.tbody.children[o]),r++;0<a.options.pagination&&a.page(a.pageNumber),a.updateTableReferences()},a.historyProcessColumn=function(e,t){var n=t.insertBefore?t.columnNumber:t.columnNumber+1;if(1==e){var r=t.numOfColumns;a.options.columns.splice(n,r);for(var o=n;o<r+n;o++)a.headers[o].parentNode.removeChild(a.headers[o]),a.colgroup[o].parentNode.removeChild(a.colgroup[o]);a.headers.splice(n,r),a.colgroup.splice(n,r);for(var i=0;i<t.data.length;i++){for(o=n;o<r+n;o++)a.records[i][o].parentNode.removeChild(a.records[i][o]);a.records[i].splice(n,r),a.options.data[i].splice(n,r)}if(a.options.footers)for(i=0;i<a.options.footers.length;i++)a.options.footers[i].splice(n,r)}else{for(a.options.columns=_n.injectArray(a.options.columns,n,t.columns),a.headers=_n.injectArray(a.headers,n,t.headers),a.colgroup=_n.injectArray(a.colgroup,n,t.colgroup),r=0,o=n;o<t.numOfColumns+n;o++)a.headerContainer.insertBefore(t.headers[r],a.headerContainer.children[o+1]),a.colgroupContainer.insertBefore(t.colgroup[r],a.colgroupContainer.children[o+1]),r++;for(i=0;i<t.data.length;i++)for(a.options.data[i]=_n.injectArray(a.options.data[i],n,t.data[i]),a.records[i]=_n.injectArray(a.records[i],n,t.records[i]),r=0,o=n;o<t.numOfColumns+n;o++)a.rows[i].insertBefore(t.records[i][r],a.rows[i].children[o+1]),r++;if(a.options.footers)for(i=0;i<a.options.footers.length;i++)a.options.footers[i]=_n.injectArray(a.options.footers[i],n,t.footers[i])}if(a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(i=0;i<a.options.nestedHeaders.length;i++)n=1==e?parseInt(a.options.nestedHeaders[i][a.options.nestedHeaders[i].length-1].colspan)-t.numOfColumns:parseInt(a.options.nestedHeaders[i][a.options.nestedHeaders[i].length-1].colspan)+t.numOfColumns,a.options.nestedHeaders[i][a.options.nestedHeaders[i].length-1].colspan=n,a.thead.children[i].children[a.thead.children[i].children.length-1].setAttribute("colspan",n);else n=1==e?parseInt(a.options.nestedHeaders[0].colspan)-t.numOfColumns:parseInt(a.options.nestedHeaders[0].colspan)+t.numOfColumns,a.options.nestedHeaders[0].colspan=n,a.thead.children[0].children[a.thead.children[0].children.length-1].setAttribute("colspan",n);a.updateTableReferences()},a.undo=function(){var e=!!a.ignoreEvents,t=!!a.ignoreHistory;a.ignoreEvents=!0,a.ignoreHistory=!0;var n=[];if(0<=a.historyIndex){var r=a.history[a.historyIndex--];if("insertRow"==r.action)a.historyProcessRow(1,r);else if("deleteRow"==r.action)a.historyProcessRow(0,r);else if("insertColumn"==r.action)a.historyProcessColumn(1,r);else if("deleteColumn"==r.action)a.historyProcessColumn(0,r);else if("moveRow"==r.action)a.moveRow(r.newValue,r.oldValue);else if("moveColumn"==r.action)a.moveColumn(r.newValue,r.oldValue);else if("setMerge"==r.action)a.removeMerge(r.column,r.data);else if("setStyle"==r.action)a.setStyle(r.oldValue,null,null,1);else if("setWidth"==r.action)a.setWidth(r.column,r.oldValue);else if("setHeight"==r.action)a.setHeight(r.row,r.oldValue);else if("setHeader"==r.action)a.setHeader(r.column,r.oldValue);else if("setComments"==r.action)a.setComments(r.column,r.oldValue[0],r.oldValue[1]);else if("orderBy"==r.action){n=[];for(var o=0;o<r.rows.length;o++)n[r.rows[o]]=o;a.updateOrderArrow(r.column,r.order?0:1),a.updateOrder(n)}else if("setValue"==r.action){for(o=0;o<r.records.length;o++)n.push({x:r.records[o].x,y:r.records[o].y,newValue:r.records[o].oldValue}),r.oldStyle&&a.resetStyle(r.oldStyle);a.setValue(n),r.selection&&a.updateSelectionFromCoords(r.selection[0],r.selection[1],r.selection[2],r.selection[3])}}a.ignoreEvents=e,a.ignoreHistory=t,a.dispatch("onundo",q,r)},a.redo=function(){var e=!!a.ignoreEvents,t=!!a.ignoreHistory;if(a.ignoreEvents=!0,a.ignoreHistory=!0,a.historyIndex<a.history.length-1){var n=a.history[++a.historyIndex];if("insertRow"==n.action)a.historyProcessRow(0,n);else if("deleteRow"==n.action)a.historyProcessRow(1,n);else if("insertColumn"==n.action)a.historyProcessColumn(0,n);else if("deleteColumn"==n.action)a.historyProcessColumn(1,n);else if("moveRow"==n.action)a.moveRow(n.oldValue,n.newValue);else if("moveColumn"==n.action)a.moveColumn(n.oldValue,n.newValue);else if("setMerge"==n.action)a.setMerge(n.column,n.colspan,n.rowspan,1);else if("setStyle"==n.action)a.setStyle(n.newValue,null,null,1);else if("setWidth"==n.action)a.setWidth(n.column,n.newValue);else if("setHeight"==n.action)a.setHeight(n.row,n.newValue);else if("setHeader"==n.action)a.setHeader(n.column,n.newValue);else if("setComments"==n.action)a.setComments(n.column,n.newValue[0],n.newValue[1]);else if("orderBy"==n.action)a.updateOrderArrow(n.column,n.order),a.updateOrder(n.rows);else if("setValue"==n.action){a.setValue(n.records);for(var r=0;r<n.records.length;r++)n.oldStyle&&a.resetStyle(n.newStyle);n.selection&&a.updateSelectionFromCoords(n.selection[0],n.selection[1],n.selection[2],n.selection[3])}}a.ignoreEvents=e,a.ignoreHistory=t,a.dispatch("onredo",q,n)},a.getDropDownValue=function(e,t){var n=[];if(a.options.columns[e]&&a.options.columns[e].source){for(var r=[],o=a.options.columns[e].source,i=0;i<o.length;i++)"object"==typeof o[i]?r[o[i].id]=o[i].name:r[o[i]]=o[i];for(o=Array.isArray(t)?t:(""+t).split(";"),i=0;i<o.length;i++)"object"===typeof o[i]?n.push(r[o[i].id]):r[o[i]]&&n.push(r[o[i]])}else console.error("Invalid column");return 0<n.length?n.join("; "):""},a.parseCSV=function(e,t){9==(e=e.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(e.length-1)&&(e+="\0"),t=t||",";for(var n=[],r=!1,a=0,o=0,i=0;i<e.length;i++){var l=e[i],s=e[i+1];n[a]=n[a]||[],n[a][o]=n[a][o]||"",'"'==l&&r&&'"'==s?(n[a][o]+=l,++i):'"'==l?r=!r:l!=t||r?"\r"!=l||"\n"!=s||r?"\n"==l&&!r||"\r"==l&&!r?(++a,o=0):n[a][o]+=l:(++a,o=0,++i):++o}return n},a.hash=function(e){var t,n=0;if(0!==e.length)for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},a.onafterchanges=function(e,t){a.dispatch("onafterchanges",e,t)},a.destroy=function(){_n.destroy(q)},a.init=function(){_n.current=a,"function"==typeof _n.build&&(a.options.root?_n.build(a.options.root):(_n.build(document),_n.build=null)),q.setAttribute("tabindex",1),q.addEventListener("focus",(function(e){_n.current&&!a.selectedCell&&(a.updateSelectionFromCoords(0,0,0,0),a.left())})),a.options.csv?(1==a.options.loadingSpin&&r.loading.show(),r.ajax({url:a.options.csv,method:a.options.method,data:a.options.requestVariables,dataType:"text",success:function(e){if(e=a.parseCSV(e,a.options.csvDelimiter),1==a.options.csvHeaders&&0<e.length)for(var t=e.shift(),n=0;n<t.length;n++)a.options.columns[n]||(a.options.columns[n]={type:"text",align:a.options.defaultColAlign,width:a.options.defaultColWidth}),"undefined"===typeof a.options.columns[n].title&&(a.options.columns[n].title=t[n]);a.options.data=e,a.prepareTable(),1==a.options.loadingSpin&&r.loading.hide()}})):a.options.url?(1==a.options.loadingSpin&&r.loading.show(),r.ajax({url:a.options.url,method:a.options.method,data:a.options.requestVariables,dataType:"json",success:function(e){a.options.data=e.data?e.data:e,a.prepareTable(),1==a.options.loadingSpin&&r.loading.hide()}})):a.prepareTable()},a.options.contextMenu=y&&null!=y.contextMenu?y.contextMenu:function(e,t,n,r){if(e=[],null==n)1==a.options.allowInsertColumn&&e.push({title:a.options.text.insertANewColumnBefore,onclick:function(){a.insertColumn(1,parseInt(t),1)}}),1==a.options.allowInsertColumn&&e.push({title:a.options.text.insertANewColumnAfter,onclick:function(){a.insertColumn(1,parseInt(t),0)}}),1==a.options.allowDeleteColumn&&e.push({title:a.options.text.deleteSelectedColumns,onclick:function(){a.deleteColumn(a.getSelectedColumns().length?void 0:parseInt(t))}}),1==a.options.allowRenameColumn&&e.push({title:a.options.text.renameThisColumn,onclick:function(){a.setHeader(t)}}),1==a.options.columnSorting&&(e.push({type:"line"}),e.push({title:a.options.text.orderAscending,onclick:function(){a.orderBy(t,0)}}),e.push({title:a.options.text.orderDescending,onclick:function(){a.orderBy(t,1)}}));else if(1==a.options.allowInsertRow&&(e.push({title:a.options.text.insertANewRowBefore,onclick:function(){a.insertRow(1,parseInt(n),1)}}),e.push({title:a.options.text.insertANewRowAfter,onclick:function(){a.insertRow(1,parseInt(n))}})),1==a.options.allowDeleteRow&&e.push({title:a.options.text.deleteSelectedRows,onclick:function(){a.deleteRow(a.getSelectedRows().length?void 0:parseInt(n))}}),t&&1==a.options.allowComments){e.push({type:"line"});var o=a.records[n][t].getAttribute("title")||"";e.push({title:o?a.options.text.editComments:a.options.text.addComments,onclick:function(){var e=prompt(a.options.text.comments,o);e&&a.setComments([t,n],e)}}),o&&e.push({title:a.options.text.clearComments,onclick:function(){a.setComments([t,n],"")}})}return e.push({type:"line"}),e.push({title:a.options.text.copy,shortcut:"Ctrl + C",onclick:function(){a.copy(!0)}}),navigator&&navigator.clipboard&&e.push({title:a.options.text.paste,shortcut:"Ctrl + V",onclick:function(){a.selectedCell&&navigator.clipboard.readText().then((function(e){e&&_n.current.paste(a.selectedCell[0],a.selectedCell[1],e)}))}}),a.options.allowExport&&e.push({title:a.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){a.download()}}),a.options.about&&e.push({title:a.options.text.about,onclick:function(){!0===a.options.about?alert(k().print()):alert(a.options.about)}}),e},a.scrollControls=function(e){a.wheelControls(),0<a.options.freezeColumns&&a.content.scrollLeft!=f&&a.updateFreezePosition(),(1==a.options.lazyLoading||1==a.options.tableOverflow)&&a.edition&&"jdropdown"!=e.target.className.substr(0,9)&&a.closeEditor(a.edition[0],!0)},a.wheelControls=function(e){1==a.options.lazyLoading&&null==_n.timeControlLoading&&(_n.timeControlLoading=setTimeout((function(){a.content.scrollTop+a.content.clientHeight>=a.content.scrollHeight-10?a.loadDown()&&(a.content.scrollTop+a.content.clientHeight>a.content.scrollHeight-10&&(a.content.scrollTop-=a.content.clientHeight),a.updateCornerPosition()):a.content.scrollTop<=a.content.clientHeight&&a.loadUp()&&(10>a.content.scrollTop&&(a.content.scrollTop+=a.content.clientHeight),a.updateCornerPosition()),_n.timeControlLoading=null}),100))},a.getFreezeWidth=function(){var e=0;if(0<a.options.freezeColumns)for(var t=0;t<a.options.freezeColumns;t++)e+=parseInt(a.options.columns[t].width);return e};var f=0;return a.updateFreezePosition=function(){var e=0;if(50<(f=a.content.scrollLeft))for(var t=0;t<a.options.freezeColumns;t++){0<t&&(e+=parseInt(a.options.columns[t-1].width)),a.headers[t].classList.add("jexcel_freezed"),a.headers[t].style.left=e+"px";for(var n=0;n<a.rows.length;n++)if(a.rows[n]&&a.records[n][t]){var r=f+(0<t?a.records[n][t-1].style.width:0)-51+"px";a.records[n][t].classList.add("jexcel_freezed"),a.records[n][t].style.left=r}}else for(t=0;t<a.options.freezeColumns;t++)for(a.headers[t].classList.remove("jexcel_freezed"),a.headers[t].style.left="",n=0;n<a.rows.length;n++)a.records[n][t]&&(a.records[n][t].classList.remove("jexcel_freezed"),a.records[n][t].style.left="");a.updateCornerPosition()},q.addEventListener("DOMMouseScroll",a.wheelControls),q.addEventListener("mousewheel",a.wheelControls),q.jexcel=a,q.jspreadsheet=a,a.init(),a},q;return _n.setDictionary=function(e){r.setDictionary(e)},_n.setExtensions=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)"function"===typeof e[t[n]]&&(_n[t[n]]=e[t[n]],_n.license&&"function"==typeof e[t[n]].license&&e[t[n]].license(_n.license))},_n.formula=w,_n.version=k,_n.current=null,_n.timeControl=null,_n.timeControlLoading=null,_n.destroy=function(e,t){if(e.jexcel){var n=e.jexcel.options.root?e.jexcel.options.root:document;e.removeEventListener("DOMMouseScroll",e.jexcel.scrollControls),e.removeEventListener("mousewheel",e.jexcel.scrollControls),e.jexcel=null,e.innerHTML="",t&&(n.removeEventListener("mouseup",_n.mouseUpControls),n.removeEventListener("mousedown",_n.mouseDownControls),n.removeEventListener("mousemove",_n.mouseMoveControls),n.removeEventListener("mouseover",_n.mouseOverControls),n.removeEventListener("dblclick",_n.doubleClickControls),n.removeEventListener("paste",_n.pasteControls),n.removeEventListener("contextmenu",_n.contextMenuControls),n.removeEventListener("touchstart",_n.touchStartControls),n.removeEventListener("touchend",_n.touchEndControls),n.removeEventListener("touchcancel",_n.touchEndControls),document.removeEventListener("keydown",_n.keyDownControls),_n=null)}},_n.build=function(e){e.addEventListener("mouseup",_n.mouseUpControls),e.addEventListener("mousedown",_n.mouseDownControls),e.addEventListener("mousemove",_n.mouseMoveControls),e.addEventListener("mouseover",_n.mouseOverControls),e.addEventListener("dblclick",_n.doubleClickControls),e.addEventListener("paste",_n.pasteControls),e.addEventListener("contextmenu",_n.contextMenuControls),e.addEventListener("touchstart",_n.touchStartControls),e.addEventListener("touchend",_n.touchEndControls),e.addEventListener("touchcancel",_n.touchEndControls),e.addEventListener("touchmove",_n.touchEndControls),document.addEventListener("keydown",_n.keyDownControls)},_n.keyDownControls=function(e){if(_n.current){if(_n.current.edition)if(27==e.which)_n.current.edition&&_n.current.closeEditor(_n.current.edition[0],!1),e.preventDefault();else if(13==e.which){if("calendar"==_n.current.options.columns[_n.current.edition[2]].type)_n.current.closeEditor(_n.current.edition[0],!0);else if("dropdown"!=_n.current.options.columns[_n.current.edition[2]].type&&"autocomplete"!=_n.current.options.columns[_n.current.edition[2]].type)if((1==_n.current.options.wordWrap||1==_n.current.options.columns[_n.current.edition[2]].wordWrap||200<_n.current.options.data[_n.current.edition[3]][_n.current.edition[2]].length)&&e.altKey){var t=_n.current.edition[0].children[0],n=_n.current.edition[0].children[0].value,r=t.selectionStart;n=n.slice(0,r)+"\n"+n.slice(r),t.value=n,t.focus(),t.selectionStart=r+1,t.selectionEnd=r+1}else _n.current.edition[0].children[0].blur()}else 9==e.which&&("calendar"==_n.current.options.columns[_n.current.edition[2]].type?_n.current.closeEditor(_n.current.edition[0],!0):_n.current.edition[0].children[0].blur());!_n.current.edition&&_n.current.selectedCell?37==e.which?(_n.current.left(e.shiftKey,e.ctrlKey),e.preventDefault()):39==e.which?(_n.current.right(e.shiftKey,e.ctrlKey),e.preventDefault()):38==e.which?(_n.current.up(e.shiftKey,e.ctrlKey),e.preventDefault()):40==e.which?(_n.current.down(e.shiftKey,e.ctrlKey),e.preventDefault()):36==e.which?(_n.current.first(e.shiftKey,e.ctrlKey),e.preventDefault()):35==e.which?(_n.current.last(e.shiftKey,e.ctrlKey),e.preventDefault()):32==e.which?(1==_n.current.options.editable&&_n.current.setCheckRadioValue(),e.preventDefault()):46==e.which?1==_n.current.options.editable&&(_n.current.selectedRow?1==_n.current.options.allowDeleteRow&&confirm(_n.current.options.text.areYouSureToDeleteTheSelectedRows)&&_n.current.deleteRow():_n.current.selectedHeader?1==_n.current.options.allowDeleteColumn&&confirm(_n.current.options.text.areYouSureToDeleteTheSelectedColumns)&&_n.current.deleteColumn():_n.current.setValue(_n.current.highlighted,"")):13==e.which?(e.shiftKey?_n.current.up():(1==_n.current.options.allowInsertRow&&1==_n.current.options.allowManualInsertRow&&_n.current.selectedCell[1]==_n.current.options.data.length-1&&_n.current.insertRow(),_n.current.down()),e.preventDefault()):9==e.which?(e.shiftKey?_n.current.left():(1==_n.current.options.allowInsertColumn&&1==_n.current.options.allowManualInsertColumn&&_n.current.selectedCell[0]==_n.current.options.data[0].length-1&&_n.current.insertColumn(),_n.current.right()),e.preventDefault()):!e.ctrlKey&&!e.metaKey||e.shiftKey?_n.current.selectedCell&&1==_n.current.options.editable&&(t=_n.current.selectedCell[1],n=_n.current.selectedCell[0],"readonly"!=_n.current.options.columns[n].type)&&(32==e.keyCode?"checkbox"==_n.current.options.columns[n].type||"radio"==_n.current.options.columns[n].type?e.preventDefault():_n.current.openEditor(_n.current.records[t][n],!0):113==e.keyCode?_n.current.openEditor(_n.current.records[t][n],!1):(8==e.keyCode||48<=e.keyCode&&57>=e.keyCode||96<=e.keyCode&&111>=e.keyCode||187<=e.keyCode&&190>=e.keyCode||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&_n.validLetter(String.fromCharCode(e.keyCode)))&&(_n.current.openEditor(_n.current.records[t][n],!0),"calendar"==_n.current.options.columns[n].type&&e.preventDefault())):65==e.which?(_n.current.selectAll(),e.preventDefault()):83==e.which?(_n.current.download(),e.preventDefault()):89==e.which?(_n.current.redo(),e.preventDefault()):90==e.which?(_n.current.undo(),e.preventDefault()):67==e.which?(_n.current.copy(!0),e.preventDefault()):88==e.which?(1==_n.current.options.editable?_n.cutControls():_n.copyControls(),e.preventDefault()):86==e.which&&_n.pasteControls():e.target.classList.contains("jexcel_search")&&(_n.timeControl&&clearTimeout(_n.timeControl),_n.timeControl=setTimeout((function(){_n.current.search(e.target.value)}),200))}},_n.isMouseAction=!1,_n.mouseDownControls=function(e){var t=(e=e||window.event).buttons?e.buttons:e.button?e.button:e.which,n=_n.getElement(e.target);if(n[0]?_n.current!=n[0].jexcel&&(_n.current&&(_n.current.edition&&_n.current.closeEditor(_n.current.edition[0],!0),_n.current.resetSelection()),_n.current=n[0].jexcel):_n.current&&(_n.current.edition&&_n.current.closeEditor(_n.current.edition[0],!0),_n.current.resetSelection(!0),_n.current=null),_n.current&&1==t){if(e.target.classList.contains("jexcel_selectall"))_n.current&&_n.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))1==_n.current.options.editable&&(_n.current.selectedCorner=!0);else{if(1==n[1]){var r=e.target.getAttribute("data-x");if(r)if(t=e.target.getBoundingClientRect(),1==_n.current.options.columnResize&&6>t.width-e.offsetX)for(_n.current.resizing={mousePosition:e.pageX,column:r,width:t.width},_n.current.headers[r].classList.add("resizing"),t=0;t<_n.current.records.length;t++)_n.current.records[t][r]&&_n.current.records[t][r].classList.add("resizing");else if(1==_n.current.options.columnDrag&&6>t.height-e.offsetY)if(_n.current.isColMerged(r).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(_n.current.resetSelection(),_n.current.dragging={element:e.target,column:r,destination:r},_n.current.headers[r].classList.add("dragging"),t=0;t<_n.current.records.length;t++)_n.current.records[t][r]&&_n.current.records[t][r].classList.add("dragging");else{if(_n.current.selectedHeader&&(e.shiftKey||e.ctrlKey)){t=_n.current.selectedHeader;var a=r}else _n.current.selectedHeader==r&&1==_n.current.options.allowRenameColumn&&(_n.timeControl=setTimeout((function(){_n.current.setHeader(r)}),800)),a=t=_n.current.selectedHeader=r;_n.current.updateSelectionFromCoords(t,0,a,_n.current.options.data.length-1)}else e.target.parentNode.classList.contains("jexcel_nested")&&(e.target.getAttribute("data-column")?(a=e.target.getAttribute("data-column").split(","),t=parseInt(a[0]),a=parseInt(a[a.length-1])):(t=0,a=_n.current.options.columns.length-1),_n.current.updateSelectionFromCoords(t,0,a,_n.current.options.data.length-1))}else _n.current.selectedHeader=!1;2==n[1]?(n=e.target.getAttribute("data-y"),e.target.classList.contains("jexcel_row")?(t=e.target.getBoundingClientRect(),1==_n.current.options.rowResize&&6>t.height-e.offsetY?(_n.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:n,height:t.height},e.target.parentNode.classList.add("resizing")):1==_n.current.options.rowDrag&&6>t.width-e.offsetX?_n.current.isRowMerged(n).length?console.error("Jspreadsheet: This row is part of a merged cell"):1==_n.current.options.search&&_n.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(_n.current.resetSelection(),_n.current.dragging={element:e.target.parentNode,row:n,destination:n},e.target.parentNode.classList.add("dragging")):(t=_n.current.selectedRow&&(e.shiftKey||e.ctrlKey)?_n.current.selectedRow:_n.current.selectedRow=n,_n.current.updateSelectionFromCoords(0,t,_n.current.options.data[0].length-1,n))):e.target.classList.contains("jclose")&&50>e.target.clientWidth-e.offsetX&&50>e.offsetY?_n.current.closeEditor(_n.current.edition[0],!0):(n=function e(t){var n=t.getAttribute("data-x"),r=t.getAttribute("data-y");return n&&r?[n,r]:t.parentNode?e(t.parentNode):void 0}(e.target))&&(r=n[0],n=n[1],_n.current.edition&&(_n.current.edition[2]!=r||_n.current.edition[3]!=n)&&_n.current.closeEditor(_n.current.edition[0],!0),_n.current.edition||(e.shiftKey?_n.current.updateSelectionFromCoords(_n.current.selectedCell[0],_n.current.selectedCell[1],r,n):_n.current.updateSelectionFromCoords(r,n)),_n.current.selectedHeader=null,_n.current.selectedRow=null)):_n.current.selectedRow=!1,e.target.classList.contains("jexcel_page")&&("<"==e.target.innerText?_n.current.page(0):">"==e.target.innerText?_n.current.page(e.target.getAttribute("title")-1):_n.current.page(e.target.innerText-1))}_n.isMouseAction=!_n.current.edition}else _n.isMouseAction=!1},_n.mouseUpControls=function(e){if(_n.current)if(_n.current.resizing){if(_n.current.resizing.column){e=_n.current.colgroup[_n.current.resizing.column].getAttribute("width");var t=_n.current.getSelectedColumns();if(1<t.length){for(var n=[],r=0;r<t.length;r++)n.push(parseInt(_n.current.colgroup[t[r]].getAttribute("width")));n[r=t.indexOf(parseInt(_n.current.resizing.column))]=_n.current.resizing.width,_n.current.setWidth(t,e,n)}else _n.current.setWidth(_n.current.resizing.column,e,_n.current.resizing.width);for(_n.current.headers[_n.current.resizing.column].classList.remove("resizing"),t=0;t<_n.current.records.length;t++)_n.current.records[t][_n.current.resizing.column]&&_n.current.records[t][_n.current.resizing.column].classList.remove("resizing")}else _n.current.rows[_n.current.resizing.row].children[0].classList.remove("resizing"),e=_n.current.rows[_n.current.resizing.row].getAttribute("height"),_n.current.setHeight(_n.current.resizing.row,e,_n.current.resizing.height),_n.current.resizing.element.classList.remove("resizing");_n.current.resizing=null}else if(_n.current.dragging){if(_n.current.dragging){if(_n.current.dragging.column){for(e=e.target.getAttribute("data-x"),_n.current.headers[_n.current.dragging.column].classList.remove("dragging"),t=0;t<_n.current.rows.length;t++)_n.current.records[t][_n.current.dragging.column]&&_n.current.records[t][_n.current.dragging.column].classList.remove("dragging");for(r=0;r<_n.current.headers.length;r++)_n.current.headers[r].classList.remove("dragging-left"),_n.current.headers[r].classList.remove("dragging-right");e&&_n.current.dragging.column!=_n.current.dragging.destination&&_n.current.moveColumn(_n.current.dragging.column,_n.current.dragging.destination)}else _n.current.dragging.element.nextSibling?(e=parseInt(_n.current.dragging.element.nextSibling.getAttribute("data-y")),_n.current.dragging.row<e&&--e):e=parseInt(_n.current.dragging.element.previousSibling.getAttribute("data-y")),_n.current.dragging.row!=_n.current.dragging.destination&&_n.current.moveRow(_n.current.dragging.row,e,!0),_n.current.dragging.element.classList.remove("dragging");_n.current.dragging=null}}else _n.current.selectedCorner&&(_n.current.selectedCorner=!1,0<_n.current.selection.length&&(_n.current.copyData(_n.current.selection[0],_n.current.selection[_n.current.selection.length-1]),_n.current.removeCopySelection()));_n.timeControl&&(clearTimeout(_n.timeControl),_n.timeControl=null),_n.isMouseAction=!1},_n.mouseMoveControls=function(e){if((e=e||window.event).buttons||e.button||e.which||(_n.isMouseAction=!1),_n.current)if(1==_n.isMouseAction)_n.current.resizing&&(_n.current.resizing.column?(e=e.pageX-_n.current.resizing.mousePosition,0<_n.current.resizing.width+e&&(_n.current.colgroup[_n.current.resizing.column].setAttribute("width",_n.current.resizing.width+e),_n.current.updateCornerPosition())):(e=e.pageY-_n.current.resizing.mousePosition,0<_n.current.resizing.height+e&&(_n.current.rows[_n.current.resizing.row].setAttribute("height",_n.current.resizing.height+e),_n.current.updateCornerPosition())));else{var t=e.target.getAttribute("data-x"),n=e.target.getAttribute("data-y"),r=e.target.getBoundingClientRect();_n.current.cursor&&(_n.current.cursor.style.cursor="",_n.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&t&&!n&&6>r.width-(e.clientX-r.left)?(_n.current.cursor=e.target,_n.current.cursor.style.cursor="col-resize"):e.target&&!t&&n&&6>r.height-(e.clientY-r.top)&&(_n.current.cursor=e.target,_n.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!t&&n&&6>r.width-(e.clientX-r.left)||e.target&&t&&!n&&6>r.height-(e.clientY-r.top))&&(_n.current.cursor=e.target,_n.current.cursor.style.cursor="move"))}},_n.mouseOverControls=function(e){if((e=e||window.event).buttons||e.button||e.which||(_n.isMouseAction=!1),_n.current&&1==_n.isMouseAction){var t=_n.getElement(e.target);if(t[0]){if(_n.current!=t[0].jexcel&&_n.current)return!1;var n=e.target.getAttribute("data-x"),r=e.target.getAttribute("data-y");if(_n.current.dragging)if(_n.current.dragging.column){if(n)if(_n.current.isColMerged(n).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(t=0;t<_n.current.headers.length;t++)_n.current.headers[t].classList.remove("dragging-left"),_n.current.headers[t].classList.remove("dragging-right");_n.current.dragging.column==n?_n.current.dragging.destination=parseInt(n):e.target.clientWidth/2>e.offsetX?(_n.current.dragging.destination=_n.current.dragging.column<n?parseInt(n)-1:parseInt(n),_n.current.headers[n].classList.add("dragging-left")):(_n.current.dragging.destination=_n.current.dragging.column<n?parseInt(n):parseInt(n)+1,_n.current.headers[n].classList.add("dragging-right"))}}else r&&(_n.current.isRowMerged(r).length?console.error("Jspreadsheet: This row is part of a merged cell."):(n=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode,_n.current.dragging.element!=n&&(e.target.parentNode.parentNode.insertBefore(_n.current.dragging.element,n),_n.current.dragging.destination=Array.prototype.indexOf.call(_n.current.dragging.element.parentNode.children,_n.current.dragging.element))));else if(!_n.current.resizing){if(1==t[1]&&_n.current.selectedHeader){n=e.target.getAttribute("data-x");var a=_n.current.selectedHeader;_n.current.updateSelectionFromCoords(a,0,n,_n.current.options.data.length-1)}2==t[1]&&(e.target.classList.contains("jexcel_row")?_n.current.selectedRow&&(a=_n.current.selectedRow,_n.current.updateSelectionFromCoords(0,a,_n.current.options.data[0].length-1,r)):_n.current.edition||n&&r&&(_n.current.selectedCorner?_n.current.updateCopySelection(n,r):_n.current.selectedCell&&_n.current.updateSelectionFromCoords(_n.current.selectedCell[0],_n.current.selectedCell[1],n,r)))}}}_n.timeControl&&(clearTimeout(_n.timeControl),_n.timeControl=null)},_n.doubleClickControls=function(e){if(_n.current)if(e.target.classList.contains("jexcel_corner")){if(0<_n.current.highlighted.length){e=_n.current.highlighted[0].getAttribute("data-x");var t=parseInt(_n.current.highlighted[_n.current.highlighted.length-1].getAttribute("data-y"))+1,n=_n.current.highlighted[_n.current.highlighted.length-1].getAttribute("data-x");_n.current.copyData(_n.current.records[t][e],_n.current.records[_n.current.records.length-1][n])}}else e.target.classList.contains("jexcel_column_filter")?(t=e.target.getAttribute("data-x"),_n.current.openFilter(t)):(1==(n=_n.getElement(e.target))[1]&&1==_n.current.options.columnSorting&&(t=e.target.getAttribute("data-x"))&&_n.current.orderBy(t),2!=n[1]||1!=_n.current.options.editable||_n.current.edition||(e=function e(t){if(t.parentNode){var n=t.getAttribute("data-x"),r=t.getAttribute("data-y");return n&&r?t:e(t.parentNode)}}(e.target))&&e.classList.contains("highlight")&&_n.current.openEditor(e))},_n.copyControls=function(e){_n.current&&_n.copyControls.enabled&&(_n.current.edition||_n.current.copy(!0))},_n.cutControls=function(e){_n.current&&!_n.current.edition&&(_n.current.copy(!0),1==_n.current.options.editable&&_n.current.setValue(_n.current.highlighted,""))},_n.pasteControls=function(e){_n.current&&_n.current.selectedCell&&!_n.current.edition&&1==_n.current.options.editable&&(e&&e.clipboardData?(_n.current.paste(_n.current.selectedCell[0],_n.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&_n.current.paste(_n.current.selectedCell[0],_n.current.selectedCell[1],window.clipboardData.getData("text")))},_n.contextMenuControls=function(e){if(e=e||window.event,_n.current)if(_n.current.edition)e.preventDefault();else if(_n.current.options.contextMenu&&(_n.current.contextMenu.contextmenu.close(),_n.current)){var t=e.target.getAttribute("data-x"),n=e.target.getAttribute("data-y");(t||n)&&((t<parseInt(_n.current.selectedCell[0])||t>parseInt(_n.current.selectedCell[2])||n<parseInt(_n.current.selectedCell[1])||n>parseInt(_n.current.selectedCell[3]))&&_n.current.updateSelectionFromCoords(t,n,t,n),t=_n.current.options.contextMenu(_n.current,t,n,e),_n.current.contextMenu.contextmenu.open(e,t),e.preventDefault())}},_n.touchStartControls=function(e){var t=_n.getElement(e.target);if(t[0]?_n.current!=t[0].jexcel&&(_n.current&&_n.current.resetSelection(),_n.current=t[0].jexcel):_n.current&&(_n.current.resetSelection(),_n.current=null),_n.current&&!_n.current.edition){var n=e.target.getAttribute("data-x");t=e.target.getAttribute("data-y"),n&&t&&(_n.current.updateSelectionFromCoords(n,t),_n.timeControl=setTimeout((function(){_n.tmpElement="color"==_n.current.options.columns[n].type?null:e.target,_n.current.openEditor(e.target,!1,e)}),500))}},_n.touchEndControls=function(e){_n.timeControl&&(clearTimeout(_n.timeControl),_n.timeControl=null,_n.tmpElement&&"INPUT"==_n.tmpElement.children[0].tagName&&_n.tmpElement.children[0].focus(),_n.tmpElement=null)},_n.tabs=function(e,t){var n=[];if(e.classList.contains("jexcel_tabs"))a=e.children[0],o=e.children[1];else{e.innerHTML="",e.classList.add("jexcel_tabs"),e.jexcel=[];var r=document.createElement("div"),a=e.appendChild(r);r=document.createElement("div");var o=e.appendChild(r)}r=[];for(var i=[],l=0;l<t.length;l++){r[l]=document.createElement("div"),r[l].classList.add("jexcel_tab");var s=_n(r[l],t[l]);o.appendChild(r[l]),n[l]=e.jexcel.push(s),i[l]=document.createElement("div"),i[l].classList.add("jexcel_tab_link"),i[l].setAttribute("data-spreadsheet",e.jexcel.length-1),i[l].innerHTML=t[l].sheetName,i[l].onclick=function(){for(var e=0;e<a.children.length;e++)a.children[e].classList.remove("selected"),o.children[e].style.display="none";e=this.getAttribute("data-spreadsheet"),o.children[e].style.display="block",a.children[e].classList.add("selected")},a.appendChild(i[l])}for(r=0;r<a.children.length;r++)a.children[r].classList.remove("selected"),o.children[r].style.display="none";return a.children[a.children.length-1].classList.add("selected"),o.children[a.children.length-1].style.display="block",n},_n.createTabs=_n.tabs,_n.fromSpreadsheet=function(e,t){var n=function(e){var t=[];return e.SheetNames.forEach((function(n){var r={rows:[],columns:[],data:[],style:{}};r.sheetName=n;var a=e.Sheets[n]["!cols"];if(a&&a.length)for(var o=0;o<a.length;o++)r.columns[o]={},a[o]&&a[o].wpx&&(r.columns[o].width=a[o].wpx+"px");if((a=e.Sheets[n]["!rows"])&&a.length)for(o=0;o<a.length;o++)a[o]&&a[o].hpx&&(r.rows[o]={},r.rows[o].height=a[o].hpx+"px");if((a=e.Sheets[n]["!merges"])&&0<a.length)for(r.mergeCells=[],o=0;o<a.length;o++){var i=a[o].s.c,l=a[o].s.r,s=a[o].e.c,u=a[o].e.r,c=_n.getColumnNameFromId([i,l]);r.mergeCells[c]=[s-i+1,u-l+1]}for(l=i=0,a=Object.keys(e.Sheets[n]),o=0;o<a.length;o++)"!"!=a[o].substr(0,1)&&(s=e.Sheets[n][a[o]],u=_n.getIdFromColumnName(a[o],!0),r.data[u[1]]||(r.data[u[1]]=[]),r.data[u[1]][u[0]]=s.f?"="+s.f:s.w,i<u[0]&&(i=u[0]),l<u[1]&&(l=u[1]),s.style&&0<Object.keys(s.style).length&&(r.style[a[o]]=s.style),s.s&&s.s.fgColor&&(r.style[a[o]]&&(r.style[a[o]]+=";"),r.style[a[o]]+="background-color:#"+s.s.fgColor.rgb));for(n=r.columns,a=0;a<=l;a++)for(o=0;o<=i;o++)r.data[a]||(r.data[a]=[]),r.data[a][o]||n<o&&(r.data[a][o]="");t.push(r)})),t},r=new XMLHttpRequest;r.open("GET",e,!0),"undefined"!==typeof Uint8Array?(r.responseType="arraybuffer",r.onload=function(e){e=new Uint8Array(r.response),e=XLSX.read(e,{type:"array",cellFormula:!0,cellStyles:!0}),t(n(e))}):(r.setRequestHeader("Accept-Charset","x-user-defined"),r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var e=convertResponseBodyToText(r.responseBody);e=XLSX.read(e,{type:"binary",cellFormula:!0,cellStyles:!0}),t(n(e))}}),r.send()},_n.validLetter=function(e){return e.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},_n.injectArray=function(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))},_n.getColumnName=function(e){var t="";return 701<e?(t+=String.fromCharCode(64+parseInt(e/676)),t+=String.fromCharCode(64+parseInt(e%676/26))):25<e&&(t+=String.fromCharCode(64+parseInt(e/26))),t+String.fromCharCode(65+e%26)},_n.getIdFromColumnName=function(e,t){var n=/^[a-zA-Z]+/.exec(e);if(n){for(var r=0,a=0;a<n[0].length;a++)r+=parseInt(n[0].charCodeAt(a)-64)*Math.pow(26,n[0].length-1-a);0>--r&&(r=0),0<(n=parseInt(/[0-9]+$/.exec(e)))&&n--,e=1==t?[r,n]:r+"-"+n}return e},_n.getColumnNameFromId=function(e){return Array.isArray(e)||(e=e.split("-")),_n.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)},_n.getElement=function(e){var t=0,n=0;return function e(r){r.className&&r.classList.contains("jexcel_container")&&(n=r),"THEAD"==r.tagName?t=1:"TBODY"==r.tagName&&(t=2),r.parentNode&&(n||e(r.parentNode))}(e),[n,t]},_n.doubleDigitFormat=function(e){return 1==(e=""+e).length&&(e="0"+e),e},_n.createFromTable=function(e,t){if("TABLE"==e.tagName){t||(t={}),t.columns=[],t.data=[];var n=e.querySelectorAll("colgroup > col");if(n.length)for(var r=0;r<n.length;r++){var a=n[r].style.width;a||(a=n[r].getAttribute("width")),a&&(t.columns[r]||(t.columns[r]={}),t.columns[r].width=a)}a=function(e){var n=e.getBoundingClientRect();n=50<n.width?n.width:50,t.columns[r]||(t.columns[r]={}),e.getAttribute("data-celltype")?t.columns[r].type=e.getAttribute("data-celltype"):t.columns[r].type="text",t.columns[r].width=n+"px",t.columns[r].title=e.innerHTML,t.columns[r].align=e.style.textAlign||"center",(n=e.getAttribute("name"))&&(t.columns[r].name=n),(n=e.getAttribute("id"))&&(t.columns[r].id=n)};var o=[],i=e.querySelectorAll(":scope > thead > tr");if(i.length){for(n=0;n<i.length-1;n++){var l=[];for(r=0;r<i[n].children.length;r++){var s={title:i[n].children[r].innerText,colspan:i[n].children[r].getAttribute("colspan")||1};l.push(s)}o.push(l)}for(i=i[i.length-1].children,r=0;r<i.length;r++)a(i[r])}s=0;var u={},c={},d={},p={};for(l=e.querySelectorAll(":scope > tr, :scope > tbody > tr"),n=0;n<l.length;n++)if(t.data[s]=[],1!=t.parseTableFirstRowAsHeader||i.length||0!=n){for(r=0;r<l[n].children.length;r++){var f=l[n].children[r].getAttribute("data-formula");f?"="!=f.substr(0,1)&&(f="="+f):f=l[n].children[r].innerHTML,t.data[s].push(f),f=_n.getColumnNameFromId([r,n]);var h=l[n].children[r].getAttribute("class");h&&(p[f]=h),h=parseInt(l[n].children[r].getAttribute("colspan"))||0;var m=parseInt(l[n].children[r].getAttribute("rowspan"))||0;(h||m)&&(u[f]=[h||1,m||1]),(h=l[n].children[r].style&&"none"==l[n].children[r].style.display)&&(l[n].children[r].style.display=""),(h=l[n].children[r].getAttribute("style"))&&(d[f]=h),l[n].children[r].classList.contains("styleBold")&&(d[f]=d[f]?d[f]+"; font-weight:bold;":"font-weight:bold;")}l[n].style&&l[n].style.height&&(c[n]={height:l[n].style.height}),s++}else for(r=0;r<l[n].children.length;r++)a(l[n].children[r]);if(0<Object.keys(o).length&&(t.nestedHeaders=o),0<Object.keys(d).length&&(t.style=d),0<Object.keys(u).length&&(t.mergeCells=u),0<Object.keys(c).length&&(t.rows=c),0<Object.keys(p).length&&(t.classes=p),(l=e.querySelectorAll("tfoot tr")).length){for(a=[],n=0;n<l.length;n++){for(o=[],r=0;r<l[n].children.length;r++)o.push(l[n].children[r].innerText);a.push(o)}0<Object.keys(a).length&&(t.footers=a)}if(1==t.parseTableAutoCellType)for(a=[],r=0;r<t.columns.length;r++){for(i=o=!0,a[r]=[],n=0;n<t.data.length;n++)f=t.data[n][r],a[r][f]||(a[r][f]=0),a[r][f]++,25<f.length&&(o=!1),10==f.length&&"-"==f.substr(4,1)&&"-"==f.substr(7,1)||(i=!1);n=Object.keys(a[r]).length,i?t.columns[r].type="calendar":1==o&&1<n&&n<=parseInt(.1*t.data.length)&&(t.columns[r].type="dropdown",t.columns[r].source=Object.keys(a[r]))}return t}console.log("Element is not a table")},"undefined"!=typeof jQuery&&(q=jQuery,q.fn.jspreadsheet=q.fn.jexcel=function(e){var t=q(this).get(0);return t.jexcel?Array.isArray(t.jexcel)?t.jexcel[e][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):t.jexcel[e].apply(this,Array.prototype.slice.call(arguments,1)):_n(q(this).get(0),arguments[0])}),_n},"object"===typeof U&&"undefined"!==typeof S?S.exports=v():k.jspreadsheet=k.jexcel=v()},{"@jspreadsheet/formula":1,jsuites:2}]},{},[3])(3)},module.exports=T()},function(e,t,n){"use strict";var r=n(2),a=60103,o=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var i=60109,l=60110,s=60112;t.Suspense=60113;var u=60115,c=60116;if("function"===typeof Symbol&&Symbol.for){var d=Symbol.for;a=d("react.element"),o=d("react.portal"),t.Fragment=d("react.fragment"),t.StrictMode=d("react.strict_mode"),t.Profiler=d("react.profiler"),i=d("react.provider"),l=d("react.context"),s=d("react.forward_ref"),t.Suspense=d("react.suspense"),u=d("react.memo"),c=d("react.lazy")}var p="function"===typeof Symbol&&Symbol.iterator;function f(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}function v(){}function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(f(85));this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=g.prototype;var b=y.prototype=new v;b.constructor=y,r(b,g.prototype),b.isPureReactComponent=!0;var w={current:null},C=Object.prototype.hasOwnProperty,E={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,n){var r,o={},i=null,l=null;if(null!=t)for(r in void 0!==t.ref&&(l=t.ref),void 0!==t.key&&(i=""+t.key),t)C.call(t,r)&&!E.hasOwnProperty(r)&&(o[r]=t[r]);var s=arguments.length-2;if(1===s)o.children=n;else if(1<s){for(var u=Array(s),c=0;c<s;c++)u[c]=arguments[c+2];o.children=u}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===o[r]&&(o[r]=s[r]);return{$$typeof:a,type:e,key:i,ref:l,props:o,_owner:w.current}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===a}var N=/\/+/g;function L(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,n,r,i){var l=typeof e;"undefined"!==l&&"boolean"!==l||(e=null);var s=!1;if(null===e)s=!0;else switch(l){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case a:case o:s=!0}}if(s)return i=i(s=e),e=""===r?"."+L(s,0):r,Array.isArray(i)?(n="",null!=e&&(n=e.replace(N,"$&/")+"/"),I(i,t,n,"",(function(e){return e}))):null!=i&&(A(i)&&(i=function(e,t){return{$$typeof:a,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(N,"$&/")+"/")+e)),t.push(i)),1;if(s=0,r=""===r?".":r+":",Array.isArray(e))for(var u=0;u<e.length;u++){var c=r+L(l=e[u],u);s+=I(l,t,n,c,i)}else if("function"===typeof(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e)))for(e=c.call(e),u=0;!(l=e.next()).done;)s+=I(l=l.value,t,n,c=r+L(l,u++),i);else if("object"===l)throw t=""+e,Error(f(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return s}function M(e,t,n){if(null==e)return e;var r=[],a=0;return I(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function k(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var S={current:null};function _(){var e=S.current;if(null===e)throw Error(f(321));return e}var T={ReactCurrentDispatcher:S,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:w,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:M,forEach:function(e,t,n){M(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return M(e,(function(){t++})),t},toArray:function(e){return M(e,(function(e){return e}))||[]},only:function(e){if(!A(e))throw Error(f(143));return e}},t.Component=g,t.PureComponent=y,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error(f(267,e));var o=r({},e.props),i=e.key,l=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(l=t.ref,s=w.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)C.call(t,c)&&!E.hasOwnProperty(c)&&(o[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)o.children=n;else if(1<c){u=Array(c);for(var d=0;d<c;d++)u[d]=arguments[d+2];o.children=u}return{$$typeof:a,type:e.type,key:i,ref:l,props:o,_owner:s}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:l,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:i,_context:e},e.Consumer=e},t.createElement=x,t.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:s,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:c,_payload:{_status:-1,_result:e},_init:k}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return _().useCallback(e,t)},t.useContext=function(e,t){return _().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return _().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return _().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return _().useLayoutEffect(e,t)},t.useMemo=function(e,t){return _().useMemo(e,t)},t.useReducer=function(e,t,n){return _().useReducer(e,t,n)},t.useRef=function(e){return _().useRef(e)},t.useState=function(e){return _().useState(e)},t.version="17.0.2"},function(e,t,n){"use strict";var r=n(1),a=n(2),o=n(7);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(i(227));var l=new Set,s={};function u(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)l.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f=Object.prototype.hasOwnProperty,h={},m={};function g(e,t,n,r,a,o,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){v[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];v[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){v[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){v[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){v[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){v[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){v[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){v[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){v[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function w(e,t,n,r){var a=v.hasOwnProperty(t)?v[t]:null;(null!==a?0===a.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!f.call(m,e)||!f.call(h,e)&&(p.test(e)?m[e]=!0:(h[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,b);v[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,b);v[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,b);v[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){v[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),v.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){v[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var C=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,E=60103,x=60106,A=60107,N=60108,L=60114,I=60109,M=60110,k=60112,S=60113,_=60120,T=60115,D=60116,O=60121,j=60128,R=60129,F=60130,H=60131;if("function"===typeof Symbol&&Symbol.for){var P=Symbol.for;E=P("react.element"),x=P("react.portal"),A=P("react.fragment"),N=P("react.strict_mode"),L=P("react.profiler"),I=P("react.provider"),M=P("react.context"),k=P("react.forward_ref"),S=P("react.suspense"),_=P("react.suspense_list"),T=P("react.memo"),D=P("react.lazy"),O=P("react.block"),P("react.scope"),j=P("react.opaque.id"),R=P("react.debug_trace_mode"),F=P("react.offscreen"),H=P("react.legacy_hidden")}var B,z="function"===typeof Symbol&&Symbol.iterator;function V(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=z&&e[z]||e["@@iterator"])?e:null}function U(e){if(void 0===B)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);B=t&&t[1]||""}return"\n"+B+e}var q=!1;function Y(e,t){if(!e||q)return"";q=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(s){var r=s}Reflect.construct(e,[],t)}else{try{t.call()}catch(s){r=s}e.call(t.prototype)}else{try{throw Error()}catch(s){r=s}e()}}catch(s){if(s&&r&&"string"===typeof s.stack){for(var a=s.stack.split("\n"),o=r.stack.split("\n"),i=a.length-1,l=o.length-1;1<=i&&0<=l&&a[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(a[i]!==o[l]){if(1!==i||1!==l)do{if(i--,0>--l||a[i]!==o[l])return"\n"+a[i].replace(" at new "," at ")}while(1<=i&&0<=l);break}}}finally{q=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function W(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=Y(e.type,!1);case 11:return e=Y(e.type.render,!1);case 22:return e=Y(e.type._render,!1);case 1:return e=Y(e.type,!0);default:return""}}function X(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case A:return"Fragment";case x:return"Portal";case L:return"Profiler";case N:return"StrictMode";case S:return"Suspense";case _:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case M:return(e.displayName||"Context")+".Consumer";case I:return(e._context.displayName||"Context")+".Provider";case k:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case T:return X(e.type);case O:return X(e._render);case D:t=e._payload,e=e._init;try{return X(e(t))}catch(n){}}return null}function G(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function $(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Q(e){e._valueTracker||(e._valueTracker=function(e){var t=$(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=$(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function J(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Z(e,t){var n=t.checked;return a({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function ee(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=G(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&w(e,"checked",t,!1)}function ne(e,t){te(e,t);var n=G(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ae(e,t.type,n):t.hasOwnProperty("defaultValue")&&ae(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function re(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ae(e,t,n){"number"===t&&J(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function oe(e,t){return e=a({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function ie(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+G(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function le(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return a({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:G(n)}}function ue(e,t){var n=G(t.value),r=G(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ce(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var de="http://www.w3.org/1999/xhtml",pe="http://www.w3.org/2000/svg";function fe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function he(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?fe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var me,ge,ve=(ge=function(e,t){if(e.namespaceURI!==pe||"innerHTML"in e)e.innerHTML=t;else{for((me=me||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=me.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ge(e,t)}))}:ge);function ye(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var be={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},we=["Webkit","ms","Moz","O"];function Ce(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||be.hasOwnProperty(e)&&be[e]?(""+t).trim():t+"px"}function Ee(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=Ce(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(be).forEach((function(e){we.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),be[t]=be[e]}))}));var xe=a({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ae(e,t){if(t){if(xe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function Ne(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Le(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ie=null,Me=null,ke=null;function Se(e){if(e=ea(e)){if("function"!==typeof Ie)throw Error(i(280));var t=e.stateNode;t&&(t=na(t),Ie(e.stateNode,e.type,t))}}function _e(e){Me?ke?ke.push(e):ke=[e]:Me=e}function Te(){if(Me){var e=Me,t=ke;if(ke=Me=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function De(e,t){return e(t)}function Oe(e,t,n,r,a){return e(t,n,r,a)}function je(){}var Re=De,Fe=!1,He=!1;function Pe(){null===Me&&null===ke||(je(),Te())}function Be(e,t){var n=e.stateNode;if(null===n)return null;var r=na(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var ze=!1;if(d)try{var Ve={};Object.defineProperty(Ve,"passive",{get:function(){ze=!0}}),window.addEventListener("test",Ve,Ve),window.removeEventListener("test",Ve,Ve)}catch(ge){ze=!1}function Ue(e,t,n,r,a,o,i,l,s){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var qe=!1,Ye=null,We=!1,Xe=null,Ge={onError:function(e){qe=!0,Ye=e}};function $e(e,t,n,r,a,o,i,l,s){qe=!1,Ye=null,Ue.apply(Ge,arguments)}function Qe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ke(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Je(e){if(Qe(e)!==e)throw Error(i(188))}function Ze(e){if(!(e=function(e){var t=e.alternate;if(!t){if(null===(t=Qe(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return Je(a),e;if(o===r)return Je(a),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var l=!1,s=a.child;s;){if(s===n){l=!0,n=a,r=o;break}if(s===r){l=!0,r=a,n=o;break}s=s.sibling}if(!l){for(s=o.child;s;){if(s===n){l=!0,n=o,r=a;break}if(s===r){l=!0,r=o,n=a;break}s=s.sibling}if(!l)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function et(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var tt,nt,rt,at,ot=!1,it=[],lt=null,st=null,ut=null,ct=new Map,dt=new Map,pt=[],ft="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ht(e,t,n,r,a){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:a,targetContainers:[r]}}function mt(e,t){switch(e){case"focusin":case"focusout":lt=null;break;case"dragenter":case"dragleave":st=null;break;case"mouseover":case"mouseout":ut=null;break;case"pointerover":case"pointerout":ct.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":dt.delete(t.pointerId)}}function gt(e,t,n,r,a,o){return null===e||e.nativeEvent!==o?(e=ht(t,n,r,a,o),null!==t&&(null!==(t=ea(t))&&nt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function vt(e){var t=Zr(e.target);if(null!==t){var n=Qe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ke(n)))return e.blockedOn=t,void at(e.lanePriority,(function(){o.unstable_runWithPriority(e.priority,(function(){rt(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function yt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ea(n))&&nt(t),e.blockedOn=n,!1;t.shift()}return!0}function bt(e,t,n){yt(e)&&n.delete(t)}function wt(){for(ot=!1;0<it.length;){var e=it[0];if(null!==e.blockedOn){null!==(e=ea(e.blockedOn))&&tt(e);break}for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&it.shift()}null!==lt&&yt(lt)&&(lt=null),null!==st&&yt(st)&&(st=null),null!==ut&&yt(ut)&&(ut=null),ct.forEach(bt),dt.forEach(bt)}function Ct(e,t){e.blockedOn===t&&(e.blockedOn=null,ot||(ot=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,wt)))}function Et(e){function t(t){return Ct(t,e)}if(0<it.length){Ct(it[0],e);for(var n=1;n<it.length;n++){var r=it[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==lt&&Ct(lt,e),null!==st&&Ct(st,e),null!==ut&&Ct(ut,e),ct.forEach(t),dt.forEach(t),n=0;n<pt.length;n++)(r=pt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<pt.length&&null===(n=pt[0]).blockedOn;)vt(n),null===n.blockedOn&&pt.shift()}function xt(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var At={animationend:xt("Animation","AnimationEnd"),animationiteration:xt("Animation","AnimationIteration"),animationstart:xt("Animation","AnimationStart"),transitionend:xt("Transition","TransitionEnd")},Nt={},Lt={};function It(e){if(Nt[e])return Nt[e];if(!At[e])return e;var t,n=At[e];for(t in n)if(n.hasOwnProperty(t)&&t in Lt)return Nt[e]=n[t];return e}d&&(Lt=document.createElement("div").style,"AnimationEvent"in window||(delete At.animationend.animation,delete At.animationiteration.animation,delete At.animationstart.animation),"TransitionEvent"in window||delete At.transitionend.transition);var Mt=It("animationend"),kt=It("animationiteration"),St=It("animationstart"),_t=It("transitionend"),Tt=new Map,Dt=new Map,Ot=["abort","abort",Mt,"animationEnd",kt,"animationIteration",St,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",_t,"transitionEnd","waiting","waiting"];function jt(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],a=e[n+1];a="on"+(a[0].toUpperCase()+a.slice(1)),Dt.set(r,t),Tt.set(r,a),u(a,[r])}}(0,o.unstable_now)();var Rt=8;function Ft(e){if(0!==(1&e))return Rt=15,1;if(0!==(2&e))return Rt=14,2;if(0!==(4&e))return Rt=13,4;var t=24&e;return 0!==t?(Rt=12,t):0!==(32&e)?(Rt=11,32):0!==(t=192&e)?(Rt=10,t):0!==(256&e)?(Rt=9,256):0!==(t=3584&e)?(Rt=8,t):0!==(4096&e)?(Rt=7,4096):0!==(t=4186112&e)?(Rt=6,t):0!==(t=62914560&e)?(Rt=5,t):67108864&e?(Rt=4,67108864):0!==(134217728&e)?(Rt=3,134217728):0!==(t=805306368&e)?(Rt=2,t):0!==(1073741824&e)?(Rt=1,1073741824):(Rt=8,e)}function Ht(e,t){var n=e.pendingLanes;if(0===n)return Rt=0;var r=0,a=0,o=e.expiredLanes,i=e.suspendedLanes,l=e.pingedLanes;if(0!==o)r=o,a=Rt=15;else if(0!==(o=134217727&n)){var s=o&~i;0!==s?(r=Ft(s),a=Rt):0!==(l&=o)&&(r=Ft(l),a=Rt)}else 0!==(o=n&~i)?(r=Ft(o),a=Rt):0!==l&&(r=Ft(l),a=Rt);if(0===r)return 0;if(r=n&((0>(r=31-qt(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0===(t&i)){if(Ft(t),a<=Rt)return t;Rt=a}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-qt(t)),r|=e[n],t&=~a;return r}function Pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Bt(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=zt(24&~t))?Bt(10,t):e;case 10:return 0===(e=zt(192&~t))?Bt(8,t):e;case 8:return 0===(e=zt(3584&~t))&&(0===(e=zt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=zt(805306368&~t))&&(t=268435456),t}throw Error(i(358,e))}function zt(e){return e&-e}function Vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ut(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-qt(t)]=n}var qt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(Yt(e)/Wt|0)|0},Yt=Math.log,Wt=Math.LN2;var Xt=o.unstable_UserBlockingPriority,Gt=o.unstable_runWithPriority,$t=!0;function Qt(e,t,n,r){Fe||je();var a=Jt,o=Fe;Fe=!0;try{Oe(a,e,t,n,r)}finally{(Fe=o)||Pe()}}function Kt(e,t,n,r){Gt(Xt,Jt.bind(null,e,t,n,r))}function Jt(e,t,n,r){var a;if($t)if((a=0===(4&t))&&0<it.length&&-1<ft.indexOf(e))e=ht(null,e,t,n,r),it.push(e);else{var o=Zt(e,t,n,r);if(null===o)a&&mt(e,r);else{if(a){if(-1<ft.indexOf(e))return e=ht(o,e,t,n,r),void it.push(e);if(function(e,t,n,r,a){switch(t){case"focusin":return lt=gt(lt,e,t,n,r,a),!0;case"dragenter":return st=gt(st,e,t,n,r,a),!0;case"mouseover":return ut=gt(ut,e,t,n,r,a),!0;case"pointerover":var o=a.pointerId;return ct.set(o,gt(ct.get(o)||null,e,t,n,r,a)),!0;case"gotpointercapture":return o=a.pointerId,dt.set(o,gt(dt.get(o)||null,e,t,n,r,a)),!0}return!1}(o,e,t,n,r))return;mt(e,r)}Tr(e,t,r,null,n)}}}function Zt(e,t,n,r){var a=Le(r);if(null!==(a=Zr(a))){var o=Qe(a);if(null===o)a=null;else{var i=o.tag;if(13===i){if(null!==(a=Ke(o)))return a;a=null}else if(3===i){if(o.stateNode.hydrate)return 3===o.tag?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null)}}return Tr(e,t,r,a,n),null}var en=null,tn=null,nn=null;function rn(){if(nn)return nn;var e,t,n=tn,r=n.length,a="value"in en?en.value:en.textContent,o=a.length;for(e=0;e<r&&n[e]===a[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===a[o-t];t++);return nn=a.slice(e,1<t?1-t:void 0)}function an(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function on(){return!0}function ln(){return!1}function sn(e){function t(t,n,r,a,o){for(var i in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(a):a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?on:ln,this.isPropagationStopped=ln,this}return a(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=on)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=on)},persist:function(){},isPersistent:on}),t}var un,cn,dn,pn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fn=sn(pn),hn=a({},pn,{view:0,detail:0}),mn=sn(hn),gn=a({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:In,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==dn&&(dn&&"mousemove"===e.type?(un=e.screenX-dn.screenX,cn=e.screenY-dn.screenY):cn=un=0,dn=e),un)},movementY:function(e){return"movementY"in e?e.movementY:cn}}),vn=sn(gn),yn=sn(a({},gn,{dataTransfer:0})),bn=sn(a({},hn,{relatedTarget:0})),wn=sn(a({},pn,{animationName:0,elapsedTime:0,pseudoElement:0})),Cn=sn(a({},pn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),En=sn(a({},pn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},An={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ln(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Nn[e])&&!!t[e]}function In(){return Ln}var Mn=sn(a({},hn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=an(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?An[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:In,charCode:function(e){return"keypress"===e.type?an(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?an(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),kn=sn(a({},gn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Sn=sn(a({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:In})),_n=sn(a({},pn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tn=sn(a({},gn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Dn=[9,13,27,32],On=d&&"CompositionEvent"in window,jn=null;d&&"documentMode"in document&&(jn=document.documentMode);var Rn=d&&"TextEvent"in window&&!jn,Fn=d&&(!On||jn&&8<jn&&11>=jn),Hn=String.fromCharCode(32),Pn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Un={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Un[e.type]:"textarea"===t}function Yn(e,t,n,r){_e(r),0<(t=Or(t,"onChange")).length&&(n=new fn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Wn=null,Xn=null;function Gn(e){Lr(e,0)}function $n(e){if(K(ta(e)))return e}function Qn(e,t){if("change"===e)return t}var Kn=!1;if(d){var Jn;if(d){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Jn=Zn}else Jn=!1;Kn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Wn&&(Wn.detachEvent("onpropertychange",nr),Xn=Wn=null)}function nr(e){if("value"===e.propertyName&&$n(Xn)){var t=[];if(Yn(t,Xn,e,Le(e)),e=Gn,Fe)e(t);else{Fe=!0;try{De(e,t)}finally{Fe=!1,Pe()}}}}function rr(e,t,n){"focusin"===e?(tr(),Xn=n,(Wn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $n(Xn)}function or(e,t){if("click"===e)return $n(t)}function ir(e,t){if("input"===e||"change"===e)return $n(t)}var lr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},sr=Object.prototype.hasOwnProperty;function ur(e,t){if(lr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!sr.call(t,n[r])||!lr(e[n[r]],t[n[r]]))return!1;return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function pr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?pr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fr(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=J((e=t.contentWindow).document)}return t}function hr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var mr=d&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==J(r)||("selectionStart"in(r=gr)&&hr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ur(yr,r)||(yr=r,0<(r=Or(vr,"onSelect")).length&&(t=new fn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}jt("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),jt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),jt(Ot,2);for(var Cr="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Er=0;Er<Cr.length;Er++)Dt.set(Cr[Er],0);c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ar=new Set("cancel close invalid load scroll toggle".split(" ").concat(xr));function Nr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,l,s,u){if($e.apply(this,arguments),qe){if(!qe)throw Error(i(198));var c=Ye;qe=!1,Ye=null,We||(We=!0,Xe=c)}}(r,t,void 0,e),e.currentTarget=null}function Lr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var i=r.length-1;0<=i;i--){var l=r[i],s=l.instance,u=l.currentTarget;if(l=l.listener,s!==o&&a.isPropagationStopped())break e;Nr(a,l,u),o=s}else for(i=0;i<r.length;i++){if(s=(l=r[i]).instance,u=l.currentTarget,l=l.listener,s!==o&&a.isPropagationStopped())break e;Nr(a,l,u),o=s}}}if(We)throw e=Xe,We=!1,Xe=null,e}function Ir(e,t){var n=ra(t),r=e+"__bubble";n.has(r)||(_r(t,e,2,!1),n.add(r))}var Mr="_reactListening"+Math.random().toString(36).slice(2);function kr(e){e[Mr]||(e[Mr]=!0,l.forEach((function(t){Ar.has(t)||Sr(t,!1,e,null),Sr(t,!0,e,null)})))}function Sr(e,t,n,r){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=n;if("selectionchange"===e&&9!==n.nodeType&&(o=n.ownerDocument),null!==r&&!t&&Ar.has(e)){if("scroll"!==e)return;a|=2,o=r}var i=ra(o),l=e+"__"+(t?"capture":"bubble");i.has(l)||(t&&(a|=4),_r(o,e,a,t),i.add(l))}function _r(e,t,n,r){var a=Dt.get(t);switch(void 0===a?2:a){case 0:a=Qt;break;case 1:a=Kt;break;default:a=Jt}n=a.bind(null,t,n,e),a=void 0,!ze||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Tr(e,t,n,r,a){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var l=r.stateNode.containerInfo;if(l===a||8===l.nodeType&&l.parentNode===a)break;if(4===i)for(i=r.return;null!==i;){var s=i.tag;if((3===s||4===s)&&((s=i.stateNode.containerInfo)===a||8===s.nodeType&&s.parentNode===a))return;i=i.return}for(;null!==l;){if(null===(i=Zr(l)))return;if(5===(s=i.tag)||6===s){r=o=i;continue e}l=l.parentNode}}r=r.return}!function(e,t,n){if(He)return e(t,n);He=!0;try{Re(e,t,n)}finally{He=!1,Pe()}}((function(){var r=o,a=Le(n),i=[];e:{var l=Tt.get(e);if(void 0!==l){var s=fn,u=e;switch(e){case"keypress":if(0===an(n))break e;case"keydown":case"keyup":s=Mn;break;case"focusin":u="focus",s=bn;break;case"focusout":u="blur",s=bn;break;case"beforeblur":case"afterblur":s=bn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":s=vn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":s=yn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":s=Sn;break;case Mt:case kt:case St:s=wn;break;case _t:s=_n;break;case"scroll":s=mn;break;case"wheel":s=Tn;break;case"copy":case"cut":case"paste":s=Cn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":s=kn}var c=0!==(4&t),d=!c&&"scroll"===e,p=c?null!==l?l+"Capture":null:l;c=[];for(var f,h=r;null!==h;){var m=(f=h).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==p&&(null!=(m=Be(h,p))&&c.push(Dr(h,m,f)))),d)break;h=h.return}0<c.length&&(l=new s(l,u,null,n,a),i.push({event:l,listeners:c}))}}if(0===(7&t)){if(s="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||0!==(16&t)||!(u=n.relatedTarget||n.fromElement)||!Zr(u)&&!u[Kr])&&(s||l)&&(l=a.window===a?a:(l=a.ownerDocument)?l.defaultView||l.parentWindow:window,s?(s=r,null!==(u=(u=n.relatedTarget||n.toElement)?Zr(u):null)&&(u!==(d=Qe(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(s=null,u=r),s!==u)){if(c=vn,m="onMouseLeave",p="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(c=kn,m="onPointerLeave",p="onPointerEnter",h="pointer"),d=null==s?l:ta(s),f=null==u?l:ta(u),(l=new c(m,h+"leave",s,n,a)).target=d,l.relatedTarget=f,m=null,Zr(a)===r&&((c=new c(p,h+"enter",u,n,a)).target=f,c.relatedTarget=d,m=c),d=m,s&&u)e:{for(p=u,h=0,f=c=s;f;f=jr(f))h++;for(f=0,m=p;m;m=jr(m))f++;for(;0<h-f;)c=jr(c),h--;for(;0<f-h;)p=jr(p),f--;for(;h--;){if(c===p||null!==p&&c===p.alternate)break e;c=jr(c),p=jr(p)}c=null}else c=null;null!==s&&Rr(i,l,s,c,!1),null!==u&&null!==d&&Rr(i,d,u,c,!0)}if("select"===(s=(l=r?ta(r):window).nodeName&&l.nodeName.toLowerCase())||"input"===s&&"file"===l.type)var g=Qn;else if(qn(l))if(Kn)g=ir;else{g=ar;var v=rr}else(s=l.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===l.type||"radio"===l.type)&&(g=or);switch(g&&(g=g(e,r))?Yn(i,g,n,a):(v&&v(e,l,r),"focusout"===e&&(v=l._wrapperState)&&v.controlled&&"number"===l.type&&ae(l,"number",l.value)),v=r?ta(r):window,e){case"focusin":(qn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(i,n,a);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(i,n,a)}var y;if(On)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Vn?Bn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vn&&(y=rn()):(tn="value"in(en=a)?en.value:en.textContent,Vn=!0)),0<(v=Or(r,b)).length&&(b=new En(b,e,null,n,a),i.push({event:b,listeners:v}),y?b.data=y:null!==(y=zn(n))&&(b.data=y))),(y=Rn?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Pn=!0,Hn);case"textInput":return(e=t.data)===Hn&&Pn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!On&&Bn(e,t)?(e=rn(),nn=tn=en=null,Vn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data;default:return null}}(e,n))&&(0<(r=Or(r,"onBeforeInput")).length&&(a=new En("onBeforeInput","beforeinput",null,n,a),i.push({event:a,listeners:r}),a.data=y))}Lr(i,t)}))}function Dr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Or(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,o=a.stateNode;5===a.tag&&null!==o&&(a=o,null!=(o=Be(e,n))&&r.unshift(Dr(e,o,a)),null!=(o=Be(e,t))&&r.push(Dr(e,o,a))),e=e.return}return r}function jr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Rr(e,t,n,r,a){for(var o=t._reactName,i=[];null!==n&&n!==r;){var l=n,s=l.alternate,u=l.stateNode;if(null!==s&&s===r)break;5===l.tag&&null!==u&&(l=u,a?null!=(s=Be(n,o))&&i.unshift(Dr(n,s,l)):a||null!=(s=Be(n,o))&&i.push(Dr(n,s,l))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}function Fr(){}var Hr=null,Pr=null;function Br(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function zr(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Vr="function"===typeof setTimeout?setTimeout:void 0,Ur="function"===typeof clearTimeout?clearTimeout:void 0;function qr(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Yr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Wr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var Xr=0;var Gr=Math.random().toString(36).slice(2),$r="__reactFiber$"+Gr,Qr="__reactProps$"+Gr,Kr="__reactContainer$"+Gr,Jr="__reactEvents$"+Gr;function Zr(e){var t=e[$r];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Kr]||n[$r]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Wr(e);null!==e;){if(n=e[$r])return n;e=Wr(e)}return t}n=(e=n).parentNode}return null}function ea(e){return!(e=e[$r]||e[Kr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ta(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function na(e){return e[Qr]||null}function ra(e){var t=e[Jr];return void 0===t&&(t=e[Jr]=new Set),t}var aa=[],oa=-1;function ia(e){return{current:e}}function la(e){0>oa||(e.current=aa[oa],aa[oa]=null,oa--)}function sa(e,t){oa++,aa[oa]=e.current,e.current=t}var ua={},ca=ia(ua),da=ia(!1),pa=ua;function fa(e,t){var n=e.type.contextTypes;if(!n)return ua;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,o={};for(a in n)o[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function ha(e){return null!==(e=e.childContextTypes)&&void 0!==e}function ma(){la(da),la(ca)}function ga(e,t,n){if(ca.current!==ua)throw Error(i(168));sa(ca,t),sa(da,n)}function va(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in e))throw Error(i(108,X(t)||"Unknown",o));return a({},n,r)}function ya(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ua,pa=ca.current,sa(ca,e),sa(da,da.current),!0}function ba(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=va(e,t,pa),r.__reactInternalMemoizedMergedChildContext=e,la(da),la(ca),sa(ca,e)):la(da),sa(da,n)}var wa=null,Ca=null,Ea=o.unstable_runWithPriority,xa=o.unstable_scheduleCallback,Aa=o.unstable_cancelCallback,Na=o.unstable_shouldYield,La=o.unstable_requestPaint,Ia=o.unstable_now,Ma=o.unstable_getCurrentPriorityLevel,ka=o.unstable_ImmediatePriority,Sa=o.unstable_UserBlockingPriority,_a=o.unstable_NormalPriority,Ta=o.unstable_LowPriority,Da=o.unstable_IdlePriority,Oa={},ja=void 0!==La?La:function(){},Ra=null,Fa=null,Ha=!1,Pa=Ia(),Ba=1e4>Pa?Ia:function(){return Ia()-Pa};function za(){switch(Ma()){case ka:return 99;case Sa:return 98;case _a:return 97;case Ta:return 96;case Da:return 95;default:throw Error(i(332))}}function Va(e){switch(e){case 99:return ka;case 98:return Sa;case 97:return _a;case 96:return Ta;case 95:return Da;default:throw Error(i(332))}}function Ua(e,t){return e=Va(e),Ea(e,t)}function qa(e,t,n){return e=Va(e),xa(e,t,n)}function Ya(){if(null!==Fa){var e=Fa;Fa=null,Aa(e)}Wa()}function Wa(){if(!Ha&&null!==Ra){Ha=!0;var e=0;try{var t=Ra;Ua(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Ra=null}catch(n){throw null!==Ra&&(Ra=Ra.slice(e+1)),xa(ka,Ya),n}finally{Ha=!1}}}var Xa=C.ReactCurrentBatchConfig;function Ga(e,t){if(e&&e.defaultProps){for(var n in t=a({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var $a=ia(null),Qa=null,Ka=null,Ja=null;function Za(){Ja=Ka=Qa=null}function eo(e){var t=$a.current;la($a),e.type._context._currentValue=t}function to(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function no(e,t){Qa=e,Ja=Ka=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Oi=!0),e.firstContext=null)}function ro(e,t){if(Ja!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(Ja=e,t=1073741823),t={context:e,observedBits:t,next:null},null===Ka){if(null===Qa)throw Error(i(308));Ka=t,Qa.dependencies={lanes:0,firstContext:t,responders:null}}else Ka=Ka.next=t;return e._currentValue}var ao=!1;function oo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function io(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function lo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function so(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function uo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?a=o=i:o=o.next=i,n=n.next}while(null!==n);null===o?a=o=t:o=o.next=t}else a=o=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function co(e,t,n,r){var o=e.updateQueue;ao=!1;var i=o.firstBaseUpdate,l=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var u=s,c=u.next;u.next=null,null===l?i=c:l.next=c,l=u;var d=e.alternate;if(null!==d){var p=(d=d.updateQueue).lastBaseUpdate;p!==l&&(null===p?d.firstBaseUpdate=c:p.next=c,d.lastBaseUpdate=u)}}if(null!==i){for(p=o.baseState,l=0,d=c=u=null;;){s=i.lane;var f=i.eventTime;if((r&s)===s){null!==d&&(d=d.next={eventTime:f,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var h=e,m=i;switch(s=t,f=n,m.tag){case 1:if("function"===typeof(h=m.payload)){p=h.call(f,p,s);break e}p=h;break e;case 3:h.flags=-4097&h.flags|64;case 0:if(null===(s="function"===typeof(h=m.payload)?h.call(f,p,s):h)||void 0===s)break e;p=a({},p,s);break e;case 2:ao=!0}}null!==i.callback&&(e.flags|=32,null===(s=o.effects)?o.effects=[i]:s.push(i))}else f={eventTime:f,lane:s,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===d?(c=d=f,u=p):d=d.next=f,l|=s;if(null===(i=i.next)){if(null===(s=o.shared.pending))break;i=s.next,s.next=null,o.lastBaseUpdate=s,o.shared.pending=null}}null===d&&(u=p),o.baseState=u,o.firstBaseUpdate=c,o.lastBaseUpdate=d,Hl|=l,e.lanes=l,e.memoizedState=p}}function po(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var fo=(new r.Component).refs;function ho(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:a({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var mo={isMounted:function(e){return!!(e=e._reactInternals)&&Qe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=us(),a=cs(e),o=lo(r,a);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),so(e,o),ds(e,a,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=us(),a=cs(e),o=lo(r,a);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),so(e,o),ds(e,a,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=us(),r=cs(e),a=lo(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),so(e,a),ds(e,r,n)}};function go(e,t,n,r,a,o,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,i):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(a,o))}function vo(e,t,n){var r=!1,a=ua,o=t.contextType;return"object"===typeof o&&null!==o?o=ro(o):(a=ha(t)?pa:ca.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?fa(e,a):ua),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=mo,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=o),t}function yo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&mo.enqueueReplaceState(t,t.state,null)}function bo(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=fo,oo(e);var o=t.contextType;"object"===typeof o&&null!==o?a.context=ro(o):(o=ha(t)?pa:ca.current,a.context=fa(e,o)),co(e,n,a,r),a.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(ho(e,t,o,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&mo.enqueueReplaceState(a,a.state,null),co(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4)}var wo=Array.isArray;function Co(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:((t=function(e){var t=r.refs;t===fo&&(t=r.refs={}),null===e?delete t[a]:t[a]=e})._stringRef=a,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function Eo(e,t){if("textarea"!==e.type)throw Error(i(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function xo(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Us(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function l(t){return e&&null===t.alternate&&(t.flags=2),t}function s(e,t,n,r){return null===t||6!==t.tag?((t=Xs(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function u(e,t,n,r){return null!==t&&t.elementType===n.type?((r=a(t,n.props)).ref=Co(e,t,n),r.return=e,r):((r=qs(n.type,n.key,n.props,null,e.mode,r)).ref=Co(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Gs(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Ys(n,e.mode,r,o)).return=e,t):((t=a(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=Xs(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case E:return(n=qs(t.type,t.key,t.props,null,e.mode,n)).ref=Co(e,null,t),n.return=e,n;case x:return(t=Gs(t,e.mode,n)).return=e,t}if(wo(t)||V(t))return(t=Ys(t,e.mode,n,null)).return=e,t;Eo(e,t)}return null}function f(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==a?null:s(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case E:return n.key===a?n.type===A?d(e,t,n.props.children,r,a):u(e,t,n,r):null;case x:return n.key===a?c(e,t,n,r):null}if(wo(n)||V(n))return null!==a?null:d(e,t,n,r,null);Eo(e,n)}return null}function h(e,t,n,r,a){if("string"===typeof r||"number"===typeof r)return s(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case E:return e=e.get(null===r.key?n:r.key)||null,r.type===A?d(t,e,r.props.children,a,r.key):u(t,e,r,a);case x:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a)}if(wo(r)||V(r))return d(t,e=e.get(n)||null,r,a,null);Eo(t,r)}return null}function m(a,i,l,s){for(var u=null,c=null,d=i,m=i=0,g=null;null!==d&&m<l.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=f(a,d,l[m],s);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(a,d),i=o(v,i,m),null===c?u=v:c.sibling=v,c=v,d=g}if(m===l.length)return n(a,d),u;if(null===d){for(;m<l.length;m++)null!==(d=p(a,l[m],s))&&(i=o(d,i,m),null===c?u=d:c.sibling=d,c=d);return u}for(d=r(a,d);m<l.length;m++)null!==(g=h(d,a,m,l[m],s))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),i=o(g,i,m),null===c?u=g:c.sibling=g,c=g);return e&&d.forEach((function(e){return t(a,e)})),u}function g(a,l,s,u){var c=V(s);if("function"!==typeof c)throw Error(i(150));if(null==(s=c.call(s)))throw Error(i(151));for(var d=c=null,m=l,g=l=0,v=null,y=s.next();null!==m&&!y.done;g++,y=s.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=f(a,m,y.value,u);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(a,m),l=o(b,l,g),null===d?c=b:d.sibling=b,d=b,m=v}if(y.done)return n(a,m),c;if(null===m){for(;!y.done;g++,y=s.next())null!==(y=p(a,y.value,u))&&(l=o(y,l,g),null===d?c=y:d.sibling=y,d=y);return c}for(m=r(a,m);!y.done;g++,y=s.next())null!==(y=h(m,a,g,y.value,u))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),l=o(y,l,g),null===d?c=y:d.sibling=y,d=y);return e&&m.forEach((function(e){return t(a,e)})),c}return function(e,r,o,s){var u="object"===typeof o&&null!==o&&o.type===A&&null===o.key;u&&(o=o.props.children);var c="object"===typeof o&&null!==o;if(c)switch(o.$$typeof){case E:e:{for(c=o.key,u=r;null!==u;){if(u.key===c){switch(u.tag){case 7:if(o.type===A){n(e,u.sibling),(r=a(u,o.props.children)).return=e,e=r;break e}break;default:if(u.elementType===o.type){n(e,u.sibling),(r=a(u,o.props)).ref=Co(e,u,o),r.return=e,e=r;break e}}n(e,u);break}t(e,u),u=u.sibling}o.type===A?((r=Ys(o.props.children,e.mode,s,o.key)).return=e,e=r):((s=qs(o.type,o.key,o.props,null,e.mode,s)).ref=Co(e,r,o),s.return=e,e=s)}return l(e);case x:e:{for(u=o.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),(r=a(r,o.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Gs(o,e.mode,s)).return=e,e=r}return l(e)}if("string"===typeof o||"number"===typeof o)return o=""+o,null!==r&&6===r.tag?(n(e,r.sibling),(r=a(r,o)).return=e,e=r):(n(e,r),(r=Xs(o,e.mode,s)).return=e,e=r),l(e);if(wo(o))return m(e,r,o,s);if(V(o))return g(e,r,o,s);if(c&&Eo(e,o),"undefined"===typeof o&&!u)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(i(152,X(e.type)||"Component"))}return n(e,r)}}var Ao=xo(!0),No=xo(!1),Lo={},Io=ia(Lo),Mo=ia(Lo),ko=ia(Lo);function So(e){if(e===Lo)throw Error(i(174));return e}function _o(e,t){switch(sa(ko,t),sa(Mo,e),sa(Io,Lo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:he(null,"");break;default:t=he(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}la(Io),sa(Io,t)}function To(){la(Io),la(Mo),la(ko)}function Do(e){So(ko.current);var t=So(Io.current),n=he(t,e.type);t!==n&&(sa(Mo,e),sa(Io,n))}function Oo(e){Mo.current===e&&(la(Io),la(Mo))}var jo=ia(0);function Ro(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Fo=null,Ho=null,Po=!1;function Bo(e,t){var n=zs(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function zo(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function Vo(e){if(Po){var t=Ho;if(t){var n=t;if(!zo(e,t)){if(!(t=Yr(n.nextSibling))||!zo(e,t))return e.flags=-1025&e.flags|2,Po=!1,void(Fo=e);Bo(Fo,n)}Fo=e,Ho=Yr(t.firstChild)}else e.flags=-1025&e.flags|2,Po=!1,Fo=e}}function Uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Fo=e}function qo(e){if(e!==Fo)return!1;if(!Po)return Uo(e),Po=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!zr(t,e.memoizedProps))for(t=Ho;t;)Bo(e,t),t=Yr(t.nextSibling);if(Uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Ho=Yr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Ho=null}}else Ho=Fo?Yr(e.stateNode.nextSibling):null;return!0}function Yo(){Ho=Fo=null,Po=!1}var Wo=[];function Xo(){for(var e=0;e<Wo.length;e++)Wo[e]._workInProgressVersionPrimary=null;Wo.length=0}var Go=C.ReactCurrentDispatcher,$o=C.ReactCurrentBatchConfig,Qo=0,Ko=null,Jo=null,Zo=null,ei=!1,ti=!1;function ni(){throw Error(i(321))}function ri(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!lr(e[n],t[n]))return!1;return!0}function ai(e,t,n,r,a,o){if(Qo=o,Ko=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Go.current=null===e||null===e.memoizedState?Si:_i,e=n(r,a),ti){o=0;do{if(ti=!1,!(25>o))throw Error(i(301));o+=1,Zo=Jo=null,t.updateQueue=null,Go.current=Ti,e=n(r,a)}while(ti)}if(Go.current=ki,t=null!==Jo&&null!==Jo.next,Qo=0,Zo=Jo=Ko=null,ei=!1,t)throw Error(i(300));return e}function oi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Zo?Ko.memoizedState=Zo=e:Zo=Zo.next=e,Zo}function ii(){if(null===Jo){var e=Ko.alternate;e=null!==e?e.memoizedState:null}else e=Jo.next;var t=null===Zo?Ko.memoizedState:Zo.next;if(null!==t)Zo=t,Jo=e;else{if(null===e)throw Error(i(310));e={memoizedState:(Jo=e).memoizedState,baseState:Jo.baseState,baseQueue:Jo.baseQueue,queue:Jo.queue,next:null},null===Zo?Ko.memoizedState=Zo=e:Zo=Zo.next=e}return Zo}function li(e,t){return"function"===typeof t?t(e):t}function si(e){var t=ii(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=Jo,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var l=a.next;a.next=o.next,o.next=l}r.baseQueue=a=o,n.pending=null}if(null!==a){a=a.next,r=r.baseState;var s=l=o=null,u=a;do{var c=u.lane;if((Qo&c)===c)null!==s&&(s=s.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),r=u.eagerReducer===e?u.eagerState:e(r,u.action);else{var d={lane:c,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===s?(l=s=d,o=r):s=s.next=d,Ko.lanes|=c,Hl|=c}u=u.next}while(null!==u&&u!==a);null===s?o=r:s.next=l,lr(r,t.memoizedState)||(Oi=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=s,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function ui(e){var t=ii(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var l=a=a.next;do{o=e(o,l.action),l=l.next}while(l!==a);lr(o,t.memoizedState)||(Oi=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function ci(e,t,n){var r=t._getVersion;r=r(t._source);var a=t._workInProgressVersionPrimary;if(null!==a?e=a===r:(e=e.mutableReadLanes,(e=(Qo&e)===e)&&(t._workInProgressVersionPrimary=r,Wo.push(t))),e)return n(t._source);throw Wo.push(t),Error(i(350))}function di(e,t,n,r){var a=Sl;if(null===a)throw Error(i(349));var o=t._getVersion,l=o(t._source),s=Go.current,u=s.useState((function(){return ci(a,t,n)})),c=u[1],d=u[0];u=Zo;var p=e.memoizedState,f=p.refs,h=f.getSnapshot,m=p.source;p=p.subscribe;var g=Ko;return e.memoizedState={refs:f,source:t,subscribe:r},s.useEffect((function(){f.getSnapshot=n,f.setSnapshot=c;var e=o(t._source);if(!lr(l,e)){e=n(t._source),lr(d,e)||(c(e),e=cs(g),a.mutableReadLanes|=e&a.pendingLanes),e=a.mutableReadLanes,a.entangledLanes|=e;for(var r=a.entanglements,i=e;0<i;){var s=31-qt(i),u=1<<s;r[s]|=e,i&=~u}}}),[n,t,r]),s.useEffect((function(){return r(t._source,(function(){var e=f.getSnapshot,n=f.setSnapshot;try{n(e(t._source));var r=cs(g);a.mutableReadLanes|=r&a.pendingLanes}catch(o){n((function(){throw o}))}}))}),[t,r]),lr(h,n)&&lr(m,t)&&lr(p,r)||((e={pending:null,dispatch:null,lastRenderedReducer:li,lastRenderedState:d}).dispatch=c=Mi.bind(null,Ko,e),u.queue=e,u.baseQueue=null,d=ci(a,t,n),u.memoizedState=u.baseState=d),d}function pi(e,t,n){return di(ii(),e,t,n)}function fi(e){var t=oi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:li,lastRenderedState:e}).dispatch=Mi.bind(null,Ko,e),[t.memoizedState,e]}function hi(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Ko.updateQueue)?(t={lastEffect:null},Ko.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function mi(e){return e={current:e},oi().memoizedState=e}function gi(){return ii().memoizedState}function vi(e,t,n,r){var a=oi();Ko.flags|=e,a.memoizedState=hi(1|t,n,void 0,void 0===r?null:r)}function yi(e,t,n,r){var a=ii();r=void 0===r?null:r;var o=void 0;if(null!==Jo){var i=Jo.memoizedState;if(o=i.destroy,null!==r&&ri(r,i.deps))return void hi(t,n,o,r)}Ko.flags|=e,a.memoizedState=hi(1|t,n,o,r)}function bi(e,t){return vi(516,4,e,t)}function wi(e,t){return yi(516,4,e,t)}function Ci(e,t){return yi(4,2,e,t)}function Ei(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function xi(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,yi(4,2,Ei.bind(null,t,e),n)}function Ai(){}function Ni(e,t){var n=ii();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ri(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Li(e,t){var n=ii();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ri(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ii(e,t){var n=za();Ua(98>n?98:n,(function(){e(!0)})),Ua(97<n?97:n,(function(){var n=$o.transition;$o.transition=1;try{e(!1),t()}finally{$o.transition=n}}))}function Mi(e,t,n){var r=us(),a=cs(e),o={lane:a,action:n,eagerReducer:null,eagerState:null,next:null},i=t.pending;if(null===i?o.next=o:(o.next=i.next,i.next=o),t.pending=o,i=e.alternate,e===Ko||null!==i&&i===Ko)ti=ei=!0;else{if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var l=t.lastRenderedState,s=i(l,n);if(o.eagerReducer=i,o.eagerState=s,lr(s,l))return}catch(u){}ds(e,a,r)}}var ki={readContext:ro,useCallback:ni,useContext:ni,useEffect:ni,useImperativeHandle:ni,useLayoutEffect:ni,useMemo:ni,useReducer:ni,useRef:ni,useState:ni,useDebugValue:ni,useDeferredValue:ni,useTransition:ni,useMutableSource:ni,useOpaqueIdentifier:ni,unstable_isNewReconciler:!1},Si={readContext:ro,useCallback:function(e,t){return oi().memoizedState=[e,void 0===t?null:t],e},useContext:ro,useEffect:bi,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,vi(4,2,Ei.bind(null,t,e),n)},useLayoutEffect:function(e,t){return vi(4,2,e,t)},useMemo:function(e,t){var n=oi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=oi();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Mi.bind(null,Ko,e),[r.memoizedState,e]},useRef:mi,useState:fi,useDebugValue:Ai,useDeferredValue:function(e){var t=fi(e),n=t[0],r=t[1];return bi((function(){var t=$o.transition;$o.transition=1;try{r(e)}finally{$o.transition=t}}),[e]),n},useTransition:function(){var e=fi(!1),t=e[0];return mi(e=Ii.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=oi();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},di(r,e,t,n)},useOpaqueIdentifier:function(){if(Po){var e=!1,t=function(e){return{$$typeof:j,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+(Xr++).toString(36))),Error(i(355))})),n=fi(t)[1];return 0===(2&Ko.mode)&&(Ko.flags|=516,hi(5,(function(){n("r:"+(Xr++).toString(36))}),void 0,null)),t}return fi(t="r:"+(Xr++).toString(36)),t},unstable_isNewReconciler:!1},_i={readContext:ro,useCallback:Ni,useContext:ro,useEffect:wi,useImperativeHandle:xi,useLayoutEffect:Ci,useMemo:Li,useReducer:si,useRef:gi,useState:function(){return si(li)},useDebugValue:Ai,useDeferredValue:function(e){var t=si(li),n=t[0],r=t[1];return wi((function(){var t=$o.transition;$o.transition=1;try{r(e)}finally{$o.transition=t}}),[e]),n},useTransition:function(){var e=si(li)[0];return[gi().current,e]},useMutableSource:pi,useOpaqueIdentifier:function(){return si(li)[0]},unstable_isNewReconciler:!1},Ti={readContext:ro,useCallback:Ni,useContext:ro,useEffect:wi,useImperativeHandle:xi,useLayoutEffect:Ci,useMemo:Li,useReducer:ui,useRef:gi,useState:function(){return ui(li)},useDebugValue:Ai,useDeferredValue:function(e){var t=ui(li),n=t[0],r=t[1];return wi((function(){var t=$o.transition;$o.transition=1;try{r(e)}finally{$o.transition=t}}),[e]),n},useTransition:function(){var e=ui(li)[0];return[gi().current,e]},useMutableSource:pi,useOpaqueIdentifier:function(){return ui(li)[0]},unstable_isNewReconciler:!1},Di=C.ReactCurrentOwner,Oi=!1;function ji(e,t,n,r){t.child=null===e?No(t,null,n,r):Ao(t,e.child,n,r)}function Ri(e,t,n,r,a){n=n.render;var o=t.ref;return no(t,a),r=ai(e,t,n,r,o,a),null===e||Oi?(t.flags|=1,ji(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,nl(e,t,a))}function Fi(e,t,n,r,a,o){if(null===e){var i=n.type;return"function"!==typeof i||Vs(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=qs(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Hi(e,t,i,r,a,o))}return i=e.child,0===(a&o)&&(a=i.memoizedProps,(n=null!==(n=n.compare)?n:ur)(a,r)&&e.ref===t.ref)?nl(e,t,o):(t.flags|=1,(e=Us(i,r)).ref=t.ref,e.return=t,t.child=e)}function Hi(e,t,n,r,a,o){if(null!==e&&ur(e.memoizedProps,r)&&e.ref===t.ref){if(Oi=!1,0===(o&a))return t.lanes=e.lanes,nl(e,t,o);0!==(16384&e.flags)&&(Oi=!0)}return zi(e,t,n,r,o)}function Pi(e,t,n){var r=t.pendingProps,a=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0===(4&t.mode))t.memoizedState={baseLanes:0},bs(t,n);else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},bs(t,e),null;t.memoizedState={baseLanes:0},bs(t,null!==o?o.baseLanes:n)}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,bs(t,r);return ji(e,t,a,n),t.child}function Bi(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function zi(e,t,n,r,a){var o=ha(n)?pa:ca.current;return o=fa(t,o),no(t,a),n=ai(e,t,n,r,o,a),null===e||Oi?(t.flags|=1,ji(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,nl(e,t,a))}function Vi(e,t,n,r,a){if(ha(n)){var o=!0;ya(t)}else o=!1;if(no(t,a),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),vo(t,n,r),bo(t,n,r,a),r=!0;else if(null===e){var i=t.stateNode,l=t.memoizedProps;i.props=l;var s=i.context,u=n.contextType;"object"===typeof u&&null!==u?u=ro(u):u=fa(t,u=ha(n)?pa:ca.current);var c=n.getDerivedStateFromProps,d="function"===typeof c||"function"===typeof i.getSnapshotBeforeUpdate;d||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(l!==r||s!==u)&&yo(t,i,r,u),ao=!1;var p=t.memoizedState;i.state=p,co(t,r,i,a),s=t.memoizedState,l!==r||p!==s||da.current||ao?("function"===typeof c&&(ho(t,n,c,r),s=t.memoizedState),(l=ao||go(t,n,l,r,p,s,u))?(d||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4)):("function"===typeof i.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=s),i.props=r,i.state=s,i.context=u,r=l):("function"===typeof i.componentDidMount&&(t.flags|=4),r=!1)}else{i=t.stateNode,io(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Ga(t.type,l),i.props=u,d=t.pendingProps,p=i.context,"object"===typeof(s=n.contextType)&&null!==s?s=ro(s):s=fa(t,s=ha(n)?pa:ca.current);var f=n.getDerivedStateFromProps;(c="function"===typeof f||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(l!==d||p!==s)&&yo(t,i,r,s),ao=!1,p=t.memoizedState,i.state=p,co(t,r,i,a);var h=t.memoizedState;l!==d||p!==h||da.current||ao?("function"===typeof f&&(ho(t,n,f,r),h=t.memoizedState),(u=ao||go(t,n,u,r,p,h,s))?(c||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,h,s),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,h,s)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!==typeof i.componentDidUpdate||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=h),i.props=r,i.state=h,i.context=s,r=u):("function"!==typeof i.componentDidUpdate||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=256),r=!1)}return Ui(e,t,n,r,o,a)}function Ui(e,t,n,r,a,o){Bi(e,t);var i=0!==(64&t.flags);if(!r&&!i)return a&&ba(t,n,!1),nl(e,t,o);r=t.stateNode,Di.current=t;var l=i&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&i?(t.child=Ao(t,e.child,null,o),t.child=Ao(t,null,l,o)):ji(e,t,l,o),t.memoizedState=r.state,a&&ba(t,n,!0),t.child}function qi(e){var t=e.stateNode;t.pendingContext?ga(0,t.pendingContext,t.pendingContext!==t.context):t.context&&ga(0,t.context,!1),_o(e,t.containerInfo)}var Yi,Wi,Xi,Gi={dehydrated:null,retryLane:0};function $i(e,t,n){var r,a=t.pendingProps,o=jo.current,i=!1;return(r=0!==(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(i=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===a.fallback||!0===a.unstable_avoidThisFallback||(o|=1),sa(jo,1&o),null===e?(void 0!==a.fallback&&Vo(t),e=a.children,o=a.fallback,i?(e=Qi(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Gi,e):"number"===typeof a.unstable_expectedLoadTime?(e=Qi(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Gi,t.lanes=33554432,e):((n=Ws({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,i?(a=Ji(e,t,a.children,a.fallback,n),i=t.child,o=e.child.memoizedState,i.memoizedState=null===o?{baseLanes:n}:{baseLanes:o.baseLanes|n},i.childLanes=e.childLanes&~n,t.memoizedState=Gi,a):(n=Ki(e,t,a.children,n),t.memoizedState=null,n))}function Qi(e,t,n,r){var a=e.mode,o=e.child;return t={mode:"hidden",children:t},0===(2&a)&&null!==o?(o.childLanes=0,o.pendingProps=t):o=Ws(t,a,0,null),n=Ys(n,a,r,null),o.return=e,n.return=e,o.sibling=n,e.child=o,n}function Ki(e,t,n,r){var a=e.child;return e=a.sibling,n=Us(a,{mode:"visible",children:n}),0===(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function Ji(e,t,n,r,a){var o=t.mode,i=e.child;e=i.sibling;var l={mode:"hidden",children:n};return 0===(2&o)&&t.child!==i?((n=t.child).childLanes=0,n.pendingProps=l,null!==(i=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=i,i.nextEffect=null):t.firstEffect=t.lastEffect=null):n=Us(i,l),null!==e?r=Us(e,r):(r=Ys(r,o,a,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function Zi(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),to(e.return,t)}function el(e,t,n,r,a,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a,lastEffect:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a,i.lastEffect=o)}function tl(e,t,n){var r=t.pendingProps,a=r.revealOrder,o=r.tail;if(ji(e,t,r.children,n),0!==(2&(r=jo.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!==(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Zi(e,n);else if(19===e.tag)Zi(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(sa(jo,r),0===(2&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===Ro(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),el(t,!1,a,n,o,t.lastEffect);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===Ro(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}el(t,!0,n,null,o,t.lastEffect);break;case"together":el(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function nl(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Hl|=t.lanes,0!==(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Us(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Us(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function rl(e,t){if(!Po)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function al(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return ha(t.type)&&ma(),null;case 3:return To(),la(da),la(ca),Xo(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(qo(t)?t.flags|=4:r.hydrate||(t.flags|=256)),null;case 5:Oo(t);var o=So(ko.current);if(n=t.type,null!==e&&null!=t.stateNode)Wi(e,t,n,r),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(i(166));return null}if(e=So(Io.current),qo(t)){r=t.stateNode,n=t.type;var l=t.memoizedProps;switch(r[$r]=t,r[Qr]=l,n){case"dialog":Ir("cancel",r),Ir("close",r);break;case"iframe":case"object":case"embed":Ir("load",r);break;case"video":case"audio":for(e=0;e<xr.length;e++)Ir(xr[e],r);break;case"source":Ir("error",r);break;case"img":case"image":case"link":Ir("error",r),Ir("load",r);break;case"details":Ir("toggle",r);break;case"input":ee(r,l),Ir("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},Ir("invalid",r);break;case"textarea":se(r,l),Ir("invalid",r)}for(var u in Ae(n,l),e=null,l)l.hasOwnProperty(u)&&(o=l[u],"children"===u?"string"===typeof o?r.textContent!==o&&(e=["children",o]):"number"===typeof o&&r.textContent!==""+o&&(e=["children",""+o]):s.hasOwnProperty(u)&&null!=o&&"onScroll"===u&&Ir("scroll",r));switch(n){case"input":Q(r),re(r,l,!0);break;case"textarea":Q(r),ce(r);break;case"select":case"option":break;default:"function"===typeof l.onClick&&(r.onclick=Fr)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(u=9===o.nodeType?o:o.ownerDocument,e===de&&(e=fe(n)),e===de?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[$r]=t,e[Qr]=r,Yi(e,t),t.stateNode=e,u=Ne(n,r),n){case"dialog":Ir("cancel",e),Ir("close",e),o=r;break;case"iframe":case"object":case"embed":Ir("load",e),o=r;break;case"video":case"audio":for(o=0;o<xr.length;o++)Ir(xr[o],e);o=r;break;case"source":Ir("error",e),o=r;break;case"img":case"image":case"link":Ir("error",e),Ir("load",e),o=r;break;case"details":Ir("toggle",e),o=r;break;case"input":ee(e,r),o=Z(e,r),Ir("invalid",e);break;case"option":o=oe(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=a({},r,{value:void 0}),Ir("invalid",e);break;case"textarea":se(e,r),o=le(e,r),Ir("invalid",e);break;default:o=r}Ae(n,o);var c=o;for(l in c)if(c.hasOwnProperty(l)){var d=c[l];"style"===l?Ee(e,d):"dangerouslySetInnerHTML"===l?null!=(d=d?d.__html:void 0)&&ve(e,d):"children"===l?"string"===typeof d?("textarea"!==n||""!==d)&&ye(e,d):"number"===typeof d&&ye(e,""+d):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?null!=d&&"onScroll"===l&&Ir("scroll",e):null!=d&&w(e,l,d,u))}switch(n){case"input":Q(e),re(e,r,!1);break;case"textarea":Q(e),ce(e);break;case"option":null!=r.value&&e.setAttribute("value",""+G(r.value));break;case"select":e.multiple=!!r.multiple,null!=(l=r.value)?ie(e,!!r.multiple,l,!1):null!=r.defaultValue&&ie(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof o.onClick&&(e.onclick=Fr)}Br(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Xi(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));n=So(ko.current),So(Io.current),qo(t)?(r=t.stateNode,n=t.memoizedProps,r[$r]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[$r]=t,t.stateNode=r)}return null;case 13:return la(jo),r=t.memoizedState,0!==(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&qo(t):n=null!==e.memoizedState,r&&!n&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&jo.current)?0===jl&&(jl=3):(0!==jl&&3!==jl||(jl=4),null===Sl||0===(134217727&Hl)&&0===(134217727&Pl)||ms(Sl,Tl))),(r||n)&&(t.flags|=4),null);case 4:return To(),null===e&&kr(t.stateNode.containerInfo),null;case 10:return eo(t),null;case 17:return ha(t.type)&&ma(),null;case 19:if(la(jo),null===(r=t.memoizedState))return null;if(l=0!==(64&t.flags),null===(u=r.rendering))if(l)rl(r,!1);else{if(0!==jl||null!==e&&0!==(64&e.flags))for(e=t.child;null!==e;){if(null!==(u=Ro(e))){for(t.flags|=64,rl(r,!1),null!==(l=u.updateQueue)&&(t.updateQueue=l,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(l=n).flags&=2,l.nextEffect=null,l.firstEffect=null,l.lastEffect=null,null===(u=l.alternate)?(l.childLanes=0,l.lanes=e,l.child=null,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=u.childLanes,l.lanes=u.lanes,l.child=u.child,l.memoizedProps=u.memoizedProps,l.memoizedState=u.memoizedState,l.updateQueue=u.updateQueue,l.type=u.type,e=u.dependencies,l.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return sa(jo,1&jo.current|2),t.child}e=e.sibling}null!==r.tail&&Ba()>Ul&&(t.flags|=64,l=!0,rl(r,!1),t.lanes=33554432)}else{if(!l)if(null!==(e=Ro(u))){if(t.flags|=64,l=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),rl(r,!0),null===r.tail&&"hidden"===r.tailMode&&!u.alternate&&!Po)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Ba()-r.renderingStartTime>Ul&&1073741824!==n&&(t.flags|=64,l=!0,rl(r,!1),t.lanes=33554432);r.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=r.last)?n.sibling=u:t.child=u,r.last=u)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Ba(),n.sibling=null,t=jo.current,sa(jo,l?1&t|2:1&t),n):null;case 23:case 24:return ws(),null!==e&&null!==e.memoizedState!==(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(i(156,t.tag))}function ol(e){switch(e.tag){case 1:ha(e.type)&&ma();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(To(),la(da),la(ca),Xo(),0!==(64&(t=e.flags)))throw Error(i(285));return e.flags=-4097&t|64,e;case 5:return Oo(e),null;case 13:return la(jo),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return la(jo),null;case 4:return To(),null;case 10:return eo(e),null;case 23:case 24:return ws(),null;default:return null}}function il(e,t){try{var n="",r=t;do{n+=W(r),r=r.return}while(r);var a=n}catch(o){a="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:a}}function ll(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}Yi=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Wi=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,So(Io.current);var i,l=null;switch(n){case"input":o=Z(e,o),r=Z(e,r),l=[];break;case"option":o=oe(e,o),r=oe(e,r),l=[];break;case"select":o=a({},o,{value:void 0}),r=a({},r,{value:void 0}),l=[];break;case"textarea":o=le(e,o),r=le(e,r),l=[];break;default:"function"!==typeof o.onClick&&"function"===typeof r.onClick&&(e.onclick=Fr)}for(d in Ae(n,r),n=null,o)if(!r.hasOwnProperty(d)&&o.hasOwnProperty(d)&&null!=o[d])if("style"===d){var u=o[d];for(i in u)u.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(s.hasOwnProperty(d)?l||(l=[]):(l=l||[]).push(d,null));for(d in r){var c=r[d];if(u=null!=o?o[d]:void 0,r.hasOwnProperty(d)&&c!==u&&(null!=c||null!=u))if("style"===d)if(u){for(i in u)!u.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&u[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(l||(l=[]),l.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(l=l||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(l=l||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(s.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Ir("scroll",e),l||u===c||(l=[])):"object"===typeof c&&null!==c&&c.$$typeof===j?c.toString():(l=l||[]).push(d,c))}n&&(l=l||[]).push("style",n);var d=l;(t.updateQueue=d)&&(t.flags|=4)}},Xi=function(e,t,n,r){n!==r&&(t.flags|=4)};var sl="function"===typeof WeakMap?WeakMap:Map;function ul(e,t,n){(n=lo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Xl||(Xl=!0,Gl=r),ll(0,t)},n}function cl(e,t,n){(n=lo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return ll(0,t),r(a)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===$l?$l=new Set([this]):$l.add(this),ll(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var dl="function"===typeof WeakSet?WeakSet:Set;function pl(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){Fs(e,n)}else t.current=null}function fl(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Ga(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&qr(t.stateNode.containerInfo));case 5:case 6:case 4:case 17:return}throw Error(i(163))}function hl(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3===(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var a=e;r=a.next,0!==(4&(a=a.tag))&&0!==(1&a)&&(Os(n,e),Ds(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:Ga(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&po(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}po(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&Br(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&Et(n)))));case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(i(163))}function ml(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"===typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var a=n.memoizedProps.style;a=void 0!==a&&null!==a&&a.hasOwnProperty("display")?a.display:null,r.style.display=Ce("display",a)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function gl(e,t){if(Ca&&"function"===typeof Ca.onCommitFiberUnmount)try{Ca.onCommitFiberUnmount(wa,t)}catch(o){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,a=r.destroy;if(r=r.tag,void 0!==a)if(0!==(4&r))Os(t,n);else{r=t;try{a()}catch(o){Fs(r,o)}}n=n.next}while(n!==e)}break;case 1:if(pl(t),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(o){Fs(t,o)}break;case 5:pl(t);break;case 4:El(e,t)}}function vl(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function yl(e){return 5===e.tag||3===e.tag||4===e.tag}function bl(e){e:{for(var t=e.return;null!==t;){if(yl(t))break e;t=t.return}throw Error(i(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(i(161))}16&n.flags&&(ye(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||yl(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?wl(e,n,t):Cl(e,n,t)}function wl(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Fr));else if(4!==r&&null!==(e=e.child))for(wl(e,t,n),e=e.sibling;null!==e;)wl(e,t,n),e=e.sibling}function Cl(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(Cl(e,t,n),e=e.sibling;null!==e;)Cl(e,t,n),e=e.sibling}function El(e,t){for(var n,r,a=t,o=!1;;){if(!o){o=a.return;e:for(;;){if(null===o)throw Error(i(160));switch(n=o.stateNode,o.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}o=o.return}o=!0}if(5===a.tag||6===a.tag){e:for(var l=e,s=a,u=s;;)if(gl(l,u),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===s)break e;for(;null===u.sibling;){if(null===u.return||u.return===s)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}r?(l=n,s=a.stateNode,8===l.nodeType?l.parentNode.removeChild(s):l.removeChild(s)):n.removeChild(a.stateNode)}else if(4===a.tag){if(null!==a.child){n=a.stateNode.containerInfo,r=!0,a.child.return=a,a=a.child;continue}}else if(gl(e,a),null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;4===(a=a.return).tag&&(o=!1)}a.sibling.return=a.return,a=a.sibling}}function xl(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3===(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var a=null!==e?e.memoizedProps:r;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(n[Qr]=r,"input"===e&&"radio"===r.type&&null!=r.name&&te(n,r),Ne(e,a),t=Ne(e,r),a=0;a<o.length;a+=2){var l=o[a],s=o[a+1];"style"===l?Ee(n,s):"dangerouslySetInnerHTML"===l?ve(n,s):"children"===l?ye(n,s):w(n,l,s,t)}switch(e){case"input":ne(n,r);break;case"textarea":ue(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(o=r.value)?ie(n,!!r.multiple,o,!1):e!==!!r.multiple&&(null!=r.defaultValue?ie(n,!!r.multiple,r.defaultValue,!0):ie(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(i(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,Et(n.containerInfo)));case 12:return;case 13:return null!==t.memoizedState&&(Vl=Ba(),ml(t.child,!0)),void Al(t);case 19:return void Al(t);case 17:return;case 23:case 24:return void ml(t,null!==t.memoizedState)}throw Error(i(163))}function Al(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new dl),t.forEach((function(t){var r=Ps.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function Nl(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var Ll=Math.ceil,Il=C.ReactCurrentDispatcher,Ml=C.ReactCurrentOwner,kl=0,Sl=null,_l=null,Tl=0,Dl=0,Ol=ia(0),jl=0,Rl=null,Fl=0,Hl=0,Pl=0,Bl=0,zl=null,Vl=0,Ul=1/0;function ql(){Ul=Ba()+500}var Yl,Wl=null,Xl=!1,Gl=null,$l=null,Ql=!1,Kl=null,Jl=90,Zl=[],es=[],ts=null,ns=0,rs=null,as=-1,os=0,is=0,ls=null,ss=!1;function us(){return 0!==(48&kl)?Ba():-1!==as?as:as=Ba()}function cs(e){if(0===(2&(e=e.mode)))return 1;if(0===(4&e))return 99===za()?1:2;if(0===os&&(os=Fl),0!==Xa.transition){0!==is&&(is=null!==zl?zl.pendingLanes:0),e=os;var t=4186112&~is;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=za(),0!==(4&kl)&&98===e?e=Bt(12,os):e=Bt(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),os),e}function ds(e,t,n){if(50<ns)throw ns=0,rs=null,Error(i(185));if(null===(e=ps(e,t)))return null;Ut(e,t,n),e===Sl&&(Pl|=t,4===jl&&ms(e,Tl));var r=za();1===t?0!==(8&kl)&&0===(48&kl)?gs(e):(fs(e,n),0===kl&&(ql(),Ya())):(0===(4&kl)||98!==r&&99!==r||(null===ts?ts=new Set([e]):ts.add(e)),fs(e,n)),zl=e}function ps(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function fs(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,a=e.pingedLanes,o=e.expirationTimes,l=e.pendingLanes;0<l;){var s=31-qt(l),u=1<<s,c=o[s];if(-1===c){if(0===(u&r)||0!==(u&a)){c=t,Ft(u);var d=Rt;o[s]=10<=d?c+250:6<=d?c+5e3:-1}}else c<=t&&(e.expiredLanes|=u);l&=~u}if(r=Ht(e,e===Sl?Tl:0),t=Rt,0===r)null!==n&&(n!==Oa&&Aa(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Oa&&Aa(n)}15===t?(n=gs.bind(null,e),null===Ra?(Ra=[n],Fa=xa(ka,Wa)):Ra.push(n),n=Oa):14===t?n=qa(99,gs.bind(null,e)):n=qa(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(i(358,e))}}(t),hs.bind(null,e)),e.callbackPriority=t,e.callbackNode=n}}function hs(e){if(as=-1,is=os=0,0!==(48&kl))throw Error(i(327));var t=e.callbackNode;if(Ts()&&e.callbackNode!==t)return null;var n=Ht(e,e===Sl?Tl:0);if(0===n)return null;var r=n,a=kl;kl|=16;var o=xs();for(Sl===e&&Tl===r||(ql(),Cs(e,r));;)try{Ls();break}catch(s){Es(e,s)}if(Za(),Il.current=o,kl=a,null!==_l?r=0:(Sl=null,Tl=0,r=jl),0!==(Fl&Pl))Cs(e,0);else if(0!==r){if(2===r&&(kl|=64,e.hydrate&&(e.hydrate=!1,qr(e.containerInfo)),0!==(n=Pt(e))&&(r=As(e,n))),1===r)throw t=Rl,Cs(e,0),ms(e,n),fs(e,Ba()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(i(345));case 2:ks(e);break;case 3:if(ms(e,n),(62914560&n)===n&&10<(r=Vl+500-Ba())){if(0!==Ht(e,0))break;if(((a=e.suspendedLanes)&n)!==n){us(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Vr(ks.bind(null,e),r);break}ks(e);break;case 4:if(ms(e,n),(4186112&n)===n)break;for(r=e.eventTimes,a=-1;0<n;){var l=31-qt(n);o=1<<l,(l=r[l])>a&&(a=l),n&=~o}if(n=a,10<(n=(120>(n=Ba()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ll(n/1960))-n)){e.timeoutHandle=Vr(ks.bind(null,e),n);break}ks(e);break;case 5:ks(e);break;default:throw Error(i(329))}}return fs(e,Ba()),e.callbackNode===t?hs.bind(null,e):null}function ms(e,t){for(t&=~Bl,t&=~Pl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-qt(t),r=1<<n;e[n]=-1,t&=~r}}function gs(e){if(0!==(48&kl))throw Error(i(327));if(Ts(),e===Sl&&0!==(e.expiredLanes&Tl)){var t=Tl,n=As(e,t);0!==(Fl&Pl)&&(n=As(e,t=Ht(e,t)))}else n=As(e,t=Ht(e,0));if(0!==e.tag&&2===n&&(kl|=64,e.hydrate&&(e.hydrate=!1,qr(e.containerInfo)),0!==(t=Pt(e))&&(n=As(e,t))),1===n)throw n=Rl,Cs(e,0),ms(e,t),fs(e,Ba()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,ks(e),fs(e,Ba()),null}function vs(e,t){var n=kl;kl|=1;try{return e(t)}finally{0===(kl=n)&&(ql(),Ya())}}function ys(e,t){var n=kl;kl&=-2,kl|=8;try{return e(t)}finally{0===(kl=n)&&(ql(),Ya())}}function bs(e,t){sa(Ol,Dl),Dl|=t,Fl|=t}function ws(){Dl=Ol.current,la(Ol)}function Cs(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Ur(n)),null!==_l)for(n=_l.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&ma();break;case 3:To(),la(da),la(ca),Xo();break;case 5:Oo(r);break;case 4:To();break;case 13:case 19:la(jo);break;case 10:eo(r);break;case 23:case 24:ws()}n=n.return}Sl=e,_l=Us(e.current,null),Tl=Dl=Fl=t,jl=0,Rl=null,Bl=Pl=Hl=0}function Es(e,t){for(;;){var n=_l;try{if(Za(),Go.current=ki,ei){for(var r=Ko.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}ei=!1}if(Qo=0,Zo=Jo=Ko=null,ti=!1,Ml.current=null,null===n||null===n.return){jl=1,Rl=t,_l=null;break}e:{var o=e,i=n.return,l=n,s=t;if(t=Tl,l.flags|=2048,l.firstEffect=l.lastEffect=null,null!==s&&"object"===typeof s&&"function"===typeof s.then){var u=s;if(0===(2&l.mode)){var c=l.alternate;c?(l.updateQueue=c.updateQueue,l.memoizedState=c.memoizedState,l.lanes=c.lanes):(l.updateQueue=null,l.memoizedState=null)}var d=0!==(1&jo.current),p=i;do{var f;if(f=13===p.tag){var h=p.memoizedState;if(null!==h)f=null!==h.dehydrated;else{var m=p.memoizedProps;f=void 0!==m.fallback&&(!0!==m.unstable_avoidThisFallback||!d)}}if(f){var g=p.updateQueue;if(null===g){var v=new Set;v.add(u),p.updateQueue=v}else g.add(u);if(0===(2&p.mode)){if(p.flags|=64,l.flags|=16384,l.flags&=-2981,1===l.tag)if(null===l.alternate)l.tag=17;else{var y=lo(-1,1);y.tag=2,so(l,y)}l.lanes|=1;break e}s=void 0,l=t;var b=o.pingCache;if(null===b?(b=o.pingCache=new sl,s=new Set,b.set(u,s)):void 0===(s=b.get(u))&&(s=new Set,b.set(u,s)),!s.has(l)){s.add(l);var w=Hs.bind(null,o,u,l);u.then(w,w)}p.flags|=4096,p.lanes=t;break e}p=p.return}while(null!==p);s=Error((X(l.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==jl&&(jl=2),s=il(s,l),p=i;do{switch(p.tag){case 3:o=s,p.flags|=4096,t&=-t,p.lanes|=t,uo(p,ul(0,o,t));break e;case 1:o=s;var C=p.type,E=p.stateNode;if(0===(64&p.flags)&&("function"===typeof C.getDerivedStateFromError||null!==E&&"function"===typeof E.componentDidCatch&&(null===$l||!$l.has(E)))){p.flags|=4096,t&=-t,p.lanes|=t,uo(p,cl(p,o,t));break e}}p=p.return}while(null!==p)}Ms(n)}catch(x){t=x,_l===n&&null!==n&&(_l=n=n.return);continue}break}}function xs(){var e=Il.current;return Il.current=ki,null===e?ki:e}function As(e,t){var n=kl;kl|=16;var r=xs();for(Sl===e&&Tl===t||Cs(e,t);;)try{Ns();break}catch(a){Es(e,a)}if(Za(),kl=n,Il.current=r,null!==_l)throw Error(i(261));return Sl=null,Tl=0,jl}function Ns(){for(;null!==_l;)Is(_l)}function Ls(){for(;null!==_l&&!Na();)Is(_l)}function Is(e){var t=Yl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?Ms(e):_l=t,Ml.current=null}function Ms(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(2048&t.flags)){if(null!==(n=al(n,t,Dl)))return void(_l=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&Dl)||0===(4&n.mode)){for(var r=0,a=n.child;null!==a;)r|=a.lanes|a.childLanes,a=a.sibling;n.childLanes=r}null!==e&&0===(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=ol(t)))return n.flags&=2047,void(_l=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(_l=t);_l=t=e}while(null!==t);0===jl&&(jl=5)}function ks(e){var t=za();return Ua(99,Ss.bind(null,e,t)),null}function Ss(e,t){do{Ts()}while(null!==Kl);if(0!==(48&kl))throw Error(i(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null;var r=n.lanes|n.childLanes,a=r,o=e.pendingLanes&~a;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=a,e.mutableReadLanes&=a,e.entangledLanes&=a,a=e.entanglements;for(var l=e.eventTimes,s=e.expirationTimes;0<o;){var u=31-qt(o),c=1<<u;a[u]=0,l[u]=-1,s[u]=-1,o&=~c}if(null!==ts&&0===(24&r)&&ts.has(e)&&ts.delete(e),e===Sl&&(_l=Sl=null,Tl=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(a=kl,kl|=32,Ml.current=null,Hr=$t,hr(l=fr())){if("selectionStart"in l)s={start:l.selectionStart,end:l.selectionEnd};else e:if(s=(s=l.ownerDocument)&&s.defaultView||window,(c=s.getSelection&&s.getSelection())&&0!==c.rangeCount){s=c.anchorNode,o=c.anchorOffset,u=c.focusNode,c=c.focusOffset;try{s.nodeType,u.nodeType}catch(L){s=null;break e}var d=0,p=-1,f=-1,h=0,m=0,g=l,v=null;t:for(;;){for(var y;g!==s||0!==o&&3!==g.nodeType||(p=d+o),g!==u||0!==c&&3!==g.nodeType||(f=d+c),3===g.nodeType&&(d+=g.nodeValue.length),null!==(y=g.firstChild);)v=g,g=y;for(;;){if(g===l)break t;if(v===s&&++h===o&&(p=d),v===u&&++m===c&&(f=d),null!==(y=g.nextSibling))break;v=(g=v).parentNode}g=y}s=-1===p||-1===f?null:{start:p,end:f}}else s=null;s=s||{start:0,end:0}}else s=null;Pr={focusedElem:l,selectionRange:s},$t=!1,ls=null,ss=!1,Wl=r;do{try{_s()}catch(L){if(null===Wl)throw Error(i(330));Fs(Wl,L),Wl=Wl.nextEffect}}while(null!==Wl);ls=null,Wl=r;do{try{for(l=e;null!==Wl;){var b=Wl.flags;if(16&b&&ye(Wl.stateNode,""),128&b){var w=Wl.alternate;if(null!==w){var C=w.ref;null!==C&&("function"===typeof C?C(null):C.current=null)}}switch(1038&b){case 2:bl(Wl),Wl.flags&=-3;break;case 6:bl(Wl),Wl.flags&=-3,xl(Wl.alternate,Wl);break;case 1024:Wl.flags&=-1025;break;case 1028:Wl.flags&=-1025,xl(Wl.alternate,Wl);break;case 4:xl(Wl.alternate,Wl);break;case 8:El(l,s=Wl);var E=s.alternate;vl(s),null!==E&&vl(E)}Wl=Wl.nextEffect}}catch(L){if(null===Wl)throw Error(i(330));Fs(Wl,L),Wl=Wl.nextEffect}}while(null!==Wl);if(C=Pr,w=fr(),b=C.focusedElem,l=C.selectionRange,w!==b&&b&&b.ownerDocument&&pr(b.ownerDocument.documentElement,b)){null!==l&&hr(b)&&(w=l.start,void 0===(C=l.end)&&(C=w),"selectionStart"in b?(b.selectionStart=w,b.selectionEnd=Math.min(C,b.value.length)):(C=(w=b.ownerDocument||document)&&w.defaultView||window).getSelection&&(C=C.getSelection(),s=b.textContent.length,E=Math.min(l.start,s),l=void 0===l.end?E:Math.min(l.end,s),!C.extend&&E>l&&(s=l,l=E,E=s),s=dr(b,E),o=dr(b,l),s&&o&&(1!==C.rangeCount||C.anchorNode!==s.node||C.anchorOffset!==s.offset||C.focusNode!==o.node||C.focusOffset!==o.offset)&&((w=w.createRange()).setStart(s.node,s.offset),C.removeAllRanges(),E>l?(C.addRange(w),C.extend(o.node,o.offset)):(w.setEnd(o.node,o.offset),C.addRange(w))))),w=[];for(C=b;C=C.parentNode;)1===C.nodeType&&w.push({element:C,left:C.scrollLeft,top:C.scrollTop});for("function"===typeof b.focus&&b.focus(),b=0;b<w.length;b++)(C=w[b]).element.scrollLeft=C.left,C.element.scrollTop=C.top}$t=!!Hr,Pr=Hr=null,e.current=n,Wl=r;do{try{for(b=e;null!==Wl;){var x=Wl.flags;if(36&x&&hl(b,Wl.alternate,Wl),128&x){w=void 0;var A=Wl.ref;if(null!==A){var N=Wl.stateNode;switch(Wl.tag){case 5:w=N;break;default:w=N}"function"===typeof A?A(w):A.current=w}}Wl=Wl.nextEffect}}catch(L){if(null===Wl)throw Error(i(330));Fs(Wl,L),Wl=Wl.nextEffect}}while(null!==Wl);Wl=null,ja(),kl=a}else e.current=n;if(Ql)Ql=!1,Kl=e,Jl=t;else for(Wl=r;null!==Wl;)t=Wl.nextEffect,Wl.nextEffect=null,8&Wl.flags&&((x=Wl).sibling=null,x.stateNode=null),Wl=t;if(0===(r=e.pendingLanes)&&($l=null),1===r?e===rs?ns++:(ns=0,rs=e):ns=0,n=n.stateNode,Ca&&"function"===typeof Ca.onCommitFiberRoot)try{Ca.onCommitFiberRoot(wa,n,void 0,64===(64&n.current.flags))}catch(L){}if(fs(e,Ba()),Xl)throw Xl=!1,e=Gl,Gl=null,e;return 0!==(8&kl)||Ya(),null}function _s(){for(;null!==Wl;){var e=Wl.alternate;ss||null===ls||(0!==(8&Wl.flags)?et(Wl,ls)&&(ss=!0):13===Wl.tag&&Nl(e,Wl)&&et(Wl,ls)&&(ss=!0));var t=Wl.flags;0!==(256&t)&&fl(e,Wl),0===(512&t)||Ql||(Ql=!0,qa(97,(function(){return Ts(),null}))),Wl=Wl.nextEffect}}function Ts(){if(90!==Jl){var e=97<Jl?97:Jl;return Jl=90,Ua(e,js)}return!1}function Ds(e,t){Zl.push(t,e),Ql||(Ql=!0,qa(97,(function(){return Ts(),null})))}function Os(e,t){es.push(t,e),Ql||(Ql=!0,qa(97,(function(){return Ts(),null})))}function js(){if(null===Kl)return!1;var e=Kl;if(Kl=null,0!==(48&kl))throw Error(i(331));var t=kl;kl|=32;var n=es;es=[];for(var r=0;r<n.length;r+=2){var a=n[r],o=n[r+1],l=a.destroy;if(a.destroy=void 0,"function"===typeof l)try{l()}catch(u){if(null===o)throw Error(i(330));Fs(o,u)}}for(n=Zl,Zl=[],r=0;r<n.length;r+=2){a=n[r],o=n[r+1];try{var s=a.create;a.destroy=s()}catch(u){if(null===o)throw Error(i(330));Fs(o,u)}}for(s=e.current.firstEffect;null!==s;)e=s.nextEffect,s.nextEffect=null,8&s.flags&&(s.sibling=null,s.stateNode=null),s=e;return kl=t,Ya(),!0}function Rs(e,t,n){so(e,t=ul(0,t=il(n,t),1)),t=us(),null!==(e=ps(e,1))&&(Ut(e,1,t),fs(e,t))}function Fs(e,t){if(3===e.tag)Rs(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Rs(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===$l||!$l.has(r))){var a=cl(n,e=il(t,e),1);if(so(n,a),a=us(),null!==(n=ps(n,1)))Ut(n,1,a),fs(n,a);else if("function"===typeof r.componentDidCatch&&(null===$l||!$l.has(r)))try{r.componentDidCatch(t,e)}catch(o){}break}}n=n.return}}function Hs(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=us(),e.pingedLanes|=e.suspendedLanes&n,Sl===e&&(Tl&n)===n&&(4===jl||3===jl&&(62914560&Tl)===Tl&&500>Ba()-Vl?Cs(e,0):Bl|=n),fs(e,t)}function Ps(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0===(2&(t=e.mode))?t=1:0===(4&t)?t=99===za()?1:2:(0===os&&(os=Fl),0===(t=zt(62914560&~os))&&(t=4194304))),n=us(),null!==(e=ps(e,t))&&(Ut(e,t,n),fs(e,n))}function Bs(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function zs(e,t,n,r){return new Bs(e,t,n,r)}function Vs(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Us(e,t){var n=e.alternate;return null===n?((n=zs(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function qs(e,t,n,r,a,o){var l=2;if(r=e,"function"===typeof e)Vs(e)&&(l=1);else if("string"===typeof e)l=5;else e:switch(e){case A:return Ys(n.children,a,o,t);case R:l=8,a|=16;break;case N:l=8,a|=1;break;case L:return(e=zs(12,n,t,8|a)).elementType=L,e.type=L,e.lanes=o,e;case S:return(e=zs(13,n,t,a)).type=S,e.elementType=S,e.lanes=o,e;case _:return(e=zs(19,n,t,a)).elementType=_,e.lanes=o,e;case F:return Ws(n,a,o,t);case H:return(e=zs(24,n,t,a)).elementType=H,e.lanes=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case I:l=10;break e;case M:l=9;break e;case k:l=11;break e;case T:l=14;break e;case D:l=16,r=null;break e;case O:l=22;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=zs(l,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Ys(e,t,n,r){return(e=zs(7,e,r,t)).lanes=n,e}function Ws(e,t,n,r){return(e=zs(23,e,r,t)).elementType=F,e.lanes=n,e}function Xs(e,t,n){return(e=zs(6,e,null,t)).lanes=n,e}function Gs(e,t,n){return(t=zs(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function $s(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Vt(0),this.expirationTimes=Vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vt(0),this.mutableSourceEagerHydrationData=null}function Qs(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Ks(e,t,n,r){var a=t.current,o=us(),l=cs(a);e:if(n){t:{if(Qe(n=n._reactInternals)!==n||1!==n.tag)throw Error(i(170));var s=n;do{switch(s.tag){case 3:s=s.stateNode.context;break t;case 1:if(ha(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break t}}s=s.return}while(null!==s);throw Error(i(171))}if(1===n.tag){var u=n.type;if(ha(u)){n=va(n,u,s);break e}}n=s}else n=ua;return null===t.context?t.context=n:t.pendingContext=n,(t=lo(o,l)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),so(a,t),ds(a,l,o),l}function Js(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function Zs(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function eu(e,t){Zs(e,t),(e=e.alternate)&&Zs(e,t)}function tu(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new $s(e,t,null!=n&&!0===n.hydrate),t=zs(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,oo(t),e[Kr]=n.current,kr(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var a=(t=r[e])._getVersion;a=a(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,a]:n.mutableSourceEagerHydrationData.push(t,a)}this._internalRoot=n}function nu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ru(e,t,n,r,a){var o=n._reactRootContainer;if(o){var i=o._internalRoot;if("function"===typeof a){var l=a;a=function(){var e=Js(i);l.call(e)}}Ks(t,i,e,a)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new tu(e,0,t?{hydrate:!0}:void 0)}(n,r),i=o._internalRoot,"function"===typeof a){var s=a;a=function(){var e=Js(i);s.call(e)}}ys((function(){Ks(t,i,e,a)}))}return Js(i)}function au(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nu(t))throw Error(i(200));return Qs(e,t,null,n)}Yl=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||da.current)Oi=!0;else{if(0===(n&r)){switch(Oi=!1,t.tag){case 3:qi(t),Yo();break;case 5:Do(t);break;case 1:ha(t.type)&&ya(t);break;case 4:_o(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var a=t.type._context;sa($a,a._currentValue),a._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(n&t.child.childLanes)?$i(e,t,n):(sa(jo,1&jo.current),null!==(t=nl(e,t,n))?t.sibling:null);sa(jo,1&jo.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(64&e.flags)){if(r)return tl(e,t,n);t.flags|=64}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),sa(jo,jo.current),r)break;return null;case 23:case 24:return t.lanes=0,Pi(e,t,n)}return nl(e,t,n)}Oi=0!==(16384&e.flags)}else Oi=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=fa(t,ca.current),no(t,n),a=ai(null,t,r,e,a,n),t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,ha(r)){var o=!0;ya(t)}else o=!1;t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,oo(t);var l=r.getDerivedStateFromProps;"function"===typeof l&&ho(t,r,l,e),a.updater=mo,t.stateNode=a,a._reactInternals=t,bo(t,r,e,n),t=Ui(null,t,r,!0,o,n)}else t.tag=0,ji(null,t,a,n),t=t.child;return t;case 16:a=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=(o=a._init)(a._payload),t.type=a,o=t.tag=function(e){if("function"===typeof e)return Vs(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===k)return 11;if(e===T)return 14}return 2}(a),e=Ga(a,e),o){case 0:t=zi(null,t,a,e,n);break e;case 1:t=Vi(null,t,a,e,n);break e;case 11:t=Ri(null,t,a,e,n);break e;case 14:t=Fi(null,t,a,Ga(a.type,e),r,n);break e}throw Error(i(306,a,""))}return t;case 0:return r=t.type,a=t.pendingProps,zi(e,t,r,a=t.elementType===r?a:Ga(r,a),n);case 1:return r=t.type,a=t.pendingProps,Vi(e,t,r,a=t.elementType===r?a:Ga(r,a),n);case 3:if(qi(t),r=t.updateQueue,null===e||null===r)throw Error(i(282));if(r=t.pendingProps,a=null!==(a=t.memoizedState)?a.element:null,io(e,t),co(t,r,null,n),(r=t.memoizedState.element)===a)Yo(),t=nl(e,t,n);else{if((o=(a=t.stateNode).hydrate)&&(Ho=Yr(t.stateNode.containerInfo.firstChild),Fo=t,o=Po=!0),o){if(null!=(e=a.mutableSourceEagerHydrationData))for(a=0;a<e.length;a+=2)(o=e[a])._workInProgressVersionPrimary=e[a+1],Wo.push(o);for(n=No(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else ji(e,t,r,n),Yo();t=t.child}return t;case 5:return Do(t),null===e&&Vo(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,l=a.children,zr(r,a)?l=null:null!==o&&zr(r,o)&&(t.flags|=16),Bi(e,t),ji(e,t,l,n),t.child;case 6:return null===e&&Vo(t),null;case 13:return $i(e,t,n);case 4:return _o(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ao(t,null,r,n):ji(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,Ri(e,t,r,a=t.elementType===r?a:Ga(r,a),n);case 7:return ji(e,t,t.pendingProps,n),t.child;case 8:case 12:return ji(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,a=t.pendingProps,l=t.memoizedProps,o=a.value;var s=t.type._context;if(sa($a,s._currentValue),s._currentValue=o,null!==l)if(s=l.value,0===(o=lr(s,o)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(s,o):1073741823))){if(l.children===a.children&&!da.current){t=nl(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var u=s.dependencies;if(null!==u){l=s.child;for(var c=u.firstContext;null!==c;){if(c.context===r&&0!==(c.observedBits&o)){1===s.tag&&((c=lo(-1,n&-n)).tag=2,so(s,c)),s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),to(s.return,n),u.lanes|=n;break}c=c.next}}else l=10===s.tag&&s.type===t.type?null:s.child;if(null!==l)l.return=s;else for(l=s;null!==l;){if(l===t){l=null;break}if(null!==(s=l.sibling)){s.return=l.return,l=s;break}l=l.return}s=l}ji(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=(o=t.pendingProps).children,no(t,n),r=r(a=ro(a,o.unstable_observedBits)),t.flags|=1,ji(e,t,r,n),t.child;case 14:return o=Ga(a=t.type,t.pendingProps),Fi(e,t,a,o=Ga(a.type,o),r,n);case 15:return Hi(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Ga(r,a),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,ha(r)?(e=!0,ya(t)):e=!1,no(t,n),vo(t,r,a),bo(t,r,a,n),Ui(null,t,r,!0,e,n);case 19:return tl(e,t,n);case 23:case 24:return Pi(e,t,n)}throw Error(i(156,t.tag))},tu.prototype.render=function(e){Ks(e,this._internalRoot,null,null)},tu.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Ks(null,e,null,(function(){t[Kr]=null}))},tt=function(e){13===e.tag&&(ds(e,4,us()),eu(e,4))},nt=function(e){13===e.tag&&(ds(e,67108864,us()),eu(e,67108864))},rt=function(e){if(13===e.tag){var t=us(),n=cs(e);ds(e,n,t),eu(e,n)}},at=function(e,t){return t()},Ie=function(e,t,n){switch(t){case"input":if(ne(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=na(r);if(!a)throw Error(i(90));K(r),ne(r,a)}}}break;case"textarea":ue(e,n);break;case"select":null!=(t=n.value)&&ie(e,!!n.multiple,t,!1)}},De=vs,Oe=function(e,t,n,r,a){var o=kl;kl|=4;try{return Ua(98,e.bind(null,t,n,r,a))}finally{0===(kl=o)&&(ql(),Ya())}},je=function(){0===(49&kl)&&(function(){if(null!==ts){var e=ts;ts=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,fs(e,Ba())}))}Ya()}(),Ts())},Re=function(e,t){var n=kl;kl|=2;try{return e(t)}finally{0===(kl=n)&&(ql(),Ya())}};var ou={Events:[ea,ta,na,_e,Te,Ts,{current:!1}]},iu={findFiberByHostInstance:Zr,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},lu={bundleType:iu.bundleType,version:iu.version,rendererPackageName:iu.rendererPackageName,rendererConfig:iu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ze(e))?null:e.stateNode},findFiberByHostInstance:iu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!su.isDisabled&&su.supportsFiber)try{wa=su.inject(lu),Ca=su}catch(ge){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ou,t.createPortal=au,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw Error(i(268,Object.keys(e)))}return e=null===(e=Ze(t))?null:e.stateNode},t.flushSync=function(e,t){var n=kl;if(0!==(48&n))return e(t);kl|=1;try{if(e)return Ua(99,e.bind(null,t))}finally{kl=n,Ya()}},t.hydrate=function(e,t,n){if(!nu(t))throw Error(i(200));return ru(null,e,t,!0,n)},t.render=function(e,t,n){if(!nu(t))throw Error(i(200));return ru(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!nu(e))throw Error(i(40));return!!e._reactRootContainer&&(ys((function(){ru(null,null,e,!1,(function(){e._reactRootContainer=null,e[Kr]=null}))})),!0)},t.unstable_batchedUpdates=vs,t.unstable_createPortal=function(e,t){return au(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!nu(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return ru(e,t,n,!1,r)},t.version="17.0.2"},function(e,t,n){"use strict";e.exports=n(8)},function(e,t,n){"use strict";var r,a,o,i;if("object"===typeof performance&&"function"===typeof performance.now){var l=performance;t.unstable_now=function(){return l.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var c=null,d=null,p=function e(){if(null!==c)try{var n=t.unstable_now();c(!0,n),c=null}catch(r){throw setTimeout(e,0),r}};r=function(e){null!==c?setTimeout(r,0,e):(c=e,setTimeout(p,0))},a=function(e,t){d=setTimeout(e,t)},o=function(){clearTimeout(d)},t.unstable_shouldYield=function(){return!1},i=t.unstable_forceFrameRate=function(){}}else{var f=window.setTimeout,h=window.clearTimeout;if("undefined"!==typeof console){var m=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof m&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var g=!1,v=null,y=-1,b=5,w=0;t.unstable_shouldYield=function(){return t.unstable_now()>=w},i=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<e?Math.floor(1e3/e):5};var C=new MessageChannel,E=C.port2;C.port1.onmessage=function(){if(null!==v){var e=t.unstable_now();w=e+b;try{v(!0,e)?E.postMessage(null):(g=!1,v=null)}catch(n){throw E.postMessage(null),n}}else g=!1},r=function(e){v=e,g||(g=!0,E.postMessage(null))},a=function(e,n){y=f((function(){e(t.unstable_now())}),n)},o=function(){h(y),y=-1}}function x(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,a=e[r];if(!(void 0!==a&&0<L(a,t)))break e;e[r]=t,e[n]=a,n=r}}function A(e){return void 0===(e=e[0])?null:e}function N(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length;r<a;){var o=2*(r+1)-1,i=e[o],l=o+1,s=e[l];if(void 0!==i&&0>L(i,n))void 0!==s&&0>L(s,i)?(e[r]=s,e[l]=n,r=l):(e[r]=i,e[o]=n,r=o);else{if(!(void 0!==s&&0>L(s,n)))break e;e[r]=s,e[l]=n,r=l}}}return t}return null}function L(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var I=[],M=[],k=1,S=null,_=3,T=!1,D=!1,O=!1;function j(e){for(var t=A(M);null!==t;){if(null===t.callback)N(M);else{if(!(t.startTime<=e))break;N(M),t.sortIndex=t.expirationTime,x(I,t)}t=A(M)}}function R(e){if(O=!1,j(e),!D)if(null!==A(I))D=!0,r(F);else{var t=A(M);null!==t&&a(R,t.startTime-e)}}function F(e,n){D=!1,O&&(O=!1,o()),T=!0;var r=_;try{for(j(n),S=A(I);null!==S&&(!(S.expirationTime>n)||e&&!t.unstable_shouldYield());){var i=S.callback;if("function"===typeof i){S.callback=null,_=S.priorityLevel;var l=i(S.expirationTime<=n);n=t.unstable_now(),"function"===typeof l?S.callback=l:S===A(I)&&N(I),j(n)}else N(I);S=A(I)}if(null!==S)var s=!0;else{var u=A(M);null!==u&&a(R,u.startTime-n),s=!1}return s}finally{S=null,_=r,T=!1}}var H=i;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){D||T||(D=!0,r(F))},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_getFirstCallbackNode=function(){return A(I)},t.unstable_next=function(e){switch(_){case 1:case 2:case 3:var t=3;break;default:t=_}var n=_;_=t;try{return e()}finally{_=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=H,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=_;_=e;try{return t()}finally{_=n}},t.unstable_scheduleCallback=function(e,n,i){var l=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?l+i:l:i=l,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:k++,callback:n,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>l?(e.sortIndex=i,x(M,e),null===A(I)&&e===A(M)&&(O?o():O=!0,a(R,i-l))):(e.sortIndex=s,x(I,e),D||T||(D=!0,r(F))),e},t.unstable_wrapCallback=function(e){var t=_;return function(){var n=_;_=t;try{return e.apply(this,arguments)}finally{_=n}}}},,function(e,t,n){},,function(e,t,n){"use strict";n(2);var r=n(1),a=60103;if(t.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var o=Symbol.for;a=o("react.element"),t.Fragment=o("react.fragment")}var i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l=Object.prototype.hasOwnProperty,s={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var r,o={},u=null,c=null;for(r in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)l.call(t,r)&&!s.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:a,type:e,key:u,ref:c,props:o,_owner:i.current}}t.jsx=u,t.jsxs=u}]]);
//# sourceMappingURL=2.302467df.chunk.js.map